basePath: /api/v1
definitions:
  ctis.ASVSInfo:
    properties:
      control_id:
        description: Control ID (e.g., "2.1.1")
        type: string
      control_url:
        description: Control URL (link to ASVS documentation)
        type: string
      level:
        description: ASVS level (1, 2, or 3)
        type: integer
      section:
        description: 'ASVS section (e.g., "V2: Authentication")'
        type: string
    type: object
  ctis.AccessControlIssue:
    properties:
      callable_by:
        description: Can be called by
        type: string
      escalation_path:
        description: Privilege escalation path
        type: string
      missing_modifier:
        description: Missing modifier
        type: string
      missing_role_check:
        description: Missing role check
        type: string
      unprotected_function:
        description: Unprotected function
        type: string
    type: object
  ctis.ArtifactLocation:
    properties:
      index:
        description: Index within the artifacts array
        type: integer
      uri:
        description: URI of the artifact
        type: string
      uri_base_id:
        description: Base URI ID for resolution
        type: string
    type: object
  ctis.Asset:
    properties:
      compliance:
        allOf:
        - $ref: '#/definitions/ctis.AssetCompliance'
        description: 'CTEM: Compliance context for the asset'
      confidence:
        description: Confidence score 0-100 (how confident the source is about this
          asset)
        type: integer
      criticality:
        allOf:
        - $ref: '#/definitions/ctis.Criticality'
        description: 'Asset criticality: critical, high, medium, low, info'
      description:
        description: Description
        type: string
      discovered_at:
        description: When this asset was discovered
        type: string
      id:
        description: Unique identifier for this asset within the report
        type: string
      is_internet_accessible:
        description: 'CTEM: Is the asset directly accessible from the internet'
        type: boolean
      name:
        description: Human-readable name
        type: string
      properties:
        allOf:
        - $ref: '#/definitions/ctis.Properties'
        description: Custom properties
      related_assets:
        description: Related assets (by ID within this report)
        items:
          type: string
        type: array
      services:
        description: 'CTEM: Services running on this asset'
        items:
          $ref: '#/definitions/ctis.ServiceInfo'
        type: array
      tags:
        description: Tags for categorization
        items:
          type: string
        type: array
      technical:
        allOf:
        - $ref: '#/definitions/ctis.AssetTechnical'
        description: Asset-specific technical details
      type:
        allOf:
        - $ref: '#/definitions/ctis.AssetType'
        description: 'Asset type (required): domain, ip_address, repository, certificate,
          etc.'
      value:
        description: |-
          Primary value of the asset (required)
          For domain: "example.com"
          For ip_address: "192.168.1.1"
          For repository: "github.com/org/repo"
        type: string
    type: object
  ctis.AssetCompliance:
    properties:
      data_classification:
        description: 'Data classification level: public, internal, confidential, restricted,
          secret'
        type: string
      frameworks:
        description: 'Compliance frameworks this asset is in scope for: PCI-DSS, HIPAA,
          SOC2, GDPR, ISO27001'
        items:
          type: string
        type: array
      phi_exposed:
        description: Asset contains Protected Health Information
        type: boolean
      pii_exposed:
        description: Asset contains Personally Identifiable Information
        type: boolean
      regulatory_owner:
        description: Regulatory owner email/username
        type: string
    type: object
  ctis.AssetTechnical:
    properties:
      certificate:
        allOf:
        - $ref: '#/definitions/ctis.CertificateTechnical'
        description: For certificate assets
      cloud:
        allOf:
        - $ref: '#/definitions/ctis.CloudTechnical'
        description: For cloud assets
      domain:
        allOf:
        - $ref: '#/definitions/ctis.DomainTechnical'
        description: For domain assets
      ip_address:
        allOf:
        - $ref: '#/definitions/ctis.IPAddressTechnical'
        description: For IP address assets
      repository:
        allOf:
        - $ref: '#/definitions/ctis.RepositoryTechnical'
        description: For repository assets
      service:
        allOf:
        - $ref: '#/definitions/ctis.ServiceTechnical'
        description: For service assets
      web3:
        allOf:
        - $ref: '#/definitions/ctis.Web3Technical'
        description: For Web3 assets (smart contracts, wallets, tokens, etc.)
    type: object
  ctis.AssetType:
    enum:
    - domain
    - subdomain
    - ip_address
    - certificate
    - website
    - web_application
    - api
    - mobile_app
    - service
    - repository
    - cloud_account
    - compute
    - storage
    - database
    - serverless
    - container_registry
    - host
    - server
    - container
    - kubernetes
    - kubernetes_cluster
    - kubernetes_namespace
    - network
    - vpc
    - subnet
    - load_balancer
    - firewall
    - iam_user
    - iam_role
    - service_account
    - http_service
    - open_port
    - discovered_url
    - smart_contract
    - wallet
    - nft_collection
    - defi_protocol
    - token
    - blockchain
    - other
    type: string
    x-enum-comments:
      AssetTypeAPI: API endpoint (REST, GraphQL, gRPC)
      AssetTypeCloudAccount: AWS Account, GCP Project, Azure Subscription
      AssetTypeCompute: EC2, GCE, Azure VM
      AssetTypeContainer: Docker container
      AssetTypeContainerRegistry: ECR, GCR, ACR
      AssetTypeDatabase: RDS, Cloud SQL, Cosmos DB
      AssetTypeDiscoveredURL: URLs/endpoints from Katana
      AssetTypeFirewall: Firewall / Security Group
      AssetTypeHTTPService: HTTP/HTTPS services from HTTPX
      AssetTypeHost: Physical or virtual host
      AssetTypeIAMRole: IAM role
      AssetTypeIAMUser: IAM user
      AssetTypeKubernetes: Kubernetes cluster (generic)
      AssetTypeKubernetesCluster: Kubernetes cluster
      AssetTypeKubernetesNamespace: Kubernetes namespace
      AssetTypeLoadBalancer: Load balancer (ALB, NLB, etc.)
      AssetTypeMobileApp: Mobile application (iOS, Android)
      AssetTypeNetwork: Network segment
      AssetTypeOpenPort: Individual open ports from Naabu
      AssetTypeOther: Catch-all for unknown types
      AssetTypeServer: Server machine
      AssetTypeServerless: Lambda, Cloud Functions, Azure Functions
      AssetTypeService: Network service (SSH, SMTP, FTP, DNS, etc.)
      AssetTypeServiceAccount: Service account
      AssetTypeStorage: S3, GCS, Azure Blob
      AssetTypeSubnet: Network subnet
      AssetTypeVPC: Virtual Private Cloud
      AssetTypeWebApplication: Web application (SaaS, internal apps)
      AssetTypeWebsite: Public-facing website
    x-enum-descriptions:
    - ""
    - ""
    - ""
    - ""
    - Public-facing website
    - Web application (SaaS, internal apps)
    - API endpoint (REST, GraphQL, gRPC)
    - Mobile application (iOS, Android)
    - Network service (SSH, SMTP, FTP, DNS, etc.)
    - ""
    - AWS Account, GCP Project, Azure Subscription
    - EC2, GCE, Azure VM
    - S3, GCS, Azure Blob
    - RDS, Cloud SQL, Cosmos DB
    - Lambda, Cloud Functions, Azure Functions
    - ECR, GCR, ACR
    - Physical or virtual host
    - Server machine
    - Docker container
    - Kubernetes cluster (generic)
    - Kubernetes cluster
    - Kubernetes namespace
    - Network segment
    - Virtual Private Cloud
    - Network subnet
    - Load balancer (ALB, NLB, etc.)
    - Firewall / Security Group
    - IAM user
    - IAM role
    - Service account
    - HTTP/HTTPS services from HTTPX
    - Individual open ports from Naabu
    - URLs/endpoints from Katana
    - ""
    - ""
    - ""
    - ""
    - ""
    - ""
    - Catch-all for unknown types
    x-enum-varnames:
    - AssetTypeDomain
    - AssetTypeSubdomain
    - AssetTypeIPAddress
    - AssetTypeCertificate
    - AssetTypeWebsite
    - AssetTypeWebApplication
    - AssetTypeAPI
    - AssetTypeMobileApp
    - AssetTypeService
    - AssetTypeRepository
    - AssetTypeCloudAccount
    - AssetTypeCompute
    - AssetTypeStorage
    - AssetTypeDatabase
    - AssetTypeServerless
    - AssetTypeContainerRegistry
    - AssetTypeHost
    - AssetTypeServer
    - AssetTypeContainer
    - AssetTypeKubernetes
    - AssetTypeKubernetesCluster
    - AssetTypeKubernetesNamespace
    - AssetTypeNetwork
    - AssetTypeVPC
    - AssetTypeSubnet
    - AssetTypeLoadBalancer
    - AssetTypeFirewall
    - AssetTypeIAMUser
    - AssetTypeIAMRole
    - AssetTypeServiceAccount
    - AssetTypeHTTPService
    - AssetTypeOpenPort
    - AssetTypeDiscoveredURL
    - AssetTypeSmartContract
    - AssetTypeWallet
    - AssetTypeNFTCollection
    - AssetTypeDeFiProtocol
    - AssetTypeToken
    - AssetTypeBlockchain
    - AssetTypeOther
  ctis.Attachment:
    properties:
      artifact_location:
        allOf:
        - $ref: '#/definitions/ctis.ArtifactLocation'
        description: Artifact location
      description:
        description: Description of the attachment
        type: string
      regions:
        description: Relevant regions within the artifact
        items:
          $ref: '#/definitions/ctis.FindingLocation'
        type: array
    type: object
  ctis.AuditReport:
    properties:
      auditor:
        type: string
      critical_count:
        type: integer
      date:
        type: string
      high_count:
        type: integer
      low_count:
        type: integer
      medium_count:
        type: integer
      report_url:
        type: string
      scope:
        type: string
    type: object
  ctis.BranchInfo:
    properties:
      base_branch:
        description: Base branch for PR/MR scans (e.g., "main" when scanning a PR
          targeting main)
        type: string
      commit_sha:
        description: Commit SHA being scanned
        type: string
      is_default_branch:
        description: |-
          Whether this is the default branch (main/master)
          Auto-resolve only applies to default branch scans
        type: boolean
      name:
        description: Branch name (e.g., "main", "feature/xyz", "refs/heads/main")
        type: string
      pull_request_number:
        description: PR/MR number if this is a pull request scan
        type: integer
      pull_request_url:
        description: PR/MR URL if this is a pull request scan
        type: string
      repository_url:
        description: Repository URL for context
        type: string
    type: object
  ctis.BusinessImpact:
    properties:
      compliance_impact:
        description: 'Compliance frameworks impacted: PCI-DSS, HIPAA, SOC2, GDPR,
          ISO27001'
        items:
          type: string
        type: array
      data_exposure_risk:
        description: 'Data exposure risk: none, low, medium, high, critical'
        type: string
      reputational_impact:
        description: Has potential reputational impact
        type: boolean
    type: object
  ctis.CertificateTechnical:
    properties:
      expired:
        description: Is expired
        type: boolean
      fingerprint:
        description: SHA-256 fingerprint
        type: string
      issuer_cn:
        description: Issuer common name
        type: string
      issuer_org:
        description: Issuer organization
        type: string
      key_algorithm:
        description: Key algorithm
        type: string
      key_size:
        description: Key size in bits
        type: integer
      not_after:
        description: Valid until
        type: string
      not_before:
        description: Valid from
        type: string
      sans:
        description: Subject alternative names
        items:
          type: string
        type: array
      self_signed:
        description: Is self-signed
        type: boolean
      serial_number:
        description: Serial number
        type: string
      signature_algorithm:
        description: Signature algorithm
        type: string
      subject_cn:
        description: Subject common name
        type: string
      wildcard:
        description: Is wildcard
        type: boolean
    type: object
  ctis.CloudTechnical:
    properties:
      account_id:
        description: Account/project ID
        type: string
      arn:
        description: Resource ARN (AWS)
        type: string
      provider:
        description: 'Cloud provider: aws, gcp, azure'
        type: string
      region:
        description: Region
        type: string
      resource_id:
        description: Resource ID
        type: string
      resource_type:
        description: 'Resource type: ec2, s3, rds, etc.'
        type: string
      tags:
        additionalProperties:
          type: string
        description: Resource tags
        type: object
      zone:
        description: Availability zone
        type: string
    type: object
  ctis.ComplianceDetails:
    properties:
      control_description:
        description: Control description
        type: string
      control_id:
        description: Control ID
        type: string
      control_name:
        description: Control name
        type: string
      framework:
        description: 'Framework: pci-dss, hipaa, soc2, cis, etc.'
        type: string
      framework_version:
        description: Framework version
        type: string
      result:
        description: 'Result: pass, fail, manual, not_applicable'
        type: string
    type: object
  ctis.ContainerLayer:
    properties:
      diff_id:
        description: Layer diff ID
        type: string
      digest:
        description: Layer digest (e.g., "sha256:abc123...")
        type: string
    type: object
  ctis.ContractLibrary:
    properties:
      address:
        type: string
      name:
        type: string
    type: object
  ctis.CoreContract:
    properties:
      address:
        type: string
      name:
        type: string
      role:
        description: router, factory, vault, etc.
        type: string
    type: object
  ctis.Criticality:
    enum:
    - critical
    - high
    - medium
    - low
    - info
    type: string
    x-enum-varnames:
    - CriticalityCritical
    - CriticalityHigh
    - CriticalityMedium
    - CriticalityLow
    - CriticalityInfo
  ctis.DNSRecord:
    properties:
      name:
        description: Record name
        type: string
      ttl:
        type: integer
      type:
        description: A, AAAA, CNAME, MX, TXT, etc.
        type: string
      value:
        description: Record value
        type: string
    type: object
  ctis.DataFlow:
    properties:
      call_path:
        description: Call graph path (function names in order)
        items:
          type: string
        type: array
      confidence:
        description: Flow confidence score (0-100)
        type: integer
      cross_file:
        description: Is cross-file (data flows across multiple files)
        type: boolean
      intermediates:
        description: Intermediate variable locations (propagation path)
        items:
          $ref: '#/definitions/ctis.DataFlowLocation'
        type: array
      interprocedural:
        description: Is interprocedural (crosses function boundaries)
        type: boolean
      sanitizers:
        description: Sanitizers applied (functions that clean/escape data)
        items:
          $ref: '#/definitions/ctis.DataFlowLocation'
        type: array
      sinks:
        description: Taint sink location (where data reaches dangerous function)
        items:
          $ref: '#/definitions/ctis.DataFlowLocation'
        type: array
      sources:
        description: Taint source locations (where untrusted data enters)
        items:
          $ref: '#/definitions/ctis.DataFlowLocation'
        type: array
      summary:
        description: Summary of the flow for human readability
        type: string
      taint_type:
        description: 'Type of taint: user_input, file_read, env_var, network, database'
        type: string
      tainted:
        description: |-
          Whether the data is still tainted at the sink
          (false if properly sanitized before reaching sink)
        type: boolean
      vulnerability_type:
        description: 'Vulnerability type this flow leads to: sqli, xss, ssrf, command_injection,
          etc.'
        type: string
    type: object
  ctis.DataFlowLocation:
    properties:
      called_function:
        description: 'For function calls: the function being called'
        type: string
      class:
        description: Class/struct name (if applicable)
        type: string
      column:
        description: Column number (1-indexed)
        type: integer
      content:
        description: Code content at this location
        type: string
      end_column:
        description: End column
        type: integer
      end_line:
        description: End line (for multi-line spans)
        type: integer
      function:
        description: Function/method name containing this location
        type: string
      index:
        description: Step index in the flow (for ordering, 0-indexed)
        type: integer
      label:
        description: Variable or expression name
        type: string
      line:
        description: Line number (1-indexed)
        type: integer
      module:
        description: Module/namespace
        type: string
      notes:
        description: Notes for human understanding
        type: string
      operation:
        description: 'The operation performed: assignment, call, return, parameter,
          concat, etc.'
        type: string
      parameter_index:
        description: 'For parameters: the parameter index (0-indexed)'
        type: integer
      path:
        description: File path
        type: string
      taint_state:
        description: 'Taint state at this location: tainted, sanitized, unknown'
        type: string
      transformation:
        description: 'Transformation applied: encode, decode, escape, hash, encrypt,
          etc.'
        type: string
      type:
        allOf:
        - $ref: '#/definitions/ctis.DataFlowLocationType'
        description: 'Location type: source, sink, propagator, sanitizer, transform'
    type: object
  ctis.DataFlowLocationType:
    enum:
    - source
    - sink
    - propagator
    - sanitizer
    - transform
    type: string
    x-enum-varnames:
    - DataFlowLocationSource
    - DataFlowLocationSink
    - DataFlowLocationPropagator
    - DataFlowLocationSanitizer
    - DataFlowLocationTransform
  ctis.DeFiDetails:
    properties:
      audit_reports:
        description: Audit reports
        items:
          $ref: '#/definitions/ctis.AuditReport'
        type: array
      audited:
        description: Is audited
        type: boolean
      bug_bounty_platform:
        description: 'Bug bounty platform: immunefi, hackerone, etc.'
        type: string
      core_contracts:
        description: Core contracts
        items:
          $ref: '#/definitions/ctis.CoreContract'
        type: array
      governance_token:
        description: Governance token address
        type: string
      has_bug_bounty:
        description: Has bug bounty
        type: boolean
      max_bounty_usd:
        description: Max bug bounty payout
        type: number
      paused:
        description: Is paused
        type: boolean
      protocol_name:
        description: 'Protocol name: uniswap, aave, compound, etc.'
        type: string
      protocol_type:
        description: 'Protocol type: dex, lending, yield, bridge, derivatives, etc.'
        type: string
      supported_chains:
        description: Supported chains
        items:
          type: string
        type: array
      timelock_duration:
        description: Timelock duration (for governance)
        type: integer
      tvl_usd:
        description: Total Value Locked (TVL) in USD
        type: number
      version:
        description: Protocol version
        type: string
    type: object
  ctis.Dependency:
    properties:
      depends_on:
        description: Dependencies (list of IDs or names this component depends on)
        items:
          type: string
        type: array
      ecosystem:
        description: 'Ecosystem: npm, pypi, maven, gomod, etc.'
        type: string
      id:
        description: Unique identifier for this dependency
        type: string
      licenses:
        description: License information
        items:
          type: string
        type: array
      location:
        allOf:
        - $ref: '#/definitions/ctis.FindingLocation'
        description: Location in file (deprecated, use Locations)
      locations:
        description: All locations where this dependency is defined
        items:
          $ref: '#/definitions/ctis.DependencyLocation'
        type: array
      name:
        description: Package name
        type: string
      path:
        description: File path where this dependency is defined
        type: string
      purl:
        description: Package URL (PURL)
        type: string
      relationship:
        description: 'Dependency relationship: direct, indirect, root, transit'
        type: string
      type:
        description: 'Package type: library, framework, application, os'
        type: string
      uid:
        description: Unique identifier from scanner (e.g., Trivy UID)
        type: string
      version:
        description: Package version
        type: string
    type: object
  ctis.DependencyLocation:
    properties:
      end_column:
        description: End column number
        type: integer
      end_line:
        description: End line number
        type: integer
      path:
        description: File path
        type: string
      start_column:
        description: Start column number
        type: integer
      start_line:
        description: Start line number
        type: integer
    type: object
  ctis.DomainTechnical:
    properties:
      dns_records:
        description: DNS records
        items:
          $ref: '#/definitions/ctis.DNSRecord'
        type: array
      expires_at:
        description: Expiration date
        type: string
      nameservers:
        description: Nameservers
        items:
          type: string
        type: array
      registered_at:
        description: Registration date
        type: string
      registrar:
        description: Registrar information
        type: string
      whois:
        additionalProperties:
          type: string
        description: WHOIS data
        type: object
    type: object
  ctis.Finding:
    properties:
      asset_ref:
        description: Reference to asset ID within this report
        type: string
      asset_type:
        allOf:
        - $ref: '#/definitions/ctis.AssetType'
        description: Asset type (if using AssetValue)
      asset_value:
        description: Direct asset value (if not using AssetRef)
        type: string
      attachments:
        description: Attachments - relevant artifacts or evidence (SARIF attachments)
        items:
          $ref: '#/definitions/ctis.Attachment'
        type: array
      author:
        description: Git author who introduced the finding
        type: string
      author_email:
        description: Author email
        type: string
      baseline_state:
        description: |-
          Baseline state - status relative to previous scan (SARIF baselineState)
          Values: new, unchanged, updated, absent
        type: string
      business_impact:
        allOf:
        - $ref: '#/definitions/ctis.BusinessImpact'
        description: 'CTEM: Business impact assessment'
      category:
        description: Finding category/class
        type: string
      commit_date:
        description: Commit date when the finding was introduced
        type: string
      compliance:
        allOf:
        - $ref: '#/definitions/ctis.ComplianceDetails'
        description: Compliance-specific details
      confidence:
        description: Confidence score 0-100
        type: integer
      correlation_id:
        description: Correlation ID - groups logically identical results across runs
          (SARIF correlationGuid)
        type: string
      data_flow:
        allOf:
        - $ref: '#/definitions/ctis.DataFlow'
        description: Data flow trace for taint analysis (source -> intermediate ->
          sink)
      description:
        description: Detailed description
        type: string
      exposure:
        allOf:
        - $ref: '#/definitions/ctis.FindingExposure'
        description: 'CTEM: Exposure information'
      fingerprint:
        description: Fingerprint for deduplication
        type: string
      first_seen_at:
        description: First seen timestamp
        type: string
      hosted_viewer_uri:
        description: Hosted viewer URI - URI to view in hosted viewer (SARIF hostedViewerUri)
        type: string
      id:
        description: Unique identifier for this finding within the report
        type: string
      impact:
        description: 'Impact level: critical, high, medium, low (for risk assessment)'
        type: string
      kind:
        description: |-
          Kind - evaluation state of the finding (SARIF kind)
          Values: not_applicable, pass, fail, review, open, informational
        type: string
      last_seen_at:
        description: Last seen timestamp
        type: string
      likelihood:
        description: 'Likelihood level: high, medium, low (for risk assessment)'
        type: string
      location:
        allOf:
        - $ref: '#/definitions/ctis.FindingLocation'
        description: Location information (for code-based findings)
      message:
        description: |-
          Primary message to display (the main human-readable finding message)
          This is distinct from Title (short) and Description (detailed)
          If not set, Title will be used as the message
        type: string
      misconfiguration:
        allOf:
        - $ref: '#/definitions/ctis.MisconfigurationDetails'
        description: Misconfiguration-specific details
      occurrence_count:
        description: Occurrence count - number of times this result was observed (SARIF
          occurrenceCount)
        type: integer
      partial_fingerprints:
        additionalProperties:
          type: string
        description: Partial fingerprints - contributing identity components (SARIF
          partialFingerprints)
        type: object
      properties:
        allOf:
        - $ref: '#/definitions/ctis.Properties'
        description: Custom properties
      rank:
        description: Rank - priority/importance score 0-100 (SARIF rank)
        type: number
      references:
        description: References (URLs)
        items:
          type: string
        type: array
      related_locations:
        description: Related locations - additional locations related to this finding
          (SARIF relatedLocations)
        items:
          $ref: '#/definitions/ctis.FindingLocation'
        type: array
      remediation:
        allOf:
        - $ref: '#/definitions/ctis.Remediation'
        description: Remediation guidance
      remediation_context:
        allOf:
        - $ref: '#/definitions/ctis.RemediationContext'
        description: 'CTEM: Remediation context'
      rule_id:
        description: Rule/check ID that detected this finding
        type: string
      rule_name:
        description: Rule name
        type: string
      secret:
        allOf:
        - $ref: '#/definitions/ctis.SecretDetails'
        description: Secret-specific details
      severity:
        allOf:
        - $ref: '#/definitions/ctis.Severity'
        description: 'Severity (required): critical, high, medium, low, info'
      stacks:
        description: Stacks - call stacks relevant to the finding (SARIF stacks)
        items:
          $ref: '#/definitions/ctis.StackTrace'
        type: array
      status:
        allOf:
        - $ref: '#/definitions/ctis.FindingStatus'
        description: 'Finding status: open, resolved, false_positive, accepted_risk,
          in_progress'
      subcategory:
        description: 'Subcategory: audit, vuln, secure default, etc.'
        items:
          type: string
        type: array
      suppression:
        allOf:
        - $ref: '#/definitions/ctis.Suppression'
        description: Suppression information (if finding is suppressed)
      tags:
        description: Tags
        items:
          type: string
        type: array
      title:
        description: Short title (required)
        type: string
      type:
        allOf:
        - $ref: '#/definitions/ctis.FindingType'
        description: 'Finding type (required): vulnerability, secret, misconfiguration,
          compliance'
      vulnerability:
        allOf:
        - $ref: '#/definitions/ctis.VulnerabilityDetails'
        description: Vulnerability-specific details
      vulnerability_class:
        description: 'Vulnerability class(es): SQL Injection, XSS, Command Injection,
          etc.'
        items:
          type: string
        type: array
      web3:
        allOf:
        - $ref: '#/definitions/ctis.Web3VulnerabilityDetails'
        description: Web3-specific details (smart contract vulnerabilities)
      work_item_uris:
        description: Work item URIs - URIs of associated issues/tickets (SARIF workItemUris)
        items:
          type: string
        type: array
    type: object
  ctis.FindingExposure:
    properties:
      attack_prerequisites:
        description: 'Prerequisites for exploitation: auth_required, mfa_required,
          local_access, etc.'
        type: string
      is_internet_accessible:
        description: Is the finding directly reachable from the internet
        type: boolean
      is_network_accessible:
        description: Is the finding reachable from the network
        type: boolean
      vector:
        description: 'Exposure vector: network, local, physical, adjacent_net'
        type: string
    type: object
  ctis.FindingLocation:
    properties:
      branch:
        description: Branch name (for repository findings)
        type: string
      commit_sha:
        description: Commit SHA
        type: string
      context_snippet:
        description: Context region (surrounding code for better understanding)
        type: string
      context_start_line:
        description: Context start line (for context_snippet)
        type: integer
      end_column:
        description: End column
        type: integer
      end_line:
        description: End line number
        type: integer
      logical_location:
        allOf:
        - $ref: '#/definitions/ctis.LogicalLocation'
        description: Logical location (function, class, method name)
      path:
        description: File path
        type: string
      snippet:
        description: Code snippet
        type: string
      start_column:
        description: Start column
        type: integer
      start_line:
        description: Start line number (1-indexed)
        type: integer
    type: object
  ctis.FindingStatus:
    enum:
    - open
    - resolved
    - false_positive
    - accepted_risk
    - in_progress
    type: string
    x-enum-varnames:
    - FindingStatusOpen
    - FindingStatusResolved
    - FindingStatusFalsePositive
    - FindingStatusAcceptedRisk
    - FindingStatusInProgress
  ctis.FindingType:
    enum:
    - vulnerability
    - secret
    - misconfiguration
    - compliance
    - web3
    type: string
    x-enum-comments:
      FindingTypeWeb3: Smart contract vulnerabilities
    x-enum-descriptions:
    - ""
    - ""
    - ""
    - ""
    - Smart contract vulnerabilities
    x-enum-varnames:
    - FindingTypeVulnerability
    - FindingTypeSecret
    - FindingTypeMisconfiguration
    - FindingTypeCompliance
    - FindingTypeWeb3
  ctis.FixRegex:
    properties:
      count:
        description: Number of replacements to make (0 = all)
        type: integer
      regex:
        description: Regular expression pattern to match
        type: string
      replacement:
        description: Replacement string (may contain capture group references like
          $1, $2)
        type: string
    type: object
  ctis.FlashLoanIssue:
    properties:
      attack_steps:
        description: Attack steps
        items:
          type: string
        type: array
      attack_type:
        description: 'Attack type: price_manipulation, governance_attack, collateral_theft'
        type: string
      potential_profit_usd:
        description: Potential profit
        type: number
      provider:
        description: 'Flash loan provider: aave, dydx, uniswap, balancer'
        type: string
      required_capital_usd:
        description: Required capital for attack
        type: number
    type: object
  ctis.GasIssue:
    properties:
      current_gas:
        description: Current gas cost
        type: integer
      optimized_gas:
        description: Optimized gas cost
        type: integer
      savings_percent:
        description: Gas savings percentage
        type: number
      suggestion:
        description: Optimization suggestion
        type: string
    type: object
  ctis.Geolocation:
    properties:
      accuracy:
        description: in meters
        type: number
      latitude:
        type: number
      longitude:
        type: number
    type: object
  ctis.IPAddressTechnical:
    properties:
      asn:
        description: ASN information
        type: integer
      asn_org:
        description: ASN organization
        type: string
      city:
        description: City
        type: string
      country:
        description: Country code
        type: string
      geolocation:
        allOf:
        - $ref: '#/definitions/ctis.Geolocation'
        description: Geolocation
      hostname:
        description: Hostname (if resolved)
        type: string
      ports:
        description: Open ports
        items:
          $ref: '#/definitions/ctis.PortInfo'
        type: array
      version:
        description: 'IP version: 4 or 6'
        type: integer
    type: object
  ctis.LogicalLocation:
    properties:
      fully_qualified_name:
        description: Fully qualified name (e.g., "pkg.MyClass.myMethod")
        type: string
      kind:
        description: 'Kind: function, method, class, module, namespace'
        type: string
      name:
        description: Function/method name
        type: string
      parent_index:
        description: Parent logical location index (for nested locations)
        type: integer
    type: object
  ctis.MisconfigurationDetails:
    properties:
      actual:
        description: Actual value
        type: string
      avd_id:
        description: Aqua Vulnerability Database ID (e.g., AVD-AWS-0001)
        type: string
      cause:
        description: Cause description
        type: string
      expected:
        description: Expected value
        type: string
      namespace:
        description: Namespace (e.g., builtin.aws.s3)
        type: string
      policy_id:
        description: Policy/check ID
        type: string
      policy_name:
        description: Policy name
        type: string
      provider:
        description: Cloud provider (e.g., AWS, GCP, Azure)
        type: string
      query:
        description: Rego query path
        type: string
      resource_name:
        description: Resource name
        type: string
      resource_type:
        description: Resource type
        type: string
      service:
        description: Service (e.g., S3, EC2, IAM)
        type: string
    type: object
  ctis.NFTCollectionDetails:
    properties:
      base_uri:
        description: Base URI
        type: string
      creator:
        description: Creator address
        type: string
      floor_price:
        description: Floor price (in native token)
        type: string
      floor_price_usd:
        description: Floor price USD
        type: number
      holder_count:
        description: Unique holders
        type: integer
      marketplaces:
        description: Marketplace URLs
        items:
          type: string
        type: array
      max_supply:
        description: Max supply
        type: integer
      metadata_storage:
        description: 'Metadata storage: ipfs, arweave, centralized'
        type: string
      name:
        description: Collection name
        type: string
      revealed:
        description: Is revealed
        type: boolean
      royalty_percent:
        description: Royalty percentage
        type: number
      royalty_recipient:
        description: Royalty recipient
        type: string
      standard:
        description: 'Token standard: erc721, erc1155'
        type: string
      symbol:
        description: Collection symbol
        type: string
      total_supply:
        description: Total supply
        type: integer
      total_volume:
        description: Total volume (in native token)
        type: string
      total_volume_usd:
        description: Total volume USD
        type: number
    type: object
  ctis.OracleManipulationIssue:
    properties:
      manipulation_method:
        description: 'Manipulation method: flash_loan, sandwich, time_manipulation'
        type: string
      missing_checks:
        description: Missing checks
        items:
          type: string
        type: array
      oracle_address:
        description: Oracle address
        type: string
      oracle_type:
        description: 'Oracle type: chainlink, uniswap_twap, custom'
        type: string
      price_impact_percent:
        description: Price impact possible
        type: number
    type: object
  ctis.PortInfo:
    properties:
      banner:
        type: string
      port:
        type: integer
      protocol:
        description: tcp, udp
        type: string
      service:
        description: http, ssh, etc.
        type: string
      state:
        description: open, filtered, closed
        type: string
      version:
        type: string
    type: object
  ctis.Properties:
    additionalProperties: {}
    type: object
  ctis.ReentrancyIssue:
    properties:
      callback:
        description: Callback function
        type: string
      entry_point:
        description: Entry point function
        type: string
      external_call:
        description: Vulnerable external call
        type: string
      max_depth:
        description: Max reentrancy depth possible
        type: integer
      state_modified_after_call:
        description: State variable modified after call
        type: string
      type:
        description: 'Reentrancy type: cross_function, cross_contract, read_only'
        type: string
    type: object
  ctis.Remediation:
    properties:
      auto_fixable:
        description: Auto-fixable
        type: boolean
      effort:
        description: 'Effort estimate: trivial, low, medium, high'
        type: string
      fix_available:
        description: Fix available
        type: boolean
      fix_code:
        description: |-
          Suggested fix code - the actual code to replace the vulnerable code
          For SAST tools like Semgrep that provide auto-fix suggestions
        type: string
      fix_regex:
        allOf:
        - $ref: '#/definitions/ctis.FixRegex'
        description: Regex-based fix pattern (for tools that provide regex replacements)
      recommendation:
        description: Short recommendation
        type: string
      references:
        description: Reference URLs
        items:
          type: string
        type: array
      steps:
        description: Detailed fix steps
        items:
          type: string
        type: array
    type: object
  ctis.RemediationContext:
    properties:
      complexity:
        description: 'Fix complexity: simple, moderate, complex'
        type: string
      estimated_minutes:
        description: Estimated time to fix in minutes
        type: integer
      remedy_available:
        description: Is a remedy (patch/fix) available
        type: boolean
      type:
        description: 'Remediation type: patch, upgrade, workaround, config_change,
          mitigate, accept_risk'
        type: string
    type: object
  ctis.Report:
    properties:
      $schema:
        description: Schema URL for validation (optional)
        type: string
      assets:
        description: Assets discovered/collected
        items:
          $ref: '#/definitions/ctis.Asset'
        type: array
      dependencies:
        description: Dependencies (SBOM)
        items:
          $ref: '#/definitions/ctis.Dependency'
        type: array
      findings:
        description: Findings discovered
        items:
          $ref: '#/definitions/ctis.Finding'
        type: array
      metadata:
        allOf:
        - $ref: '#/definitions/ctis.ReportMetadata'
        description: Report metadata
      properties:
        allOf:
        - $ref: '#/definitions/ctis.Properties'
        description: Custom properties
      tool:
        allOf:
        - $ref: '#/definitions/ctis.Tool'
        description: Tool information (for collector/scanner reports)
      version:
        description: Schema version (required)
        type: string
    type: object
  ctis.ReportMetadata:
    properties:
      branch:
        allOf:
        - $ref: '#/definitions/ctis.BranchInfo'
        description: |-
          Branch information for git-based scans
          Used for branch-aware finding lifecycle management
      coverage_type:
        description: |-
          Coverage type: full, incremental, partial
          - full: Complete scan of entire scope (enables auto-resolve)
          - incremental: Diff scan of changed files only (no auto-resolve)
          - partial: Partial scan of specific directories (no auto-resolve)
        type: string
      duration_ms:
        description: Duration of the scan/collection in milliseconds (optional)
        type: integer
      id:
        description: Unique identifier for this report/scan (recommended)
        type: string
      properties:
        allOf:
        - $ref: '#/definitions/ctis.Properties'
        description: Custom properties
      scope:
        allOf:
        - $ref: '#/definitions/ctis.Scope'
        description: Target scope of the scan/collection
      source_ref:
        description: External reference (job ID, scan ID)
        type: string
      source_type:
        description: 'Source type: scanner, collector, integration, manual'
        type: string
      timestamp:
        description: Timestamp when the report was generated (required)
        type: string
    type: object
  ctis.RepositoryTechnical:
    properties:
      clone_url:
        description: Clone URL
        type: string
      default_branch:
        description: Default branch
        type: string
      forks:
        description: Forks count
        type: integer
      languages:
        additionalProperties:
          type: integer
        description: Language breakdown
        type: object
      last_commit_at:
        description: Last commit date
        type: string
      last_commit_sha:
        description: Last commit SHA
        type: string
      name:
        description: Repository name
        type: string
      owner:
        description: Organization/owner
        type: string
      platform:
        description: 'SCM platform: github, gitlab, bitbucket'
        type: string
      stars:
        description: Stars count
        type: integer
      url:
        description: Repository URL
        type: string
      visibility:
        description: 'Repository visibility: public, private, internal'
        type: string
    type: object
  ctis.Scope:
    properties:
      excludes:
        description: Excluded targets
        items:
          type: string
        type: array
      includes:
        description: Included targets
        items:
          type: string
        type: array
      name:
        description: Scope name or identifier
        type: string
      type:
        description: 'Scope type: domain, network, repository, cloud_account'
        type: string
    type: object
  ctis.SecretDetails:
    properties:
      age_in_days:
        description: Secret age (how long since creation, if known)
        type: integer
      commit_count:
        description: Commit count where this secret appears
        type: integer
      entropy:
        description: Entropy score
        type: number
      expires_at:
        description: Expiration date (if known)
        type: string
      in_history_only:
        description: Is the secret in git history only (not in current HEAD)
        type: boolean
      length:
        description: Length of the secret
        type: integer
      masked_value:
        description: Masked value (first and last few chars)
        type: string
      revoked:
        description: Is revoked
        type: boolean
      revoked_at:
        description: When the secret was revoked
        type: string
      rotation_due_at:
        description: Rotation recommended by date
        type: string
      scopes:
        description: Secret scope/permissions (e.g., "read:org", "repo", "admin")
        items:
          type: string
        type: array
      secret_type:
        description: 'Secret type: api_key, password, token, certificate, private_key,
          etc.'
        type: string
      service:
        description: 'Service associated with the secret: aws, github, stripe, gcp,
          azure, etc.'
        type: string
      valid:
        description: Is valid (if verification was performed)
        type: boolean
      verified_at:
        description: Verification timestamp
        type: string
    type: object
  ctis.ServiceInfo:
    properties:
      banner:
        description: Service banner
        type: string
      cpe:
        description: Common Platform Enumeration identifier
        type: string
      is_public:
        description: Is this service publicly accessible from the internet
        type: boolean
      port:
        description: Port number
        type: integer
      product:
        description: 'Product name: Apache, nginx, OpenSSH, etc.'
        type: string
      protocol:
        description: 'Transport protocol: tcp, udp'
        type: string
      service_type:
        description: 'Service type: http, https, ssh, ftp, mysql, postgresql, etc.'
        type: string
      state:
        description: 'Service state: active, inactive, filtered'
        type: string
      tls_enabled:
        description: TLS enabled
        type: boolean
      tls_version:
        description: 'TLS version: TLS 1.2, TLS 1.3'
        type: string
      version:
        description: Product version
        type: string
    type: object
  ctis.ServiceTechnical:
    properties:
      anonymous_access:
        description: Anonymous access allowed (for FTP, SMB, etc.)
        type: boolean
      auth_methods:
        description: Authentication methods supported (e.g., ["password", "publickey"]
          for SSH)
        items:
          type: string
        type: array
      auth_required:
        description: Authentication required
        type: boolean
      banner:
        description: Banner/fingerprint
        type: string
      cpe:
        description: CPE (Common Platform Enumeration) identifier
        type: string
      default_credentials:
        description: Default credentials detected
        type: boolean
      details:
        additionalProperties: {}
        description: |-
          Service-specific details (protocol-dependent)
          For HTTP: methods, headers, etc.
          For SMTP: EHLO response, supported extensions
          For SSH: supported algorithms, host keys
        type: object
      extra_info:
        description: Extra info
        type: string
      last_seen:
        description: Last seen timestamp
        type: string
      name:
        description: Service name
        type: string
      port:
        description: Port
        type: integer
      product:
        description: Product name (e.g., "OpenSSH", "nginx", "Apache", "Postfix")
        type: string
      protocol:
        description: 'Protocol (application-layer): http, https, ssh, smtp, ftp, dns,
          ldap, smb, rdp, mysql, postgresql, mongodb, redis, etc.'
        type: string
      response_time_ms:
        description: Response time in milliseconds
        type: integer
      state:
        description: 'Service state: open, filtered, closed'
        type: string
      tls:
        description: SSL/TLS enabled
        type: boolean
      tls_cert_expiry:
        type: string
      tls_cert_issuer:
        type: string
      tls_cert_subject:
        description: TLS certificate info (for services with TLS)
        type: string
      tls_version:
        description: 'TLS version: tls1.0, tls1.1, tls1.2, tls1.3'
        type: string
      transport:
        description: 'Transport: tcp, udp'
        type: string
      version:
        description: Service version
        type: string
    type: object
  ctis.Severity:
    enum:
    - critical
    - high
    - medium
    - low
    - info
    type: string
    x-enum-varnames:
    - SeverityCritical
    - SeverityHigh
    - SeverityMedium
    - SeverityLow
    - SeverityInfo
  ctis.SmartContractDetails:
    properties:
      abi:
        description: ABI (JSON string or base64 encoded)
        type: string
      address:
        description: Contract address
        type: string
      balance:
        description: Contract balance (in wei)
        type: string
      bytecode_hash:
        description: Bytecode hash (keccak256)
        type: string
      compiler_version:
        description: Compiler version
        type: string
      contract_type:
        description: 'Contract type: erc20, erc721, erc1155, proxy, multisig, defi,
          custom'
        type: string
      deployed_at:
        description: Deployment timestamp
        type: string
      deployer_address:
        description: Deployer address
        type: string
      deployment_block:
        description: Deployment block number
        type: integer
      deployment_tx_hash:
        description: Deployment transaction hash
        type: string
      evm_version:
        description: EVM version
        type: string
      implementation_address:
        description: Implementation address (for proxy contracts)
        type: string
      interfaces:
        description: 'Implemented interfaces: ERC20, ERC721, etc.'
        items:
          type: string
        type: array
      is_proxy:
        description: Is proxy contract
        type: boolean
      is_upgradeable:
        description: Is upgradeable
        type: boolean
      libraries:
        description: External libraries used
        items:
          $ref: '#/definitions/ctis.ContractLibrary'
        type: array
      license:
        description: 'License type: MIT, GPL, UNLICENSED, etc.'
        type: string
      name:
        description: Contract name
        type: string
      optimization_enabled:
        description: Optimization enabled
        type: boolean
      optimization_runs:
        description: Optimization runs
        type: integer
      owner_address:
        description: Owner/admin address
        type: string
      ownership_renounced:
        description: Has renounced ownership
        type: boolean
      proxy_type:
        description: 'Proxy type: transparent, uups, beacon, diamond'
        type: string
      source_code_hash:
        description: Source code hash
        type: string
      source_code_url:
        description: Source code URL (GitHub, etc.)
        type: string
      tx_count:
        description: Total transactions
        type: integer
      verified:
        description: Is verified on explorer (etherscan, etc.)
        type: boolean
    type: object
  ctis.StackFrame:
    properties:
      location:
        allOf:
        - $ref: '#/definitions/ctis.FindingLocation'
        description: Location of this frame
      module:
        description: Module/library name
        type: string
      parameters:
        description: Function parameters
        items:
          type: string
        type: array
      thread_id:
        description: Thread ID
        type: integer
    type: object
  ctis.StackTrace:
    properties:
      frames:
        description: Stack frames from innermost to outermost
        items:
          $ref: '#/definitions/ctis.StackFrame'
        type: array
      message:
        description: Stack description/message
        type: string
    type: object
  ctis.Suppression:
    properties:
      justification:
        description: Justification for suppression
        type: string
      kind:
        description: 'Suppression kind: in_source, external'
        type: string
      status:
        description: 'Suppression status: accepted, under_review, rejected'
        type: string
      suppressed_at:
        description: When the finding was suppressed
        type: string
      suppressed_by:
        description: Who suppressed the finding
        type: string
    type: object
  ctis.TokenBalance:
    properties:
      balance:
        description: Balance (raw value)
        type: string
      balance_formatted:
        description: Balance formatted (human readable)
        type: string
      contract_address:
        description: Token contract address
        type: string
      decimals:
        description: Token decimals
        type: integer
      name:
        description: Token name
        type: string
      symbol:
        description: Token symbol
        type: string
      usd_value:
        description: USD value
        type: number
    type: object
  ctis.TokenDetails:
    properties:
      burnable:
        description: Is burnable
        type: boolean
      decimals:
        description: Token decimals
        type: integer
      has_blacklist:
        description: Has blacklist/whitelist
        type: boolean
      has_transfer_fee:
        description: Has transfer fee/tax
        type: boolean
      holder_count:
        description: Holder count
        type: integer
      honeypot_reason:
        description: Honeypot reason
        type: string
      is_honeypot:
        description: Is honeypot
        type: boolean
      liquidity_usd:
        description: Liquidity USD
        type: number
      market_cap_usd:
        description: Market cap USD
        type: number
      max_supply:
        description: Max supply (if applicable)
        type: string
      mintable:
        description: Is mintable
        type: boolean
      name:
        description: Token name
        type: string
      pausable:
        description: Is pausable
        type: boolean
      price_usd:
        description: Price USD
        type: number
      standard:
        description: 'Token standard: erc20, erc721, erc1155, bep20, spl'
        type: string
      symbol:
        description: Token symbol
        type: string
      total_supply:
        description: Total supply (raw value)
        type: string
      trading_pairs:
        description: Trading pairs
        items:
          $ref: '#/definitions/ctis.TradingPair'
        type: array
      transfer_fee_percent:
        description: Transfer fee percentage
        type: number
    type: object
  ctis.Tool:
    properties:
      capabilities:
        description: Tool capabilities
        items:
          type: string
        type: array
      info_url:
        description: Tool information URL
        type: string
      name:
        description: Tool name (required)
        type: string
      properties:
        allOf:
        - $ref: '#/definitions/ctis.Properties'
        description: Custom properties
      vendor:
        description: Tool vendor/organization
        type: string
      version:
        description: Tool version (recommended)
        type: string
    type: object
  ctis.TradingPair:
    properties:
      dex:
        description: 'DEX name: uniswap, sushiswap, pancakeswap, etc.'
        type: string
      liquidity_usd:
        description: Liquidity USD
        type: number
      pair_address:
        description: Pair address
        type: string
      quote_token:
        description: Quote token symbol (WETH, USDT, etc.)
        type: string
    type: object
  ctis.VulnDataSource:
    properties:
      id:
        description: Data source ID (e.g., "nvd", "ghsa", "osv")
        type: string
      name:
        description: Data source name
        type: string
      url:
        description: Data source URL
        type: string
    type: object
  ctis.VulnerabilityDetails:
    properties:
      advisories:
        description: Advisory URLs
        items:
          type: string
        type: array
      affected_version:
        description: Affected version
        type: string
      affected_version_range:
        description: Affected version range (semver format)
        type: string
      asvs:
        allOf:
        - $ref: '#/definitions/ctis.ASVSInfo'
        description: ASVS (Application Security Verification Standard) compliance
          info
      avd_id:
        description: Aqua Vulnerability Database ID (e.g., AVD-AWS-0001)
        type: string
      cpe:
        description: Affected CPE
        type: string
      cve_id:
        description: CVE ID
        type: string
      cvss_score:
        description: CVSS score
        type: number
      cvss_source:
        description: 'CVSS data source: nvd, ghsa, redhat, bitnami'
        type: string
      cvss_vector:
        description: CVSS vector
        type: string
      cvss_version:
        description: CVSS version (2.0, 3.0, 3.1, 4.0)
        type: string
      cwe_id:
        description: CWE ID (single, for backward compatibility)
        type: string
      cwe_ids:
        description: CWE IDs (can have multiple)
        items:
          type: string
        type: array
      data_source:
        allOf:
        - $ref: '#/definitions/ctis.VulnDataSource'
        description: Data source information (vulnerability database)
      dependency_path:
        description: Dependency path for transitive vulnerabilities
        items:
          type: string
        type: array
      ecosystem:
        description: 'Ecosystem: npm, pip, maven, cargo, go, nuget, etc.'
        type: string
      epss_percentile:
        description: EPSS percentile
        type: number
      epss_score:
        description: EPSS score (Exploit Prediction Scoring System)
        type: number
      exploit_available:
        description: Exploit available
        type: boolean
      exploit_maturity:
        description: 'Exploit maturity: none, poc, functional, weaponized'
        type: string
      fixed_version:
        description: Fixed version
        type: string
      fixed_versions:
        description: All available fixed versions
        items:
          type: string
        type: array
      in_cisa_kev:
        description: In CISA KEV (Known Exploited Vulnerabilities)
        type: boolean
      is_direct:
        description: Is direct dependency (vs transitive)
        type: boolean
      layer:
        allOf:
        - $ref: '#/definitions/ctis.ContainerLayer'
        description: Container layer information (for image scans)
      modified_at:
        description: Last modified date
        type: string
      owasp_ids:
        description: OWASP IDs (e.g., "A01:2021", "A03:2021")
        items:
          type: string
        type: array
      package:
        description: Affected package
        type: string
      published_at:
        description: Vulnerability published date
        type: string
      purl:
        description: Package URL (PURL spec) e.g., pkg:npm/lodash@4.17.20
        type: string
      severity_source:
        description: 'Severity source (who assigned the severity: nvd, ghsa, redhat,
          etc.)'
        type: string
      vendor_severity:
        additionalProperties:
          type: integer
        description: Vendor-specific severity mapping (vendor -> severity level 1-5)
        type: object
      vuln_status:
        description: 'Vulnerability status: affected, fixed, under_investigation,
          will_not_fix'
        type: string
    type: object
  ctis.WalletDetails:
    properties:
      balance:
        description: Balance (native token, in wei)
        type: string
      ens_name:
        description: ENS name (if applicable)
        type: string
      first_tx_at:
        description: First transaction timestamp
        type: string
      labels:
        description: Labels (exchange, whale, hacker, etc.)
        items:
          type: string
        type: array
      last_tx_at:
        description: Last transaction timestamp
        type: string
      nft_count:
        description: NFT count
        type: integer
      owners:
        description: Owner addresses (for multisig)
        items:
          type: string
        type: array
      provider:
        description: 'Wallet provider: metamask, ledger, safe, argent, etc.'
        type: string
      required_signatures:
        description: 'For multisig: required signatures'
        type: integer
      token_balances:
        description: Token balances
        items:
          $ref: '#/definitions/ctis.TokenBalance'
        type: array
      total_owners:
        description: 'For multisig: total owners'
        type: integer
      tx_count:
        description: Total transactions
        type: integer
      wallet_type:
        description: 'Wallet type: eoa, multisig, smart_wallet, mpc'
        type: string
    type: object
  ctis.Web3POC:
    properties:
      code:
        description: POC code or script
        type: string
      expected_outcome:
        description: Expected outcome
        type: string
      fork_block_number:
        description: Fork block number (for mainnet fork tests)
        type: integer
      tested_on:
        description: 'Tested on: mainnet_fork, testnet, local'
        type: string
      tx_data:
        description: POC transaction data
        type: string
      type:
        description: 'POC type: transaction, script, foundry_test, hardhat_test'
        type: string
    type: object
  ctis.Web3Technical:
    properties:
      address:
        description: Contract/wallet address
        type: string
      chain:
        description: 'Blockchain network: ethereum, polygon, bsc, arbitrum, optimism,
          avalanche, solana, etc.'
        type: string
      chain_id:
        description: 'Chain ID (EVM chains): 1 (mainnet), 137 (polygon), 56 (bsc),
          etc.'
        type: integer
      contract:
        allOf:
        - $ref: '#/definitions/ctis.SmartContractDetails'
        description: For smart contracts
      defi:
        allOf:
        - $ref: '#/definitions/ctis.DeFiDetails'
        description: For DeFi protocols
      network_type:
        description: 'Network type: mainnet, testnet, devnet'
        type: string
      nft:
        allOf:
        - $ref: '#/definitions/ctis.NFTCollectionDetails'
        description: For NFT collections
      token:
        allOf:
        - $ref: '#/definitions/ctis.TokenDetails'
        description: For tokens (ERC-20, ERC-721, etc.)
      wallet:
        allOf:
        - $ref: '#/definitions/ctis.WalletDetails'
        description: For wallets
    type: object
  ctis.Web3VulnerabilityDetails:
    properties:
      access_control:
        allOf:
        - $ref: '#/definitions/ctis.AccessControlIssue'
        description: Access control details
      affected_value_usd:
        description: Affected assets value in USD
        type: number
      attack_vector:
        description: Attack vector description
        type: string
      attacker_addresses:
        description: Attacker addresses (if known)
        items:
          type: string
        type: array
      bytecode_offset:
        description: Bytecode offset (if found in bytecode analysis)
        type: integer
      chain:
        description: Chain name
        type: string
      chain_id:
        description: Chain ID
        type: integer
      contract_address:
        description: Contract address affected
        type: string
      detection_confidence:
        description: 'Detection confidence: high, medium, low'
        type: string
      detection_tool:
        description: 'Tool that found this: slither, mythril, securify, manticore,
          etc.'
        type: string
      estimated_impact_usd:
        description: Estimated impact in USD (if quantifiable)
        type: number
      exploitable_on_mainnet:
        description: Is exploitable on mainnet
        type: boolean
      flash_loan:
        allOf:
        - $ref: '#/definitions/ctis.FlashLoanIssue'
        description: Flash loan attack details
      function_selector:
        description: Affected function selector (4 bytes)
        type: string
      function_signature:
        description: Affected function signature
        type: string
      gas_issue:
        allOf:
        - $ref: '#/definitions/ctis.GasIssue'
        description: Gas optimization issues (for gas-related findings)
      is_false_positive:
        description: Is false positive
        type: boolean
      oracle_manipulation:
        allOf:
        - $ref: '#/definitions/ctis.OracleManipulationIssue'
        description: Oracle manipulation details
      poc:
        allOf:
        - $ref: '#/definitions/ctis.Web3POC'
        description: Proof of concept (if available)
      reentrancy:
        allOf:
        - $ref: '#/definitions/ctis.ReentrancyIssue'
        description: Reentrancy details
      related_tx_hashes:
        description: Related transaction hashes (if exploit occurred)
        items:
          type: string
        type: array
      swc_id:
        description: SWC Registry ID (e.g., SWC-107 for reentrancy)
        type: string
      vulnerability_class:
        description: |-
          Vulnerability class/category (SWC ID or custom)
          Common: reentrancy, overflow, access_control, front_running, etc.
        type: string
      vulnerable_pattern:
        description: Vulnerable code pattern
        type: string
    type: object
  github_com_openctemio_api_internal_app.CredentialItem:
    properties:
      credential_type:
        type: string
      details:
        additionalProperties: {}
        type: object
      first_seen_at:
        type: string
      id:
        type: string
      identifier:
        type: string
      is_revoked:
        type: boolean
      is_verified:
        type: boolean
      last_seen_at:
        type: string
      secret_value:
        type: string
      severity:
        type: string
      source:
        type: string
      state:
        type: string
    type: object
  github_com_openctemio_api_internal_app.CredentialListResult:
    properties:
      items:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  github_com_openctemio_api_internal_app.GetModuleLimitOutput:
    properties:
      limit:
        format: int64
        type: integer
      unlimited:
        type: boolean
    type: object
  github_com_openctemio_api_internal_app.GetNotificationEventsResult:
    properties:
      data:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.NotificationEventEntry'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  github_com_openctemio_api_internal_app.IdentityExposure:
    properties:
      credential_types:
        items:
          type: string
        type: array
      exposure_count:
        type: integer
      first_seen_at:
        type: string
      highest_severity:
        type: string
      identity:
        description: username or email
        type: string
      identity_type:
        description: '"username" or "email"'
        type: string
      last_seen_at:
        type: string
      sources:
        items:
          type: string
        type: array
      states:
        additionalProperties:
          type: integer
        description: count by state
        type: object
    type: object
  github_com_openctemio_api_internal_app.IdentityListResult:
    properties:
      items:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.IdentityExposure'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  github_com_openctemio_api_internal_app.NotificationEventEntry:
    properties:
      aggregate_id:
        type: string
      aggregate_type:
        type: string
      body:
        type: string
      created_at:
        type: string
      event_type:
        type: string
      id:
        type: string
      integrations_failed:
        type: integer
      integrations_matched:
        type: integer
      integrations_succeeded:
        type: integer
      integrations_total:
        type: integer
      last_error:
        type: string
      processed_at:
        type: string
      retry_count:
        type: integer
      send_results:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.NotificationEventSendResult'
        type: array
      severity:
        type: string
      status:
        type: string
      title:
        type: string
      url:
        type: string
    type: object
  github_com_openctemio_api_internal_app.NotificationEventSendResult:
    properties:
      error:
        type: string
      integration_id:
        type: string
      message_id:
        type: string
      name:
        type: string
      provider:
        type: string
      sent_at:
        type: string
      status:
        type: string
    type: object
  github_com_openctemio_api_internal_app.ProviderInfo:
    properties:
      enabled:
        type: boolean
      id:
        type: string
      name:
        type: string
    type: object
  github_com_openctemio_api_internal_app.SessionInfo:
    properties:
      created_at:
        type: string
      id:
        type: string
      ip_address:
        type: string
      is_current:
        type: boolean
      last_activity_at:
        type: string
      user_agent:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_audit.Changes:
    properties:
      after:
        additionalProperties: {}
        type: object
      before:
        additionalProperties: {}
        type: object
    type: object
  github_com_openctemio_api_internal_domain_component.ComponentStats:
    properties:
      cisa_kev_components:
        type: integer
      direct_dependencies:
        type: integer
      license_risks:
        additionalProperties:
          type: integer
        description: critical, high, medium, low
        type: object
      outdated_components:
        type: integer
      total_components:
        type: integer
      total_vulnerabilities:
        description: Extended stats from findings analysis
        type: integer
      transitive_dependencies:
        type: integer
      vuln_by_severity:
        additionalProperties:
          type: integer
        description: critical, high, medium, low
        type: object
      vulnerable_components:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_component.EcosystemStats:
    properties:
      ecosystem:
        type: string
      manifest_file:
        type: string
      outdated:
        type: integer
      total:
        type: integer
      vulnerable:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_component.LicenseStats:
    properties:
      category:
        description: permissive, copyleft, weak-copyleft, proprietary, public-domain,
          unknown
        type: string
      count:
        description: Number of components using this license
        type: integer
      license_id:
        description: SPDX identifier
        type: string
      name:
        description: Human-readable name
        type: string
      risk:
        description: critical, high, medium, low, none, unknown
        type: string
      url:
        description: Link to license text (SPDX URL)
        type: string
    type: object
  github_com_openctemio_api_internal_domain_component.VulnerableComponent:
    properties:
      critical_count:
        description: Vulnerability breakdown
        type: integer
      ecosystem:
        type: string
      high_count:
        type: integer
      id:
        type: string
      in_cisa_kev:
        type: boolean
      license:
        type: string
      low_count:
        type: integer
      medium_count:
        type: integer
      name:
        type: string
      purl:
        type: string
      total_count:
        type: integer
      version:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_credential.ImportError:
    properties:
      error:
        type: string
      identifier:
        type: string
      index:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_credential.ImportItemResult:
    properties:
      action:
        description: imported, updated, reactivated, skipped, error
        type: string
      id:
        description: Exposure event ID if created/updated
        type: string
      identifier:
        type: string
      index:
        type: integer
      reason:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_credential.ImportResult:
    properties:
      details:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_credential.ImportItemResult'
        type: array
      errors:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_credential.ImportError'
        type: array
      imported:
        type: integer
      reactivated:
        type: integer
      skipped:
        type: integer
      summary:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_credential.ImportSummary'
      updated:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_credential.ImportSummary:
    properties:
      critical_count:
        type: integer
      error_count:
        type: integer
      reactivated_alert_sent:
        type: boolean
      success_count:
        type: integer
      total_processed:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_group.GroupSettings:
    properties:
      allow_self_join:
        type: boolean
      max_members:
        type: integer
      require_approval:
        type: boolean
    type: object
  github_com_openctemio_api_internal_domain_group.NotificationConfig:
    properties:
      notify_critical:
        type: boolean
      notify_high:
        type: boolean
      notify_low:
        type: boolean
      notify_medium:
        type: boolean
      notify_sla_breach:
        type: boolean
      notify_sla_warning:
        type: boolean
      slack_channel:
        type: string
      weekly_digest:
        type: boolean
    type: object
  github_com_openctemio_api_internal_domain_scanprofile.FindingCounts:
    properties:
      critical:
        type: integer
      high:
        type: integer
      info:
        type: integer
      low:
        type: integer
      medium:
        type: integer
      total:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_scanprofile.GateBreach:
    properties:
      actual:
        type: integer
      limit:
        type: integer
      metric:
        description: '"critical", "high", "medium", "total"'
        type: string
    type: object
  github_com_openctemio_api_internal_domain_scanprofile.QualityGateResult:
    properties:
      breaches:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_scanprofile.GateBreach'
        type: array
      counts:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_scanprofile.FindingCounts'
      passed:
        type: boolean
      reason:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_templatesource.GitSourceConfig:
    properties:
      auth_type:
        description: none, ssh, token, oauth
        type: string
      branch:
        description: main, develop
        type: string
      path:
        description: templates/nuclei/
        type: string
      url:
        description: https://github.com/org/repo
        type: string
    type: object
  github_com_openctemio_api_internal_domain_templatesource.HTTPSourceConfig:
    properties:
      auth_type:
        description: none, bearer, basic, api_key
        type: string
      headers:
        additionalProperties:
          type: string
        type: object
      timeout:
        description: Seconds
        type: integer
      url:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_templatesource.S3SourceConfig:
    properties:
      auth_type:
        description: keys, sts_role
        type: string
      bucket:
        type: string
      endpoint:
        description: For MinIO
        type: string
      external_id:
        description: For STS
        type: string
      prefix:
        description: scanner-templates/nuclei/
        type: string
      region:
        type: string
      role_arn:
        description: For cross-account
        type: string
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.ArtifactLocation:
    properties:
      uri:
        type: string
      uri_base_id:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.Attachment:
    properties:
      artifact_location:
        allOf:
        - $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.ArtifactLocation'
        description: Location of the artifact
      description:
        description: Human-readable description
        type: string
      rectangles:
        description: Highlight areas (for images)
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.Rectangle'
        type: array
      regions:
        description: Relevant regions in the artifact
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.FindingLocation'
        type: array
      type:
        allOf:
        - $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.AttachmentType'
        description: Attachment type for UI categorization
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.AttachmentType:
    enum:
    - evidence
    - screenshot
    - document
    - reference
    - code
    - other
    type: string
    x-enum-comments:
      AttachmentTypeCode: Code snippet or file
      AttachmentTypeDocument: Documentation, reports
      AttachmentTypeEvidence: Supporting evidence (CVE details, advisory links)
      AttachmentTypeOther: Other attachment types
      AttachmentTypeReference: External reference links
      AttachmentTypeScreenshot: Screenshot image
    x-enum-descriptions:
    - Supporting evidence (CVE details, advisory links)
    - Screenshot image
    - Documentation, reports
    - External reference links
    - Code snippet or file
    - Other attachment types
    x-enum-varnames:
    - AttachmentTypeEvidence
    - AttachmentTypeScreenshot
    - AttachmentTypeDocument
    - AttachmentTypeReference
    - AttachmentTypeCode
    - AttachmentTypeOther
  github_com_openctemio_api_internal_domain_vulnerability.FindingLocation:
    properties:
      branch:
        type: string
      commit_sha:
        type: string
      context_snippet:
        type: string
      end_column:
        type: integer
      end_line:
        type: integer
      logical_location:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.LogicalLocation'
      message:
        description: Optional description of why this location is relevant
        type: string
      path:
        type: string
      snippet:
        type: string
      start_column:
        type: integer
      start_line:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.LogicalLocation:
    properties:
      fully_qualified_name:
        type: string
      kind:
        description: function, method, class, module, etc.
        type: string
      name:
        type: string
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.Rectangle:
    properties:
      bottom:
        type: number
      left:
        type: number
      right:
        type: number
      top:
        type: number
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.StackFrame:
    properties:
      location:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.FindingLocation'
      module:
        type: string
      parameters:
        items:
          type: string
        type: array
      thread_id:
        type: integer
    type: object
  github_com_openctemio_api_internal_domain_vulnerability.StackTrace:
    properties:
      frames:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.StackFrame'
        type: array
      message:
        type: string
    type: object
  github_com_openctemio_api_pkg_apierror.Code:
    enum:
    - BAD_REQUEST
    - UNAUTHORIZED
    - FORBIDDEN
    - NOT_FOUND
    - CONFLICT
    - UNPROCESSABLE_ENTITY
    - INTERNAL_ERROR
    - SERVICE_UNAVAILABLE
    - VALIDATION_FAILED
    - RATE_LIMIT_EXCEEDED
    type: string
    x-enum-varnames:
    - CodeBadRequest
    - CodeUnauthorized
    - CodeForbidden
    - CodeNotFound
    - CodeConflict
    - CodeUnprocessableEntity
    - CodeInternalError
    - CodeServiceUnavailable
    - CodeValidationFailed
    - CodeRateLimitExceeded
  github_com_openctemio_api_pkg_apierror.Error:
    properties:
      code:
        allOf:
        - $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Code'
        description: Machine-readable error code
      details:
        description: Additional error details (optional)
      message:
        description: Human-readable error message
        type: string
    type: object
  github_com_openctemio_api_pkg_apierror.Response:
    properties:
      code:
        $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Code'
      details: {}
      error:
        type: string
      message:
        type: string
      request_id:
        type: string
    type: object
  github_com_openctemio_api_pkg_pagination.Result-internal_infra_http_handler_OutboxEntryResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.OutboxEntryResponse'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.APIKeyDataRequest:
    properties:
      key:
        type: string
    required:
    - key
    type: object
  internal_infra_http_handler.AWSRoleDataRequest:
    properties:
      external_id:
        type: string
      role_arn:
        type: string
    required:
    - role_arn
    type: object
  internal_infra_http_handler.ActivityItem:
    properties:
      description:
        type: string
      timestamp:
        type: string
      title:
        type: string
      type:
        type: string
    type: object
  internal_infra_http_handler.AddAssetsRequest:
    properties:
      asset_ids:
        items:
          type: string
        minItems: 1
        type: array
    required:
    - asset_ids
    type: object
  internal_infra_http_handler.AddGroupMemberRequest:
    properties:
      role:
        enum:
        - owner
        - lead
        - member
        type: string
      user_id:
        type: string
    required:
    - role
    - user_id
    type: object
  internal_infra_http_handler.AddPermissionRequest:
    properties:
      modification_type:
        enum:
        - add
        - remove
        type: string
      permission_id:
        type: string
    required:
    - permission_id
    type: object
  internal_infra_http_handler.AdminAuditLogListResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AdminAuditLogResponse'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.AdminAuditLogResponse:
    properties:
      action:
        type: string
      admin_email:
        type: string
      admin_id:
        type: string
      created_at:
        type: string
      error_message:
        type: string
      id:
        type: string
      ip_address:
        type: string
      request_body:
        additionalProperties: true
        type: object
      request_method:
        type: string
      request_path:
        type: string
      resource_id:
        type: string
      resource_name:
        type: string
      resource_type:
        type: string
      response_status:
        type: integer
      success:
        type: boolean
      user_agent:
        type: string
    type: object
  internal_infra_http_handler.AffectedVersionResponse:
    properties:
      ecosystem:
        type: string
      fixed:
        type: string
      introduced:
        type: string
      package:
        type: string
    type: object
  internal_infra_http_handler.AgentDisableRequest:
    properties:
      reason:
        maxLength: 500
        type: string
    type: object
  internal_infra_http_handler.AgentRegenerateAPIKeyResponse:
    properties:
      api_key:
        type: string
    type: object
  internal_infra_http_handler.AgentResponse:
    properties:
      api_key_prefix:
        type: string
      available_slots:
        type: integer
      capabilities:
        items:
          type: string
        type: array
      cpu_percent:
        description: System metrics
        type: number
      created_at:
        type: string
      current_jobs:
        type: integer
      description:
        type: string
      error_count:
        type: integer
      execution_mode:
        type: string
      health:
        description: 'Automatic: unknown, online, offline, error'
        type: string
      hostname:
        type: string
      id:
        type: string
      ip_address:
        type: string
      labels:
        additionalProperties: {}
        type: object
      last_seen_at:
        description: Statistics
        type: string
      load_factor:
        description: 0.0 to 1.0
        type: number
      max_concurrent_jobs:
        description: Load balancing
        type: integer
      memory_percent:
        type: number
      name:
        type: string
      region:
        type: string
      status:
        description: 'Admin-controlled: active, disabled, revoked'
        type: string
      status_message:
        type: string
      tenant_id:
        type: string
      tools:
        items:
          type: string
        type: array
      total_findings:
        type: integer
      total_scans:
        type: integer
      type:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  internal_infra_http_handler.AgentRevokeRequest:
    properties:
      reason:
        maxLength: 500
        type: string
    type: object
  internal_infra_http_handler.AssetBulkStatusRequest:
    properties:
      asset_ids:
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
      status:
        enum:
        - active
        - inactive
        - archived
        type: string
    required:
    - asset_ids
    - status
    type: object
  internal_infra_http_handler.AssetBulkStatusResponse:
    properties:
      errors:
        items:
          type: string
        type: array
      failed:
        type: integer
      updated:
        type: integer
    type: object
  internal_infra_http_handler.AssetChangeResponse:
    properties:
      asset_name:
        example: new-api.example.com
        type: string
      asset_type:
        example: service
        type: string
      timestamp:
        example: "2024-01-15T10:30:00Z"
        type: string
      type:
        example: added
        type: string
    type: object
  internal_infra_http_handler.AssetGroupResponse:
    properties:
      asset_count:
        type: integer
      business_unit:
        type: string
      cloud_count:
        type: integer
      created_at:
        type: string
      credential_count:
        type: integer
      criticality:
        type: string
      description:
        type: string
      domain_count:
        type: integer
      environment:
        type: string
      finding_count:
        type: integer
      id:
        type: string
      name:
        type: string
      owner:
        type: string
      owner_email:
        type: string
      repository_count:
        type: integer
      risk_score:
        type: integer
      service_count:
        type: integer
      tags:
        items:
          type: string
        type: array
      updated_at:
        type: string
      website_count:
        type: integer
    type: object
  internal_infra_http_handler.AssetGroupStatsResponse:
    properties:
      average_risk_score:
        type: number
      by_criticality:
        additionalProperties:
          format: int64
          type: integer
        type: object
      by_environment:
        additionalProperties:
          format: int64
          type: integer
        type: object
      total:
        type: integer
      total_assets:
        type: integer
      total_findings:
        type: integer
    type: object
  internal_infra_http_handler.AssetOwnerResponse:
    properties:
      asset_id:
        type: string
      assigned_at:
        type: string
      assigned_by:
        type: string
      group_id:
        type: string
      id:
        type: string
      ownership_type:
        type: string
      user_id:
        type: string
    type: object
  internal_infra_http_handler.AssetResponse:
    properties:
      created_at:
        type: string
      criticality:
        type: string
      description:
        type: string
      exposure:
        type: string
      external_id:
        type: string
      finding_count:
        type: integer
      first_seen:
        type: string
      id:
        type: string
      last_seen:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      provider:
        type: string
      risk_score:
        type: integer
      scope:
        type: string
      status:
        type: string
      tags:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      type:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.AssetServiceResponse:
    properties:
      asset_id:
        type: string
      banner:
        type: string
      cpe:
        type: string
      created_at:
        type: string
      discovered_at:
        type: string
      discovery_source:
        type: string
      exposure:
        type: string
      finding_count:
        type: integer
      id:
        type: string
      is_public:
        type: boolean
      last_seen_at:
        type: string
      name:
        type: string
      port:
        type: integer
      product:
        type: string
      protocol:
        type: string
      risk_score:
        type: integer
      service_type:
        type: string
      state:
        type: string
      state_changed_at:
        type: string
      tenant_id:
        type: string
      tls_enabled:
        type: boolean
      tls_version:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  internal_infra_http_handler.AssetServiceStatsResponse:
    properties:
      public_services:
        type: integer
      service_type_counts:
        additionalProperties:
          type: integer
        type: object
      top_ports:
        items:
          $ref: '#/definitions/internal_infra_http_handler.PortCountResponse'
        type: array
      total_services:
        type: integer
    type: object
  internal_infra_http_handler.AssetStats:
    properties:
      by_status:
        additionalProperties:
          type: integer
        type: object
      by_type:
        additionalProperties:
          type: integer
        type: object
      risk_score:
        type: number
      total:
        type: integer
    type: object
  internal_infra_http_handler.AssetStatsResponse:
    properties:
      by_criticality:
        additionalProperties:
          type: integer
        type: object
      by_exposure:
        additionalProperties:
          type: integer
        type: object
      by_scope:
        additionalProperties:
          type: integer
        type: object
      by_status:
        additionalProperties:
          type: integer
        type: object
      by_type:
        additionalProperties:
          type: integer
        type: object
      findings_total:
        type: integer
      high_risk_count:
        description: Assets with risk_score >= 70
        type: integer
      risk_score_avg:
        type: number
      total:
        type: integer
      with_findings:
        type: integer
    type: object
  internal_infra_http_handler.AssetTypeBreakdownResponse:
    properties:
      exposed:
        example: 12
        type: integer
      total:
        example: 45
        type: integer
      type:
        example: domain
        type: string
    type: object
  internal_infra_http_handler.AssetTypeResponse:
    properties:
      category:
        $ref: '#/definitions/internal_infra_http_handler.CategoryResponse'
      category_id:
        type: string
      code:
        type: string
      color:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_order:
        type: integer
      icon:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      is_discoverable:
        type: boolean
      is_scannable:
        type: boolean
      is_system:
        type: boolean
      name:
        type: string
      pattern_example:
        type: string
      pattern_placeholder:
        type: string
      pattern_regex:
        type: string
      supports_cidr:
        type: boolean
      supports_wildcard:
        type: boolean
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.AssetWithRepositoryResponse:
    properties:
      created_at:
        type: string
      criticality:
        type: string
      description:
        type: string
      exposure:
        type: string
      external_id:
        type: string
      finding_count:
        type: integer
      first_seen:
        type: string
      id:
        type: string
      last_seen:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      provider:
        type: string
      repository:
        $ref: '#/definitions/internal_infra_http_handler.RepositoryExtensionResponse'
      risk_score:
        type: integer
      scope:
        type: string
      status:
        type: string
      tags:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      type:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.AssignAssetRequest:
    properties:
      asset_id:
        type: string
      ownership_type:
        enum:
        - primary
        - secondary
        - stakeholder
        - informed
        type: string
    required:
    - asset_id
    - ownership_type
    type: object
  internal_infra_http_handler.AssignFindingRequest:
    properties:
      user_id:
        type: string
    required:
    - user_id
    type: object
  internal_infra_http_handler.AssignPermissionSetRequest:
    properties:
      permission_set_id:
        type: string
    required:
    - permission_set_id
    type: object
  internal_infra_http_handler.AttackSurfaceStatsResponse:
    description: Attack surface statistics response
    properties:
      asset_breakdown:
        description: Asset breakdown by type
        items:
          $ref: '#/definitions/internal_infra_http_handler.AssetTypeBreakdownResponse'
        type: array
      critical_exposures:
        example: 12
        type: integer
      critical_exposures_change:
        example: 2
        type: integer
      exposed_services:
        example: 47
        type: integer
      exposed_services_change:
        example: -3
        type: integer
      exposed_services_list:
        description: Top exposed services
        items:
          $ref: '#/definitions/internal_infra_http_handler.ExposedServiceResponse'
        type: array
      recent_changes:
        description: Recent changes
        items:
          $ref: '#/definitions/internal_infra_http_handler.AssetChangeResponse'
        type: array
      risk_score:
        example: 72.5
        type: number
      total_assets:
        description: Summary statistics
        example: 303
        type: integer
      total_assets_change:
        description: Trends (week-over-week changes)
        example: 12
        type: integer
    type: object
  internal_infra_http_handler.AuditLogListResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AuditLogResponse'
        type: array
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.AuditLogResponse:
    properties:
      action:
        type: string
      actor_email:
        type: string
      actor_id:
        type: string
      actor_ip:
        type: string
      changes:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_audit.Changes'
      id:
        type: string
      message:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      request_id:
        type: string
      resource_id:
        type: string
      resource_name:
        type: string
      resource_type:
        type: string
      result:
        type: string
      severity:
        type: string
      tenant_id:
        type: string
      timestamp:
        type: string
    type: object
  internal_infra_http_handler.AuditStatsResponse:
    properties:
      logs_by_action:
        additionalProperties:
          format: int64
          type: integer
        type: object
      logs_by_result:
        additionalProperties:
          format: int64
          type: integer
        type: object
      recent_actions:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AuditLogResponse'
        type: array
      total_logs:
        type: integer
    type: object
  internal_infra_http_handler.AuthInfoResponse:
    properties:
      email_verification_required:
        type: boolean
      provider:
        type: string
      registration_enabled:
        type: boolean
    type: object
  internal_infra_http_handler.AuthorizeResponse:
    properties:
      authorization_url:
        type: string
      state:
        type: string
    type: object
  internal_infra_http_handler.AvailableCapabilitiesResponse:
    properties:
      capabilities:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.AzureServicePrincipalDataRequest:
    properties:
      client_id:
        type: string
      client_secret:
        type: string
      tenant_id:
        type: string
    required:
    - client_id
    - client_secret
    - tenant_id
    type: object
  internal_infra_http_handler.BasicAuthDataRequest:
    properties:
      password:
        type: string
      username:
        type: string
    required:
    - password
    - username
    type: object
  internal_infra_http_handler.BearerTokenDataRequest:
    properties:
      token:
        type: string
    required:
    - token
    type: object
  internal_infra_http_handler.BootstrapPermissions:
    properties:
      list:
        items:
          type: string
        type: array
      version:
        type: integer
    type: object
  internal_infra_http_handler.BootstrapResponse:
    properties:
      modules:
        $ref: '#/definitions/internal_infra_http_handler.TenantModulesResponse'
      permissions:
        $ref: '#/definitions/internal_infra_http_handler.BootstrapPermissions'
      subscription:
        $ref: '#/definitions/internal_infra_http_handler.SubscriptionResponse'
    type: object
  internal_infra_http_handler.BootstrapTokenResponse:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      current_uses:
        type: integer
      description:
        type: string
      expires_at:
        type: string
      id:
        type: string
      max_uses:
        type: integer
      required_capabilities:
        items:
          type: string
        type: array
      required_region:
        type: string
      required_tools:
        items:
          type: string
        type: array
      status:
        type: string
      token_prefix:
        type: string
    type: object
  internal_infra_http_handler.BranchResponse:
    properties:
      created_at:
        type: string
      findings_critical:
        type: integer
      findings_high:
        type: integer
      findings_low:
        type: integer
      findings_medium:
        type: integer
      findings_total:
        type: integer
      id:
        type: string
      is_default:
        type: boolean
      is_protected:
        type: boolean
      keep_when_inactive:
        type: boolean
      last_commit_at:
        type: string
      last_commit_author:
        type: string
      last_commit_author_avatar:
        type: string
      last_commit_message:
        type: string
      last_commit_sha:
        type: string
      last_scan_id:
        type: string
      last_scanned_at:
        type: string
      name:
        type: string
      quality_gate_status:
        type: string
      repository_id:
        type: string
      retention_days:
        type: integer
      scan_on_pr:
        type: boolean
      scan_on_push:
        type: boolean
      scan_status:
        type: string
      type:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.BulkActionRequest:
    properties:
      scan_ids:
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
    required:
    - scan_ids
    type: object
  internal_infra_http_handler.BulkActionResponse:
    properties:
      failed:
        items:
          properties:
            error:
              type: string
            id:
              type: string
          type: object
        type: array
      message:
        type: string
      successful:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.BulkAssignRequest:
    properties:
      finding_ids:
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
      user_id:
        type: string
    required:
    - finding_ids
    - user_id
    type: object
  internal_infra_http_handler.BulkDeleteRequest:
    properties:
      group_ids:
        items:
          type: string
        minItems: 1
        type: array
    required:
    - group_ids
    type: object
  internal_infra_http_handler.BulkIngestRequest:
    properties:
      exposures:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CreateExposureRequest'
        maxItems: 1000
        minItems: 1
        type: array
    required:
    - exposures
    type: object
  internal_infra_http_handler.BulkSyncRequest:
    properties:
      asset_ids:
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
    required:
    - asset_ids
    type: object
  internal_infra_http_handler.BulkSyncResponse:
    properties:
      failed_count:
        type: integer
      results:
        items:
          $ref: '#/definitions/internal_infra_http_handler.BulkSyncResultItem'
        type: array
      success_count:
        type: integer
      synced_at:
        type: string
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.BulkSyncResultItem:
    properties:
      asset_id:
        type: string
      error:
        type: string
      message:
        type: string
      success:
        type: boolean
      updated_fields:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.BulkToolIDsRequest:
    properties:
      tool_ids:
        items:
          type: string
        minItems: 1
        type: array
    required:
    - tool_ids
    type: object
  internal_infra_http_handler.BulkUpdateRequest:
    properties:
      group_ids:
        items:
          type: string
        minItems: 1
        type: array
      update:
        properties:
          criticality:
            type: string
          environment:
            type: string
        type: object
    required:
    - group_ids
    type: object
  internal_infra_http_handler.BulkUpdateResponse:
    properties:
      errors:
        items:
          type: string
        type: array
      failed:
        type: integer
      updated:
        type: integer
    type: object
  internal_infra_http_handler.BulkUpdateStatusRequest:
    properties:
      finding_ids:
        items:
          type: string
        maxItems: 100
        minItems: 1
        type: array
      resolution:
        maxLength: 1000
        type: string
      status:
        type: string
    required:
    - finding_ids
    - status
    type: object
  internal_infra_http_handler.CISAKEVResponse:
    properties:
      date_added:
        type: string
      due_date:
        type: string
      is_past_due:
        type: boolean
      notes:
        type: string
      ransomware_use:
        type: string
    type: object
  internal_infra_http_handler.CallbackRequest:
    properties:
      code:
        type: string
      redirect_uri:
        type: string
      state:
        type: string
    type: object
  internal_infra_http_handler.CallbackResponse:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
      user:
        $ref: '#/definitions/internal_infra_http_handler.UserInfo'
    type: object
  internal_infra_http_handler.CategoryResponse:
    properties:
      code:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_order:
        type: integer
      icon:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      name:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ChangePasswordRequest:
    properties:
      current_password:
        type: string
      new_password:
        maxLength: 128
        minLength: 8
        type: string
    required:
    - current_password
    - new_password
    type: object
  internal_infra_http_handler.ChangeStateRequest:
    properties:
      reason:
        maxLength: 500
        type: string
    type: object
  internal_infra_http_handler.CheckFingerprintsRequest:
    properties:
      fingerprints:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.CheckFingerprintsResponse:
    properties:
      existing:
        description: Fingerprints that already exist
        items:
          type: string
        type: array
      missing:
        description: Fingerprints that don't exist
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.CheckResult:
    properties:
      duration:
        type: string
      error:
        type: string
      status:
        type: string
    type: object
  internal_infra_http_handler.ChunkIngestRequest:
    properties:
      chunk_index:
        description: 0-indexed chunk number
        type: integer
      compression:
        description: Compression algorithm (zstd, gzip, none)
        type: string
      data:
        description: Base64-encoded chunk data
        type: string
      is_final:
        description: True for the last chunk
        type: boolean
      report_id:
        description: Unique ID for the chunked report
        type: string
      total_chunks:
        description: Total number of chunks
        type: integer
    type: object
  internal_infra_http_handler.ChunkIngestResponse:
    properties:
      assets_created:
        type: integer
      assets_updated:
        type: integer
      chunk_id:
        type: string
      chunk_index:
        type: integer
      findings_created:
        type: integer
      findings_skipped:
        type: integer
      findings_updated:
        type: integer
      report_id:
        type: string
      status:
        type: string
    type: object
  internal_infra_http_handler.ClaimJobRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
      tools:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
    required:
    - capabilities
    - tools
    type: object
  internal_infra_http_handler.ClaimJobResponse:
    properties:
      auth_token:
        type: string
      job:
        $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
      no_job_available:
        type: boolean
    type: object
  internal_infra_http_handler.ClassifyFindingRequest:
    properties:
      cve_id:
        maxLength: 20
        type: string
      cvss_score:
        maximum: 10
        minimum: 0
        type: number
      cvss_vector:
        maxLength: 100
        type: string
      cwe_ids:
        items:
          type: string
        maxItems: 20
        type: array
      owasp_ids:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.CloneScanProfileRequest:
    properties:
      new_name:
        maxLength: 100
        minLength: 1
        type: string
    required:
    - new_name
    type: object
  internal_infra_http_handler.CloneScanRequest:
    properties:
      name:
        maxLength: 200
        minLength: 1
        type: string
    required:
    - name
    type: object
  internal_infra_http_handler.CommandResponse:
    properties:
      acknowledged_at:
        type: string
      agent_id:
        type: string
      completed_at:
        type: string
      created_at:
        type: string
      error_message:
        type: string
      expires_at:
        type: string
      id:
        type: string
      payload:
        items:
          type: integer
        type: array
      priority:
        type: string
      result:
        items:
          type: integer
        type: array
      started_at:
        type: string
      status:
        type: string
      tenant_id:
        type: string
      type:
        type: string
    type: object
  internal_infra_http_handler.ComponentResponse:
    properties:
      asset_id:
        type: string
      created_at:
        type: string
      dependency_type:
        type: string
      depth:
        description: 'Dependency hierarchy fields (industry-aligned: CycloneDX, Snyk,
          GitHub)'
        type: integer
      ecosystem:
        type: string
      id:
        type: string
      is_direct:
        description: 'Convenience: depth == 1'
        type: boolean
      license:
        type: string
      manifest_file:
        type: string
      manifest_path:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      namespace:
        type: string
      package_manager:
        type: string
      parent_component_id:
        description: asset_components.id of parent dependency
        type: string
      purl:
        type: string
      status:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
      version:
        type: string
      vulnerability_count:
        type: integer
    type: object
  internal_infra_http_handler.CreateAgentRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      description:
        maxLength: 1000
        type: string
      execution_mode:
        enum:
        - standalone
        - daemon
        type: string
      max_concurrent_jobs:
        maximum: 100
        minimum: 1
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
      tools:
        items:
          type: string
        maxItems: 20
        type: array
      type:
        enum:
        - runner
        - worker
        - collector
        - sensor
        type: string
    required:
    - name
    - type
    type: object
  internal_infra_http_handler.CreateAgentResponse:
    properties:
      agent:
        $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
      api_key:
        type: string
    type: object
  internal_infra_http_handler.CreateAssetGroupRequest:
    properties:
      business_unit:
        maxLength: 255
        type: string
      criticality:
        type: string
      description:
        maxLength: 1000
        type: string
      environment:
        type: string
      existing_asset_ids:
        items:
          type: string
        type: array
      name:
        maxLength: 255
        minLength: 1
        type: string
      owner:
        maxLength: 255
        type: string
      owner_email:
        maxLength: 255
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
    required:
    - criticality
    - environment
    - name
    type: object
  internal_infra_http_handler.CreateAssetRequest:
    properties:
      criticality:
        type: string
      description:
        maxLength: 1000
        type: string
      exposure:
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      scope:
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      type:
        type: string
    required:
    - criticality
    - name
    - type
    type: object
  internal_infra_http_handler.CreateAssetServiceRequest:
    properties:
      banner:
        maxLength: 4096
        type: string
      cpe:
        maxLength: 500
        type: string
      discovery_source:
        maxLength: 100
        type: string
      exposure:
        enum:
        - public
        - restricted
        - private
        type: string
      is_public:
        type: boolean
      name:
        maxLength: 255
        type: string
      port:
        maximum: 65535
        minimum: 1
        type: integer
      product:
        maxLength: 255
        type: string
      protocol:
        enum:
        - tcp
        - udp
        type: string
      service_type:
        type: string
      tls_enabled:
        type: boolean
      tls_version:
        maxLength: 20
        type: string
      version:
        maxLength: 100
        type: string
    required:
    - port
    - protocol
    - service_type
    type: object
  internal_infra_http_handler.CreateBootstrapTokenRequest:
    properties:
      description:
        maxLength: 500
        type: string
      expires_in_hours:
        maximum: 168
        minimum: 1
        type: integer
      max_uses:
        maximum: 100
        minimum: 1
        type: integer
      required_capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      required_region:
        maxLength: 50
        type: string
      required_tools:
        items:
          type: string
        maxItems: 20
        type: array
    required:
    - description
    - expires_in_hours
    - max_uses
    type: object
  internal_infra_http_handler.CreateBootstrapTokenResponse:
    properties:
      raw_token:
        type: string
      token:
        $ref: '#/definitions/internal_infra_http_handler.BootstrapTokenResponse'
    type: object
  internal_infra_http_handler.CreateBranchRequest:
    properties:
      is_default:
        type: boolean
      is_protected:
        type: boolean
      last_commit_sha:
        maxLength: 40
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      type:
        type: string
    required:
    - name
    - type
    type: object
  internal_infra_http_handler.CreateCommandRequest:
    properties:
      agent_id:
        type: string
      expires_in:
        description: Seconds until expiration
        type: integer
      payload:
        items:
          type: integer
        type: array
      priority:
        enum:
        - low
        - normal
        - high
        - critical
        type: string
      type:
        enum:
        - scan
        - collect
        - health_check
        - config_update
        - cancel
        type: string
    required:
    - type
    type: object
  internal_infra_http_handler.CreateComponentRequest:
    properties:
      asset_id:
        type: string
      dependency_type:
        type: string
      ecosystem:
        type: string
      license:
        maxLength: 100
        type: string
      manifest_file:
        maxLength: 255
        type: string
      manifest_path:
        maxLength: 500
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      namespace:
        maxLength: 255
        type: string
      package_manager:
        maxLength: 50
        type: string
      version:
        maxLength: 100
        type: string
    required:
    - asset_id
    - ecosystem
    - name
    - version
    type: object
  internal_infra_http_handler.CreateCredentialRequest:
    properties:
      api_key:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.APIKeyDataRequest'
        description: Credential data (only one should be set based on credential_type)
      aws_role:
        $ref: '#/definitions/internal_infra_http_handler.AWSRoleDataRequest'
      azure_service_principal:
        $ref: '#/definitions/internal_infra_http_handler.AzureServicePrincipalDataRequest'
      basic_auth:
        $ref: '#/definitions/internal_infra_http_handler.BasicAuthDataRequest'
      bearer_token:
        $ref: '#/definitions/internal_infra_http_handler.BearerTokenDataRequest'
      credential_type:
        enum:
        - api_key
        - basic_auth
        - bearer_token
        - ssh_key
        - aws_role
        - gcp_service_account
        - azure_service_principal
        - github_app
        - gitlab_token
        type: string
      description:
        maxLength: 1000
        type: string
      expires_at:
        type: string
      gcp_service_account:
        $ref: '#/definitions/internal_infra_http_handler.GCPServiceAccountDataRequest'
      github_app:
        $ref: '#/definitions/internal_infra_http_handler.GitHubAppDataRequest'
      gitlab_token:
        $ref: '#/definitions/internal_infra_http_handler.GitLabTokenDataRequest'
      name:
        maxLength: 255
        minLength: 1
        type: string
      ssh_key:
        $ref: '#/definitions/internal_infra_http_handler.SSHKeyDataRequest'
    required:
    - credential_type
    - name
    type: object
  internal_infra_http_handler.CreateExposureRequest:
    properties:
      asset_id:
        type: string
      description:
        maxLength: 2000
        type: string
      details:
        additionalProperties: {}
        type: object
      event_type:
        type: string
      severity:
        type: string
      source:
        maxLength: 100
        type: string
      title:
        maxLength: 500
        minLength: 1
        type: string
    required:
    - event_type
    - severity
    - source
    - title
    type: object
  internal_infra_http_handler.CreateFindingRequest:
    properties:
      asset_id:
        type: string
      branch_id:
        type: string
      component_id:
        type: string
      end_column:
        minimum: 0
        type: integer
      end_line:
        minimum: 0
        type: integer
      file_path:
        maxLength: 500
        type: string
      message:
        maxLength: 2000
        type: string
      rule_id:
        maxLength: 255
        type: string
      scan_id:
        maxLength: 100
        type: string
      severity:
        type: string
      snippet:
        maxLength: 5000
        type: string
      source:
        type: string
      start_column:
        minimum: 0
        type: integer
      start_line:
        minimum: 0
        type: integer
      tool_name:
        maxLength: 100
        type: string
      tool_version:
        maxLength: 50
        type: string
      vulnerability_id:
        type: string
    required:
    - asset_id
    - message
    - severity
    - source
    - tool_name
    type: object
  internal_infra_http_handler.CreateGroupRequest:
    properties:
      description:
        maxLength: 500
        type: string
      group_type:
        enum:
        - security_team
        - team
        - department
        - project
        - external
        type: string
      name:
        maxLength: 100
        minLength: 2
        type: string
      settings:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.GroupSettings'
      slug:
        maxLength: 100
        minLength: 2
        type: string
    required:
    - group_type
    - name
    - slug
    type: object
  internal_infra_http_handler.CreateIntegrationRequest:
    description: Request body for creating a new integration
    properties:
      auth_type:
        enum:
        - token
        - oauth
        - api_key
        - basic
        - app
        example: token
        type: string
      base_url:
        example: https://github.com
        type: string
      category:
        enum:
        - scm
        - security
        - cloud
        - ticketing
        - notification
        example: scm
        type: string
      credentials:
        example: YOUR_TOKEN_HERE
        maxLength: 5000
        type: string
      description:
        example: Main GitHub integration
        maxLength: 1000
        type: string
      name:
        example: GitHub Production
        maxLength: 255
        minLength: 1
        type: string
      provider:
        example: github
        type: string
      scm_organization:
        example: my-organization
        maxLength: 255
        type: string
    required:
    - auth_type
    - category
    - name
    - provider
    type: object
  internal_infra_http_handler.CreateNotificationIntegrationRequest:
    properties:
      auth_type:
        enum:
        - token
        - api_key
        type: string
      channel_id:
        description: Notification-specific fields
        type: string
      channel_name:
        type: string
      credentials:
        description: Webhook URL or Bot Token
        type: string
      description:
        maxLength: 1000
        type: string
      enabled_event_types:
        description: Event types to receive notifications for
        items:
          type: string
        type: array
      enabled_severities:
        description: Severity levels to notify on (critical, high, medium, low, info,
          none)
        items:
          type: string
        type: array
      include_details:
        type: boolean
      message_template:
        type: string
      min_interval_minutes:
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
      provider:
        enum:
        - slack
        - teams
        - telegram
        - webhook
        - email
        type: string
    required:
    - auth_type
    - credentials
    - name
    - provider
    type: object
  internal_infra_http_handler.CreatePermissionSetRequest:
    properties:
      description:
        maxLength: 500
        type: string
      name:
        maxLength: 100
        minLength: 2
        type: string
      parent_set_id:
        type: string
      permissions:
        items:
          type: string
        type: array
      set_type:
        enum:
        - custom
        - extended
        - cloned
        type: string
      slug:
        maxLength: 100
        minLength: 2
        type: string
    required:
    - name
    - set_type
    - slug
    type: object
  internal_infra_http_handler.CreatePlatformAgentRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
      description:
        maxLength: 1000
        type: string
      labels:
        additionalProperties:
          type: string
        type: object
      max_concurrent_jobs:
        maximum: 50
        minimum: 1
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
      region:
        maxLength: 50
        type: string
      tools:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
    required:
    - capabilities
    - max_concurrent_jobs
    - name
    - region
    - tools
    type: object
  internal_infra_http_handler.CreatePlatformAgentResponse:
    properties:
      agent:
        $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
      api_key:
        type: string
    type: object
  internal_infra_http_handler.CreateRepositoryAssetRequest:
    properties:
      clone_url:
        description: URLs
        type: string
      criticality:
        type: string
      default_branch:
        description: Repository settings
        maxLength: 100
        type: string
      description:
        maxLength: 1000
        type: string
      exposure:
        type: string
      external_id:
        maxLength: 255
        type: string
      forks:
        minimum: 0
        type: integer
      full_name:
        maxLength: 500
        type: string
      language:
        maxLength: 50
        type: string
      languages:
        additionalProperties:
          format: int64
          type: integer
        type: object
      name:
        description: Basic info
        maxLength: 255
        minLength: 1
        type: string
      open_issues:
        minimum: 0
        type: integer
      provider:
        description: SCM connection info
        type: string
      repo_created_at:
        description: Timestamps from SCM (ISO 8601 format)
        type: string
      repo_id:
        maxLength: 255
        type: string
      repo_pushed_at:
        type: string
      repo_updated_at:
        type: string
      scan_enabled:
        description: Scan settings
        type: boolean
      scan_schedule:
        maxLength: 100
        type: string
      scm_organization:
        maxLength: 255
        type: string
      scope:
        type: string
      size_kb:
        minimum: 0
        type: integer
      ssh_url:
        maxLength: 500
        type: string
      stars:
        description: Stats
        minimum: 0
        type: integer
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      topics:
        items:
          type: string
        maxItems: 50
        type: array
      visibility:
        type: string
      watchers:
        minimum: 0
        type: integer
      web_url:
        type: string
    required:
    - criticality
    - full_name
    - name
    type: object
  internal_infra_http_handler.CreateSLAPolicyRequest:
    properties:
      asset_id:
        type: string
      critical_days:
        maximum: 365
        minimum: 1
        type: integer
      description:
        maxLength: 500
        type: string
      escalation_config:
        additionalProperties: {}
        type: object
      escalation_enabled:
        type: boolean
      high_days:
        maximum: 365
        minimum: 1
        type: integer
      info_days:
        maximum: 365
        minimum: 1
        type: integer
      is_default:
        type: boolean
      low_days:
        maximum: 365
        minimum: 1
        type: integer
      medium_days:
        maximum: 365
        minimum: 1
        type: integer
      name:
        maxLength: 100
        minLength: 1
        type: string
      warning_threshold_pct:
        maximum: 100
        minimum: 0
        type: integer
    required:
    - critical_days
    - high_days
    - info_days
    - low_days
    - medium_days
    - name
    type: object
  internal_infra_http_handler.CreateScanProfileRequest:
    properties:
      description:
        maxLength: 500
        type: string
      intensity:
        enum:
        - low
        - medium
        - high
        type: string
      is_default:
        type: boolean
      max_concurrent_scans:
        maximum: 100
        minimum: 1
        type: integer
      name:
        maxLength: 100
        minLength: 1
        type: string
      quality_gate:
        $ref: '#/definitions/internal_infra_http_handler.QualityGateRequest'
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      timeout_seconds:
        maximum: 86400
        minimum: 60
        type: integer
      tools_config:
        additionalProperties:
          $ref: '#/definitions/internal_infra_http_handler.ToolConfigRequest'
        type: object
    required:
    - name
    type: object
  internal_infra_http_handler.CreateScanRequest:
    properties:
      asset_group_id:
        description: Single asset group (legacy)
        type: string
      asset_group_ids:
        description: Multiple asset groups (NEW)
        items:
          type: string
        type: array
      description:
        maxLength: 1000
        type: string
      name:
        maxLength: 200
        minLength: 1
        type: string
      pipeline_id:
        type: string
      run_on_tenant_runner:
        type: boolean
      scan_type:
        enum:
        - workflow
        - single
        type: string
      scanner_config:
        additionalProperties: {}
        type: object
      scanner_name:
        maxLength: 100
        type: string
      schedule_cron:
        maxLength: 100
        type: string
      schedule_day:
        type: integer
      schedule_time:
        type: string
      schedule_type:
        enum:
        - manual
        - daily
        - weekly
        - monthly
        - crontab
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      targets:
        description: Direct targets
        items:
          type: string
        maxItems: 1000
        type: array
      targets_per_job:
        type: integer
      timezone:
        maxLength: 50
        type: string
    required:
    - name
    - scan_type
    type: object
  internal_infra_http_handler.CreateScanScheduleRequest:
    properties:
      cron_expression:
        maxLength: 100
        type: string
      description:
        maxLength: 1000
        type: string
      interval_hours:
        maximum: 8760
        minimum: 0
        type: integer
      name:
        maxLength: 200
        minLength: 1
        type: string
      notification_channels:
        items:
          type: string
        maxItems: 10
        type: array
      notify_on_completion:
        type: boolean
      notify_on_findings:
        type: boolean
      scan_type:
        type: string
      scanner_configs:
        additionalProperties: true
        type: object
      schedule_type:
        type: string
      target_ids:
        items:
          type: string
        maxItems: 100
        type: array
      target_scope:
        type: string
      target_tags:
        items:
          type: string
        maxItems: 20
        type: array
    required:
    - name
    - scan_type
    - schedule_type
    type: object
  internal_infra_http_handler.CreateScannerTemplateRequest:
    properties:
      content:
        description: Base64 encoded
        type: string
      description:
        maxLength: 1000
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      template_type:
        enum:
        - nuclei
        - semgrep
        - gitleaks
        type: string
    required:
    - content
    - name
    - template_type
    type: object
  internal_infra_http_handler.CreateScopeExclusionRequest:
    properties:
      exclusion_type:
        type: string
      expires_at:
        type: string
      pattern:
        maxLength: 500
        type: string
      reason:
        maxLength: 1000
        type: string
    required:
    - exclusion_type
    - pattern
    - reason
    type: object
  internal_infra_http_handler.CreateScopeTargetRequest:
    properties:
      description:
        maxLength: 1000
        type: string
      pattern:
        maxLength: 500
        type: string
      priority:
        maximum: 100
        minimum: 0
        type: integer
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      target_type:
        type: string
    required:
    - pattern
    - target_type
    type: object
  internal_infra_http_handler.CreateTemplateSourceRequest:
    properties:
      auto_sync_on_scan:
        type: boolean
      cache_ttl_minutes:
        maximum: 10080
        minimum: 0
        type: integer
      credential_id:
        type: string
      description:
        maxLength: 1000
        type: string
      enabled:
        type: boolean
      git_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.GitSourceConfig'
      http_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.HTTPSourceConfig'
      name:
        maxLength: 255
        minLength: 1
        type: string
      s3_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.S3SourceConfig'
      source_type:
        enum:
        - git
        - s3
        - http
        type: string
      template_type:
        enum:
        - nuclei
        - semgrep
        - gitleaks
        type: string
    required:
    - name
    - source_type
    - template_type
    type: object
  internal_infra_http_handler.CreateToolRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      category_id:
        description: UUID reference to tool_categories table
        type: string
      config_schema:
        additionalProperties: {}
        type: object
      default_config:
        additionalProperties: {}
        type: object
      description:
        maxLength: 1000
        type: string
      display_name:
        maxLength: 100
        type: string
      docs_url:
        maxLength: 500
        type: string
      github_url:
        maxLength: 500
        type: string
      install_cmd:
        maxLength: 500
        type: string
      install_method:
        enum:
        - go
        - pip
        - npm
        - docker
        - binary
        type: string
      logo_url:
        maxLength: 500
        type: string
      name:
        maxLength: 50
        minLength: 1
        type: string
      output_formats:
        items:
          type: string
        maxItems: 10
        type: array
      supported_targets:
        items:
          type: string
        maxItems: 10
        type: array
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      update_cmd:
        maxLength: 500
        type: string
      version_cmd:
        maxLength: 500
        type: string
      version_regex:
        maxLength: 200
        type: string
    required:
    - install_method
    - name
    type: object
  internal_infra_http_handler.CreateVulnerabilityRequest:
    properties:
      cve_id:
        type: string
      cvss_score:
        maximum: 10
        minimum: 0
        type: number
      cvss_vector:
        maxLength: 100
        type: string
      description:
        maxLength: 10000
        type: string
      epss_percentile:
        maximum: 1
        minimum: 0
        type: number
      epss_score:
        maximum: 1
        minimum: 0
        type: number
      exploit_available:
        type: boolean
      exploit_maturity:
        type: string
      fixed_versions:
        items:
          type: string
        maxItems: 50
        type: array
      remediation:
        maxLength: 5000
        type: string
      severity:
        type: string
      title:
        maxLength: 500
        minLength: 1
        type: string
    required:
    - cve_id
    - severity
    - title
    type: object
  internal_infra_http_handler.CredentialContextReq:
    properties:
      domain:
        type: string
      email:
        type: string
      extra:
        additionalProperties: {}
        type: object
      ip_address:
        type: string
      line_number:
        type: integer
      user_agent:
        type: string
      username:
        type: string
    type: object
  internal_infra_http_handler.CredentialImportItem:
    properties:
      classification:
        type: string
      context:
        $ref: '#/definitions/internal_infra_http_handler.CredentialContextReq'
      credential_type:
        type: string
      dedup_key:
        $ref: '#/definitions/internal_infra_http_handler.DedupKeyRequest'
      identifier:
        maxLength: 500
        type: string
      is_revoked:
        type: boolean
      is_verified:
        type: boolean
      notes:
        type: string
      secret_value:
        description: The actual leaked secret (password, API key, etc.)
        type: string
      severity:
        type: string
      source:
        $ref: '#/definitions/internal_infra_http_handler.CredentialSourceReq'
      tags:
        items:
          type: string
        type: array
    required:
    - credential_type
    - identifier
    - source
    type: object
  internal_infra_http_handler.CredentialImportRequest:
    properties:
      credentials:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CredentialImportItem'
        maxItems: 1000
        minItems: 1
        type: array
      metadata:
        $ref: '#/definitions/internal_infra_http_handler.ImportMetadataRequest'
      options:
        $ref: '#/definitions/internal_infra_http_handler.ImportOptionsRequest'
    required:
    - credentials
    type: object
  internal_infra_http_handler.CredentialResponse:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      credential_type:
        type: string
      description:
        type: string
      expires_at:
        type: string
      id:
        type: string
      last_rotated_at:
        type: string
      last_used_at:
        type: string
      name:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.CredentialSourceReq:
    properties:
      discovered_at:
        description: ISO8601 format
        type: string
      name:
        type: string
      type:
        type: string
      url:
        type: string
    required:
    - type
    type: object
  internal_infra_http_handler.CredentialStateChangeRequest:
    properties:
      notes:
        maxLength: 500
        type: string
    type: object
  internal_infra_http_handler.CustomPatternResponse:
    properties:
      name:
        type: string
      pattern:
        type: string
    type: object
  internal_infra_http_handler.CustomTemplateResponse:
    properties:
      content:
        type: string
      name:
        type: string
      path:
        type: string
    type: object
  internal_infra_http_handler.DNSRecordResult:
    properties:
      host:
        type: string
      record_type:
        type: string
      resolver:
        type: string
      status_code:
        type: string
      ttl:
        type: integer
      values:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.DailyActivityResponse:
    properties:
      appeared:
        type: integer
      date:
        type: string
      disappeared:
        type: integer
      exposure_change:
        type: integer
      other_changes:
        type: integer
      recovered:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.DashboardStatsResponse:
    properties:
      assets:
        $ref: '#/definitions/internal_infra_http_handler.AssetStats'
      findings:
        $ref: '#/definitions/internal_infra_http_handler.FindingStats'
      recent_activity:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ActivityItem'
        type: array
      repositories:
        $ref: '#/definitions/internal_infra_http_handler.RepositoryStats'
    type: object
  internal_infra_http_handler.DataFlowLocationResponse:
    properties:
      class_name:
        type: string
      column:
        type: integer
      end_column:
        type: integer
      end_line:
        type: integer
      fully_qualified_name:
        type: string
      function_name:
        description: Logical location (function/class context)
        type: string
      importance:
        description: essential, important, unimportant
        type: string
      index:
        description: Step order in the flow
        type: integer
      label:
        description: Context
        type: string
      line:
        type: integer
      location_type:
        description: source, intermediate, sink, sanitizer
        type: string
      message:
        description: Description of what happens
        type: string
      module_name:
        type: string
      nesting_level:
        description: For display indentation
        type: integer
      path:
        description: Physical location
        type: string
      snippet:
        description: Code at this location
        type: string
    type: object
  internal_infra_http_handler.DataFlowResponse:
    properties:
      intermediates:
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowLocationResponse'
        type: array
      sanitizers:
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowLocationResponse'
        type: array
      sinks:
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowLocationResponse'
        type: array
      sources:
        description: Grouped view - locations by type (for quick visualization)
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowLocationResponse'
        type: array
      total_steps:
        description: Summary
        type: integer
      traces:
        description: Ordered view - full traces with all details (for detailed analysis)
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowTraceResponse'
        type: array
    type: object
  internal_infra_http_handler.DataFlowStepResponse:
    properties:
      importance:
        type: string
      index:
        type: integer
      label:
        type: string
      location:
        $ref: '#/definitions/internal_infra_http_handler.DataFlowLocationResponse'
      location_type:
        description: source, intermediate, sink, sanitizer
        type: string
      message:
        type: string
    type: object
  internal_infra_http_handler.DataFlowTraceResponse:
    properties:
      importance:
        description: essential, important, unimportant
        type: string
      index:
        description: Flow index within finding
        type: integer
      message:
        description: Flow summary
        type: string
      steps:
        description: Ordered steps from source to sink
        items:
          $ref: '#/definitions/internal_infra_http_handler.DataFlowStepResponse'
        type: array
    type: object
  internal_infra_http_handler.DedupKeyRequest:
    properties:
      branch:
        type: string
      breach_date:
        type: string
      breach_name:
        type: string
      commit_hash:
        type: string
      file_path:
        type: string
      paste_id:
        type: string
      repository:
        type: string
      source_url:
        type: string
    type: object
  internal_infra_http_handler.DiscoveredURLResult:
    properties:
      depth:
        type: integer
      extension:
        type: string
      method:
        type: string
      parent:
        type: string
      source:
        type: string
      status_code:
        type: integer
      type:
        type: string
      url:
        type: string
    type: object
  internal_infra_http_handler.EISIngestRequest:
    properties:
      report:
        $ref: '#/definitions/ctis.Report'
    type: object
  internal_infra_http_handler.EffectivePermissionsResponse:
    properties:
      group_count:
        type: integer
      permissions:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      user_id:
        type: string
    type: object
  internal_infra_http_handler.EmbeddedCategoryResponse:
    properties:
      color:
        type: string
      display_name:
        description: '''SAST'', ''DAST'', etc.'
        type: string
      icon:
        type: string
      id:
        type: string
      name:
        description: 'slug: ''sast'', ''dast'', etc.'
        type: string
    type: object
  internal_infra_http_handler.EvaluateQualityGateRequest:
    properties:
      critical:
        type: integer
      high:
        type: integer
      info:
        type: integer
      low:
        type: integer
      medium:
        type: integer
    type: object
  internal_infra_http_handler.EventTypeCategoryResponse:
    properties:
      event_types:
        items:
          $ref: '#/definitions/internal_infra_http_handler.EventTypeResponse'
        type: array
      id:
        type: string
      name:
        type: string
    type: object
  internal_infra_http_handler.EventTypeResponse:
    properties:
      category:
        type: string
      color:
        type: string
      description:
        type: string
      icon:
        type: string
      id:
        type: string
      is_default:
        type: boolean
      name:
        type: string
      severity_applicable:
        type: boolean
      slug:
        type: string
    type: object
  internal_infra_http_handler.ExchangeTokenRequest:
    properties:
      refresh_token:
        description: Optional if cookie is present
        type: string
      tenant_id:
        type: string
    required:
    - tenant_id
    type: object
  internal_infra_http_handler.ExchangeTokenResponse:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      role:
        type: string
      tenant_id:
        type: string
      tenant_slug:
        type: string
      token_type:
        type: string
    type: object
  internal_infra_http_handler.ExposedServiceResponse:
    properties:
      criticality:
        example: high
        type: string
      exposure:
        example: public
        type: string
      finding_count:
        example: 3
        type: integer
      id:
        example: 550e8400-e29b-41d4-a716-446655440000
        type: string
      last_seen:
        example: "2024-01-15T10:30:00Z"
        type: string
      name:
        example: api.example.com
        type: string
      port:
        example: 443
        type: integer
      type:
        example: service
        type: string
    type: object
  internal_infra_http_handler.ExposureResponse:
    properties:
      asset_id:
        type: string
      created_at:
        type: string
      description:
        type: string
      details:
        additionalProperties: {}
        type: object
      event_type:
        type: string
      fingerprint:
        type: string
      first_seen_at:
        type: string
      id:
        type: string
      last_seen_at:
        type: string
      resolution_notes:
        type: string
      resolved_at:
        type: string
      resolved_by:
        type: string
      severity:
        type: string
      source:
        type: string
      state:
        type: string
      title:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.FilteringResultResponse:
    properties:
      compatibility_percent:
        type: number
      scanned_assets:
        type: integer
      scanned_by_type:
        additionalProperties:
          type: integer
        type: object
      skip_reasons:
        items:
          $ref: '#/definitions/internal_infra_http_handler.SkipReasonResponse'
        type: array
      skipped_assets:
        type: integer
      skipped_by_type:
        additionalProperties:
          type: integer
        type: object
      supported_targets:
        items:
          type: string
        type: array
      tool_name:
        type: string
      total_assets:
        type: integer
      unclassified_assets:
        type: integer
      was_filtered:
        type: boolean
    type: object
  internal_infra_http_handler.FindingAssetInfo:
    properties:
      id:
        type: string
      name:
        type: string
      type:
        type: string
      web_url:
        description: Repository web URL (e.g., github.com/org/repo)
        type: string
    type: object
  internal_infra_http_handler.FindingAssignedUser:
    properties:
      email:
        type: string
      id:
        type: string
      name:
        type: string
    type: object
  internal_infra_http_handler.FindingComponentInfo:
    properties:
      depth:
        description: Dependency depth (1=direct, 2+=transitive)
        type: integer
      ecosystem:
        description: Package ecosystem (e.g., "npm", "pypi")
        type: string
      fixed_in:
        description: Version that fixes the vulnerability
        type: string
      id:
        description: Global component ID
        type: string
      is_direct:
        description: true if direct dependency
        type: boolean
      license:
        description: License identifier
        type: string
      name:
        description: Package name (e.g., "lodash")
        type: string
      purl:
        description: Package URL
        type: string
      version:
        description: Package version (e.g., "4.17.20")
        type: string
    type: object
  internal_infra_http_handler.FindingCountsResponse:
    properties:
      critical:
        type: integer
      high:
        type: integer
      info:
        type: integer
      low:
        type: integer
      medium:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.FindingRemediationResponse:
    properties:
      auto_fixable:
        description: Whether the fix can be auto-applied
        type: boolean
      effort:
        description: trivial, low, medium, high
        type: string
      fix_available:
        description: Whether a fix is available
        type: boolean
      fix_code:
        description: Actual code to apply
        type: string
      fix_regex:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FixRegexResponse'
        description: Regex-based fix pattern
      recommendation:
        description: Human-readable guidance
        type: string
      references:
        description: Reference URLs
        items:
          type: string
        type: array
      steps:
        description: Step-by-step instructions
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.FindingResponse:
    properties:
      asset:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FindingAssetInfo'
        description: Full asset info
      asset_id:
        type: string
      assigned_at:
        type: string
      assigned_by:
        type: string
      assigned_to:
        type: string
      assigned_to_user:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FindingAssignedUser'
        description: Full user info
      attachments:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.Attachment'
        type: array
      attack_prerequisites:
        type: string
      baseline_state:
        type: string
      branch_id:
        type: string
      comments_count:
        type: integer
      compliance_control_id:
        type: string
      compliance_framework:
        description: Compliance-specific fields
        type: string
      compliance_impact:
        items:
          type: string
        type: array
      compliance_result:
        type: string
      component:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FindingComponentInfo'
        description: Embedded component info for SCA findings
      component_id:
        type: string
      confidence:
        description: SARIF 2.1.0 Fields
        type: integer
      context_snippet:
        type: string
      context_start_line:
        type: integer
      correlation_id:
        type: string
      created_at:
        type: string
      cve_id:
        type: string
      cvss_score:
        type: number
      cvss_vector:
        type: string
      cwe_ids:
        items:
          type: string
        type: array
      data_exposure_risk:
        type: string
      data_flow:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.DataFlowResponse'
        description: Full data when fetching single finding
      description:
        type: string
      duplicate_count:
        type: integer
      duplicate_of:
        type: string
      end_column:
        type: integer
      end_line:
        type: integer
      estimated_fix_time:
        type: integer
      exposure_vector:
        description: CTEM Fields
        type: string
      file_path:
        type: string
      finding_type:
        description: Finding Type discriminator
        type: string
      fingerprint:
        type: string
      first_detected_at:
        type: string
      first_detected_branch:
        type: string
      first_detected_commit:
        type: string
      fix_code:
        description: Auto-fix code snippet
        type: string
      fix_complexity:
        type: string
      fix_regex:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FixRegexResponse'
        description: Regex-based fix pattern
      has_data_flow:
        description: Data Flow / Taint Tracking (Attack Path)
        type: boolean
      hosted_viewer_uri:
        type: string
      id:
        type: string
      impact:
        type: string
      is_internet_accessible:
        type: boolean
      is_network_accessible:
        type: boolean
      is_triaged:
        description: true if status != "new"
        type: boolean
      kind:
        type: string
      last_seen_at:
        type: string
      last_seen_branch:
        type: string
      last_seen_commit:
        type: string
      likelihood:
        type: string
      location:
        type: string
      message:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      misconfig_actual:
        type: string
      misconfig_expected:
        type: string
      misconfig_policy_id:
        description: Misconfiguration-specific fields
        type: string
      misconfig_resource_type:
        type: string
      occurrence_count:
        type: integer
      owasp_ids:
        items:
          type: string
        type: array
      partial_fingerprints:
        additionalProperties:
          type: string
        type: object
      rank:
        type: number
      recommendation:
        type: string
      related_locations:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.FindingLocation'
        type: array
      remediation:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.FindingRemediationResponse'
        description: Full remediation JSONB
      remediation_type:
        type: string
      remedy_available:
        type: boolean
      reputational_impact:
        type: boolean
      resolution:
        type: string
      resolved_at:
        type: string
      resolved_by:
        description: User ID who resolved
        type: string
      rule_id:
        type: string
      rule_name:
        type: string
      scan_id:
        type: string
      secret_revoked:
        type: boolean
      secret_service:
        type: string
      secret_type:
        description: Secret-specific fields
        type: string
      secret_valid:
        type: boolean
      severity:
        type: string
      sla_deadline:
        type: string
      sla_status:
        type: string
      snippet:
        type: string
      source:
        type: string
      stacks:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_domain_vulnerability.StackTrace'
        type: array
      start_column:
        type: integer
      start_line:
        type: integer
      status:
        type: string
      subcategory:
        items:
          type: string
        type: array
      tags:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      title:
        type: string
      tool_name:
        type: string
      tool_version:
        type: string
      updated_at:
        type: string
      verified_at:
        type: string
      verified_by:
        type: string
      vulnerability_class:
        items:
          type: string
        type: array
      vulnerability_id:
        type: string
      web3_chain:
        description: Web3-specific fields
        type: string
      web3_contract_address:
        type: string
      web3_swc_id:
        type: string
      work_item_uris:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.FindingSourceCategoryResponse:
    properties:
      code:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_order:
        type: integer
      icon:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      name:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.FindingSourceResponse:
    properties:
      category:
        $ref: '#/definitions/internal_infra_http_handler.FindingSourceCategoryResponse'
      category_id:
        type: string
      code:
        type: string
      color:
        type: string
      created_at:
        type: string
      description:
        type: string
      display_order:
        type: integer
      icon:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      is_system:
        type: boolean
      name:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.FindingStats:
    properties:
      average_cvss:
        type: number
      by_severity:
        additionalProperties:
          type: integer
        type: object
      by_status:
        additionalProperties:
          type: integer
        type: object
      overdue:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.FindingStatsResponse:
    properties:
      by_severity:
        additionalProperties:
          format: int64
          type: integer
        type: object
      by_source:
        additionalProperties:
          format: int64
          type: integer
        type: object
      by_status:
        additionalProperties:
          format: int64
          type: integer
        type: object
      open_count:
        type: integer
      resolved_count:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.FixRegexResponse:
    properties:
      count:
        description: Number of replacements (0 = all)
        type: integer
      regex:
        description: Regex pattern to match
        type: string
      replacement:
        description: Replacement string
        type: string
    type: object
  internal_infra_http_handler.ForgotPasswordRequest:
    properties:
      email:
        type: string
    required:
    - email
    type: object
  internal_infra_http_handler.GCPServiceAccountDataRequest:
    properties:
      json_key:
        type: string
    required:
    - json_key
    type: object
  internal_infra_http_handler.GitHubAppDataRequest:
    properties:
      app_id:
        type: string
      installation_id:
        type: string
      private_key:
        type: string
    required:
    - app_id
    - installation_id
    - private_key
    type: object
  internal_infra_http_handler.GitLabTokenDataRequest:
    properties:
      token:
        type: string
    required:
    - token
    type: object
  internal_infra_http_handler.GroupAssetResponse:
    properties:
      finding_count:
        type: integer
      id:
        type: string
      last_seen:
        type: string
      name:
        type: string
      risk_score:
        type: integer
      status:
        type: string
      type:
        type: string
    type: object
  internal_infra_http_handler.GroupFindingResponse:
    properties:
      asset_id:
        type: string
      asset_name:
        type: string
      asset_type:
        type: string
      discovered_at:
        type: string
      id:
        type: string
      severity:
        type: string
      status:
        type: string
      title:
        type: string
    type: object
  internal_infra_http_handler.GroupListResponse:
    properties:
      groups:
        items:
          $ref: '#/definitions/internal_infra_http_handler.GroupResponse'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.GroupMemberResponse:
    properties:
      added_by:
        type: string
      joined_at:
        type: string
      role:
        type: string
      user_id:
        type: string
    type: object
  internal_infra_http_handler.GroupMemberWithUserResponse:
    properties:
      added_by:
        type: string
      avatar_url:
        type: string
      email:
        type: string
      joined_at:
        type: string
      name:
        type: string
      role:
        type: string
      user_id:
        type: string
    type: object
  internal_infra_http_handler.GroupResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      group_type:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      member_count:
        type: integer
      name:
        type: string
      notification_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.NotificationConfig'
      settings:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.GroupSettings'
      slug:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.GroupWithRoleResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      group_type:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      joined_at:
        type: string
      member_count:
        type: integer
      name:
        type: string
      notification_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.NotificationConfig'
      role:
        type: string
      settings:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.GroupSettings'
      slug:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.HealthResponse:
    properties:
      status:
        type: string
      timestamp:
        type: string
    type: object
  internal_infra_http_handler.HeartbeatRequest:
    properties:
      active_jobs:
        type: integer
      collectors:
        items:
          type: string
        type: array
      cpu_percent:
        type: number
      errors:
        type: integer
      hostname:
        type: string
      memory_percent:
        type: number
      message:
        type: string
      name:
        type: string
      region:
        type: string
      scanners:
        items:
          type: string
        type: array
      status:
        type: string
      total_scans:
        type: integer
      uptime_seconds:
        type: integer
      version:
        type: string
    type: object
  internal_infra_http_handler.ImportMetadataRequest:
    properties:
      batch_id:
        type: string
      description:
        type: string
      source_tool:
        type: string
    type: object
  internal_infra_http_handler.ImportOptionsRequest:
    properties:
      auto_classify_severity:
        type: boolean
      dedup_strategy:
        type: string
      notify_new_critical:
        type: boolean
      notify_reactivated:
        type: boolean
      reactivate_resolved:
        type: boolean
    type: object
  internal_infra_http_handler.IngestResponse:
    properties:
      assets_created:
        type: integer
      assets_updated:
        type: integer
      errors:
        items:
          type: string
        type: array
      findings_created:
        type: integer
      findings_skipped:
        type: integer
      findings_updated:
        type: integer
      scan_id:
        type: string
    type: object
  internal_infra_http_handler.IntegrationResponse:
    description: Integration details including provider info and status
    properties:
      auth_type:
        enum:
        - token
        - oauth
        - api_key
        - basic
        - app
        example: token
        type: string
      base_url:
        example: https://github.com
        type: string
      category:
        enum:
        - scm
        - security
        - cloud
        - ticketing
        - notification
        example: scm
        type: string
      config:
        additionalProperties: {}
        type: object
      created_at:
        example: "2024-01-01T00:00:00Z"
        type: string
      created_by:
        example: user-123
        type: string
      description:
        example: Main GitHub integration
        type: string
      id:
        example: 550e8400-e29b-41d4-a716-446655440000
        type: string
      last_sync_at:
        example: "2024-01-15T10:30:00Z"
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        example: GitHub Production
        type: string
      next_sync_at:
        example: "2024-01-15T11:30:00Z"
        type: string
      provider:
        example: github
        type: string
      scm_extension:
        $ref: '#/definitions/internal_infra_http_handler.SCMExtensionResponse'
      stats:
        $ref: '#/definitions/internal_infra_http_handler.IntegrationStatsResponse'
      status:
        enum:
        - pending
        - connected
        - disconnected
        - error
        example: connected
        type: string
      status_message:
        example: ""
        type: string
      sync_error:
        example: ""
        type: string
      sync_interval_minutes:
        example: 60
        type: integer
      tenant_id:
        example: 550e8400-e29b-41d4-a716-446655440001
        type: string
      updated_at:
        example: "2024-01-15T10:30:00Z"
        type: string
    type: object
  internal_infra_http_handler.IntegrationStatsResponse:
    properties:
      total_assets:
        type: integer
      total_findings:
        type: integer
      total_repositories:
        type: integer
    type: object
  internal_infra_http_handler.IntegrationWithNotificationResponse:
    properties:
      auth_type:
        enum:
        - token
        - oauth
        - api_key
        - basic
        - app
        example: token
        type: string
      base_url:
        example: https://github.com
        type: string
      category:
        enum:
        - scm
        - security
        - cloud
        - ticketing
        - notification
        example: scm
        type: string
      config:
        additionalProperties: {}
        type: object
      created_at:
        example: "2024-01-01T00:00:00Z"
        type: string
      created_by:
        example: user-123
        type: string
      description:
        example: Main GitHub integration
        type: string
      id:
        example: 550e8400-e29b-41d4-a716-446655440000
        type: string
      last_sync_at:
        example: "2024-01-15T10:30:00Z"
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        example: GitHub Production
        type: string
      next_sync_at:
        example: "2024-01-15T11:30:00Z"
        type: string
      notification_extension:
        $ref: '#/definitions/internal_infra_http_handler.NotificationExtensionResponse'
      provider:
        example: github
        type: string
      scm_extension:
        $ref: '#/definitions/internal_infra_http_handler.SCMExtensionResponse'
      stats:
        $ref: '#/definitions/internal_infra_http_handler.IntegrationStatsResponse'
      status:
        enum:
        - pending
        - connected
        - disconnected
        - error
        example: connected
        type: string
      status_message:
        example: ""
        type: string
      sync_error:
        example: ""
        type: string
      sync_interval_minutes:
        example: 60
        type: integer
      tenant_id:
        example: 550e8400-e29b-41d4-a716-446655440001
        type: string
      updated_at:
        example: "2024-01-15T10:30:00Z"
        type: string
    type: object
  internal_infra_http_handler.KeycloakInfoResponse:
    properties:
      auth_url:
        type: string
      issuer:
        type: string
      jwks_url:
        type: string
      logout_url:
        type: string
      realm:
        type: string
      token_url:
        type: string
      userinfo_url:
        type: string
    type: object
  internal_infra_http_handler.LicensingModuleResponse:
    properties:
      category:
        type: string
      description:
        type: string
      display_order:
        type: integer
      event_types:
        items:
          type: string
        type: array
      icon:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      name:
        type: string
      parent_module_id:
        description: Parent module ID for sub-modules
        type: string
      release_status:
        description: released, coming_soon, beta, deprecated
        type: string
      slug:
        type: string
    type: object
  internal_infra_http_handler.ListCredentialsResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CredentialResponse'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_AgentResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_AssetGroupResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_BootstrapTokenResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.BootstrapTokenResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_CommandResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ExposureResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_GroupAssetResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.GroupAssetResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_GroupFindingResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.GroupFindingResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_IntegrationResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_PlatformAgentResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_PlatformJobResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanDetailResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanProfileResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanScheduleResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScanScheduleResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanSessionResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScanSessionResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScannerTemplateResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScannerTemplateResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScopeExclusionResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScopeExclusionResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScopeTargetResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_TenantToolConfigResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.TenantToolConfigResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolWithConfigResponse:
    properties:
      data:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ToolWithConfigResponse'
        type: array
      links:
        $ref: '#/definitions/internal_infra_http_handler.PaginationLinks'
      page:
        type: integer
      per_page:
        type: integer
      total:
        type: integer
      total_pages:
        type: integer
    type: object
  internal_infra_http_handler.ListSCMRepositoriesResponse:
    description: Response for listing SCM repositories
    properties:
      has_more:
        type: boolean
      next_page:
        type: integer
      repositories:
        items:
          $ref: '#/definitions/internal_infra_http_handler.SCMRepositoryResponse'
        type: array
      total:
        type: integer
    type: object
  internal_infra_http_handler.ListSourcesResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        type: array
      page:
        type: integer
      page_size:
        type: integer
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.LiveHostResult:
    properties:
      cdn:
        type: string
      content_length:
        type: integer
      content_type:
        type: string
      host:
        type: string
      ip:
        type: string
      port:
        type: integer
      redirect:
        type: string
      response_time_ms:
        type: integer
      scheme:
        type: string
      status_code:
        type: integer
      technologies:
        items:
          type: string
        type: array
      title:
        type: string
      tls_version:
        type: string
      url:
        type: string
      web_server:
        type: string
    type: object
  internal_infra_http_handler.LoginRequest:
    properties:
      email:
        type: string
      password:
        type: string
    required:
    - email
    - password
    type: object
  internal_infra_http_handler.LoginResponse:
    properties:
      expires_in:
        type: integer
      refresh_token:
        description: Also set in httpOnly cookie
        type: string
      tenants:
        items:
          $ref: '#/definitions/internal_infra_http_handler.TenantInfo'
        type: array
      token_type:
        type: string
      user:
        $ref: '#/definitions/internal_infra_http_handler.UserInfo'
    type: object
  internal_infra_http_handler.NotificationExtensionResponse:
    properties:
      channel_id:
        description: 'Deprecated: use metadata.chat_id'
        example: C123456
        type: string
      channel_name:
        description: 'Deprecated: use metadata.channel_name'
        example: '#security-alerts'
        type: string
      enabled_event_types:
        example:
        - '["security_alert"'
        - '"new_finding"'
        - '"new_exposure"]'
        items:
          type: string
        type: array
      enabled_severities:
        example:
        - '["critical"'
        - '"high"]'
        items:
          type: string
        type: array
      include_details:
        example: true
        type: boolean
      message_template:
        type: string
      min_interval_minutes:
        example: 5
        type: integer
    type: object
  internal_infra_http_handler.OpenPortResult:
    properties:
      banner:
        type: string
      host:
        type: string
      ip:
        type: string
      port:
        type: integer
      protocol:
        type: string
      service:
        type: string
      version:
        type: string
    type: object
  internal_infra_http_handler.OutboxEntryResponse:
    properties:
      aggregate_id:
        type: string
      aggregate_type:
        type: string
      body:
        type: string
      created_at:
        type: string
      event_type:
        type: string
      id:
        type: string
      last_error:
        type: string
      locked_at:
        type: string
      max_retries:
        type: integer
      metadata:
        additionalProperties: {}
        type: object
      processed_at:
        type: string
      retry_count:
        type: integer
      scheduled_at:
        type: string
      severity:
        type: string
      status:
        type: string
      title:
        type: string
      updated_at:
        type: string
      url:
        type: string
    type: object
  internal_infra_http_handler.OutboxStatsResponse:
    properties:
      completed:
        type: integer
      dead:
        type: integer
      failed:
        type: integer
      pending:
        type: integer
      processing:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.PaginationLinks:
    properties:
      first:
        type: string
      last:
        type: string
      next:
        type: string
      prev:
        type: string
      self:
        type: string
    type: object
  internal_infra_http_handler.PermissionItemResponse:
    properties:
      modification_type:
        type: string
      permission_id:
        type: string
    type: object
  internal_infra_http_handler.PermissionSetListResponse:
    properties:
      limit:
        type: integer
      offset:
        type: integer
      permission_sets:
        items:
          $ref: '#/definitions/internal_infra_http_handler.PermissionSetResponse'
        type: array
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.PermissionSetResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      is_system:
        type: boolean
      name:
        type: string
      parent_set_id:
        type: string
      set_type:
        type: string
      slug:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.PermissionSetWithItemsResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      is_active:
        type: boolean
      is_system:
        type: boolean
      items:
        items:
          $ref: '#/definitions/internal_infra_http_handler.PermissionItemResponse'
        type: array
      name:
        type: string
      parent_set_id:
        type: string
      permissions:
        description: Resolved permissions
        items:
          type: string
        type: array
      set_type:
        type: string
      slug:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.PermissionsResponse:
    properties:
      permissions:
        items:
          type: string
        type: array
      version:
        type: integer
    type: object
  internal_infra_http_handler.PlanResponse:
    properties:
      badge:
        type: string
      created_at:
        type: string
      currency:
        type: string
      description:
        type: string
      display_order:
        type: integer
      features:
        items:
          type: string
        type: array
      id:
        type: string
      is_popular:
        type: boolean
      is_public:
        type: boolean
      max_assets:
        type: integer
      max_users:
        type: integer
      name:
        type: string
      price_monthly:
        type: number
      price_yearly:
        type: number
      slug:
        type: string
      support_level:
        type: string
      trial_days:
        type: integer
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.PlatformAgentResponse:
    properties:
      available_slots:
        type: integer
      capabilities:
        items:
          type: string
        type: array
      cpu_percent:
        type: number
      created_at:
        type: string
      current_jobs:
        type: integer
      description:
        type: string
      disk_read_mbps:
        type: number
      disk_write_mbps:
        type: number
      error_count:
        type: integer
      health:
        description: online, offline, unknown
        type: string
      hostname:
        type: string
      id:
        type: string
      ip_address:
        type: string
      labels:
        additionalProperties: {}
        type: object
      last_seen_at:
        description: Statistics
        type: string
      load_factor:
        type: number
      load_score:
        description: Weighted score for load balancing (lower is better)
        type: number
      max_concurrent_jobs:
        description: Load balancing
        type: integer
      memory_percent:
        type: number
      name:
        type: string
      network_rx_mbps:
        type: number
      network_tx_mbps:
        type: number
      region:
        type: string
      status:
        description: active, disabled, revoked
        type: string
      tier:
        description: Tier (v3.3)
        type: string
      tier_priority:
        description: 0, 50, 100
        type: integer
      tools:
        items:
          type: string
        type: array
      total_findings:
        type: integer
      total_scans:
        type: integer
      type:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  internal_infra_http_handler.PlatformAgentStatsResponse:
    properties:
      available_capabilities:
        items:
          type: string
        type: array
      available_regions:
        items:
          type: string
        type: array
      available_slots:
        type: integer
      available_tools:
        items:
          type: string
        type: array
      current_load:
        type: integer
      load_percent:
        type: number
      offline_agents:
        type: integer
      online_agents:
        type: integer
      tier_stats:
        additionalProperties:
          $ref: '#/definitions/internal_infra_http_handler.TierStatsResponse'
        description: v3.3
        type: object
      total_agents:
        type: integer
      total_capacity:
        type: integer
    type: object
  internal_infra_http_handler.PlatformJobAgentResponse:
    properties:
      id:
        type: string
      name:
        type: string
      region:
        type: string
    type: object
  internal_infra_http_handler.PlatformJobQueueResponse:
    properties:
      estimated_wait_seconds:
        type: integer
      position:
        type: integer
    type: object
  internal_infra_http_handler.PlatformJobResponse:
    properties:
      acknowledged_at:
        type: string
      agent_id:
        type: string
      agent_name:
        type: string
      completed_at:
        type: string
      created_at:
        type: string
      error_message:
        type: string
      id:
        type: string
      payload:
        items:
          type: integer
        type: array
      priority:
        type: string
      queue_position:
        type: integer
      queue_priority:
        type: integer
      queued_at:
        type: string
      result:
        items:
          type: integer
        type: array
      started_at:
        type: string
      status:
        type: string
      tenant_id:
        type: string
      type:
        type: string
    type: object
  internal_infra_http_handler.PortCountResponse:
    properties:
      count:
        type: integer
      port:
        type: integer
    type: object
  internal_infra_http_handler.PreferencesDTO:
    properties:
      language:
        type: string
      notifications:
        type: boolean
      theme:
        type: string
    type: object
  internal_infra_http_handler.ProvidersResponse:
    properties:
      providers:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.ProviderInfo'
        type: array
    type: object
  internal_infra_http_handler.QualityGateBreachResponse:
    properties:
      actual:
        type: integer
      limit:
        type: integer
      metric:
        type: string
    type: object
  internal_infra_http_handler.QualityGateRequest:
    properties:
      baseline_branch:
        type: string
      enabled:
        type: boolean
      fail_on_critical:
        type: boolean
      fail_on_high:
        type: boolean
      max_critical:
        type: integer
      max_high:
        type: integer
      max_medium:
        type: integer
      max_total:
        type: integer
      new_findings_only:
        type: boolean
    type: object
  internal_infra_http_handler.QualityGateResponse:
    properties:
      baseline_branch:
        type: string
      enabled:
        type: boolean
      fail_on_critical:
        type: boolean
      fail_on_high:
        type: boolean
      max_critical:
        type: integer
      max_high:
        type: integer
      max_medium:
        type: integer
      max_total:
        type: integer
      new_findings_only:
        type: boolean
    type: object
  internal_infra_http_handler.QualityGateResultResponse:
    properties:
      breaches:
        items:
          $ref: '#/definitions/internal_infra_http_handler.QualityGateBreachResponse'
        type: array
      counts:
        $ref: '#/definitions/internal_infra_http_handler.FindingCountsResponse'
      passed:
        type: boolean
      reason:
        type: string
    type: object
  internal_infra_http_handler.QueueStatsResponse:
    properties:
      total_completed:
        type: integer
      total_failed:
        type: integer
      total_processing:
        type: integer
      total_queued:
        type: integer
    type: object
  internal_infra_http_handler.ReadyResponse:
    properties:
      checks:
        additionalProperties:
          $ref: '#/definitions/internal_infra_http_handler.CheckResult'
        type: object
      status:
        type: string
      timestamp:
        type: string
    type: object
  internal_infra_http_handler.ReconIngestRequest:
    properties:
      dns_records:
        items:
          $ref: '#/definitions/internal_infra_http_handler.DNSRecordResult'
        type: array
      duration_ms:
        type: integer
      finished_at:
        type: integer
      live_hosts:
        items:
          $ref: '#/definitions/internal_infra_http_handler.LiveHostResult'
        type: array
      open_ports:
        items:
          $ref: '#/definitions/internal_infra_http_handler.OpenPortResult'
        type: array
      recon_type:
        description: subdomain, dns, port, http_probe, url_crawl
        type: string
      scanner_name:
        description: Scanner info
        type: string
      scanner_version:
        type: string
      started_at:
        description: Timing
        type: integer
      subdomains:
        description: Results (populated based on recon_type)
        items:
          $ref: '#/definitions/internal_infra_http_handler.SubdomainResult'
        type: array
      target:
        description: Target
        type: string
      urls:
        items:
          $ref: '#/definitions/internal_infra_http_handler.DiscoveredURLResult'
        type: array
    type: object
  internal_infra_http_handler.ReferenceResponse:
    properties:
      type:
        type: string
      url:
        type: string
    type: object
  internal_infra_http_handler.RefreshTokenRequest:
    properties:
      refresh_token:
        description: Optional if cookie is present
        type: string
      tenant_id:
        type: string
    required:
    - tenant_id
    type: object
  internal_infra_http_handler.RefreshTokenResponse:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        description: Also set in httpOnly cookie
        type: string
      role:
        type: string
      tenant_id:
        type: string
      tenant_slug:
        type: string
      token_type:
        type: string
    type: object
  internal_infra_http_handler.RegisterAgentRequest:
    properties:
      bootstrap_token:
        type: string
      capabilities:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
      hostname:
        maxLength: 255
        type: string
      labels:
        additionalProperties:
          type: string
        type: object
      max_concurrent:
        maximum: 50
        minimum: 1
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
      region:
        maxLength: 50
        type: string
      tools:
        items:
          type: string
        maxItems: 20
        minItems: 1
        type: array
      version:
        maxLength: 50
        type: string
    required:
    - bootstrap_token
    - capabilities
    - max_concurrent
    - name
    - region
    - tools
    type: object
  internal_infra_http_handler.RegisterAgentResponse:
    properties:
      agent:
        $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
      api_key:
        type: string
    type: object
  internal_infra_http_handler.RegisterRequest:
    properties:
      email:
        maxLength: 255
        type: string
      name:
        maxLength: 255
        type: string
      password:
        maxLength: 128
        minLength: 8
        type: string
    required:
    - email
    - name
    - password
    type: object
  internal_infra_http_handler.RegisterResponse:
    properties:
      email:
        type: string
      id:
        type: string
      message:
        type: string
      name:
        type: string
      requires_verification:
        type: boolean
    type: object
  internal_infra_http_handler.RegisterScanRequest:
    properties:
      asset_type:
        type: string
      asset_value:
        type: string
      branch:
        type: string
      commit_sha:
        type: string
      scanner_name:
        type: string
      scanner_type:
        type: string
      scanner_version:
        type: string
    required:
    - asset_type
    - asset_value
    - scanner_name
    type: object
  internal_infra_http_handler.RegisterScanResponse:
    properties:
      base_commit_sha:
        type: string
      scan_id:
        type: string
      scan_url:
        type: string
    type: object
  internal_infra_http_handler.RemoveAssetsRequest:
    properties:
      asset_ids:
        items:
          type: string
        minItems: 1
        type: array
    required:
    - asset_ids
    type: object
  internal_infra_http_handler.RepositoryExtensionResponse:
    properties:
      asset_id:
        type: string
      branch_count:
        type: integer
      clone_url:
        type: string
      component_count:
        type: integer
      contributors_count:
        type: integer
      default_branch:
        type: string
      finding_count:
        type: integer
      forks:
        type: integer
      full_name:
        type: string
      language:
        type: string
      languages:
        additionalProperties:
          format: int64
          type: integer
        type: object
      last_scanned_at:
        type: string
      open_issues:
        type: integer
      protected_branch_count:
        type: integer
      repo_created_at:
        type: string
      repo_id:
        type: string
      repo_pushed_at:
        type: string
      repo_updated_at:
        type: string
      scan_enabled:
        type: boolean
      scan_schedule:
        type: string
      scm_organization:
        type: string
      size_kb:
        type: integer
      ssh_url:
        type: string
      stars:
        type: integer
      topics:
        items:
          type: string
        type: array
      visibility:
        type: string
      vulnerable_component_count:
        type: integer
      watchers:
        type: integer
      web_url:
        type: string
    type: object
  internal_infra_http_handler.RepositoryStats:
    properties:
      total:
        type: integer
      with_findings:
        type: integer
    type: object
  internal_infra_http_handler.ResetPasswordRequest:
    properties:
      new_password:
        maxLength: 128
        minLength: 8
        type: string
      token:
        type: string
    required:
    - new_password
    - token
    type: object
  internal_infra_http_handler.RevokeBootstrapTokenRequest:
    properties:
      reason:
        maxLength: 500
        type: string
    type: object
  internal_infra_http_handler.RunResponse:
    properties:
      asset_id:
        type: string
      completed_at:
        type: string
      completed_steps:
        type: integer
      created_at:
        type: string
      error_message:
        type: string
      failed_steps:
        type: integer
      filtering_result:
        $ref: '#/definitions/internal_infra_http_handler.FilteringResultResponse'
      id:
        type: string
      pipeline_id:
        type: string
      quality_gate_result:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_scanprofile.QualityGateResult'
      scan_id:
        type: string
      scan_profile_id:
        type: string
      skipped_steps:
        type: integer
      started_at:
        type: string
      status:
        type: string
      step_runs:
        items:
          $ref: '#/definitions/internal_infra_http_handler.StepRunResponse'
        type: array
      tenant_id:
        type: string
      total_findings:
        type: integer
      total_steps:
        type: integer
      trigger_type:
        type: string
      triggered_by:
        type: string
    type: object
  internal_infra_http_handler.SCMExtensionResponse:
    properties:
      auto_import_repos:
        example: false
        type: boolean
      default_branch_pattern:
        example: main,master
        type: string
      exclude_patterns:
        items:
          type: string
        type: array
      import_archived_repos:
        example: false
        type: boolean
      import_private_repos:
        example: true
        type: boolean
      include_patterns:
        items:
          type: string
        type: array
      last_repo_sync_at:
        type: string
      repository_count:
        example: 25
        type: integer
      scm_organization:
        example: my-organization
        type: string
      webhook_id:
        type: string
      webhook_url:
        type: string
    type: object
  internal_infra_http_handler.SCMRepositoryResponse:
    description: Repository from SCM provider
    properties:
      clone_url:
        type: string
      created_at:
        type: string
      default_branch:
        type: string
      description:
        type: string
      forks:
        type: integer
      full_name:
        type: string
      html_url:
        type: string
      id:
        type: string
      is_archived:
        type: boolean
      is_fork:
        type: boolean
      is_private:
        type: boolean
      language:
        type: string
      languages:
        additionalProperties:
          type: integer
        type: object
      name:
        type: string
      pushed_at:
        type: string
      size:
        type: integer
      ssh_url:
        type: string
      stars:
        type: integer
      topics:
        items:
          type: string
        type: array
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.SLAPolicyResponse:
    properties:
      asset_id:
        type: string
      created_at:
        type: string
      critical_days:
        type: integer
      description:
        type: string
      escalation_config:
        additionalProperties: {}
        type: object
      escalation_enabled:
        type: boolean
      high_days:
        type: integer
      id:
        type: string
      info_days:
        type: integer
      is_active:
        type: boolean
      is_default:
        type: boolean
      low_days:
        type: integer
      medium_days:
        type: integer
      name:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
      warning_threshold_pct:
        type: integer
    type: object
  internal_infra_http_handler.SSHKeyDataRequest:
    properties:
      passphrase:
        type: string
      private_key:
        type: string
    required:
    - private_key
    type: object
  internal_infra_http_handler.ScanDetailResponse:
    properties:
      asset_group_id:
        description: Primary asset group (legacy)
        type: string
      asset_group_ids:
        description: Multiple asset groups
        items:
          type: string
        type: array
      created_at:
        type: string
      created_by:
        type: string
      created_by_name:
        type: string
      description:
        type: string
      failed_runs:
        type: integer
      id:
        type: string
      last_run_at:
        type: string
      last_run_id:
        type: string
      last_run_status:
        type: string
      name:
        type: string
      next_run_at:
        type: string
      pipeline_id:
        type: string
      run_on_tenant_runner:
        type: boolean
      scan_type:
        type: string
      scanner_config:
        additionalProperties: {}
        type: object
      scanner_name:
        type: string
      schedule_cron:
        type: string
      schedule_day:
        type: integer
      schedule_time:
        type: string
      schedule_timezone:
        type: string
      schedule_type:
        type: string
      status:
        type: string
      successful_runs:
        type: integer
      tags:
        items:
          type: string
        type: array
      targets:
        description: Direct targets
        items:
          type: string
        type: array
      targets_per_job:
        type: integer
      tenant_id:
        type: string
      total_runs:
        type: integer
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ScanProfileResponse:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      id:
        type: string
      intensity:
        type: string
      is_default:
        type: boolean
      is_system:
        type: boolean
      max_concurrent_scans:
        type: integer
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      quality_gate:
        $ref: '#/definitions/internal_infra_http_handler.QualityGateResponse'
      tags:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      timeout_seconds:
        type: integer
      tools_config:
        additionalProperties:
          $ref: '#/definitions/internal_infra_http_handler.ToolConfigResponse'
        type: object
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ScanResponse:
    properties:
      message:
        type: string
      queued_at:
        type: string
      scan_id:
        type: string
      success:
        type: boolean
    type: object
  internal_infra_http_handler.ScanScheduleResponse:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      cron_expression:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      id:
        type: string
      interval_hours:
        type: integer
      last_run_at:
        type: string
      last_run_status:
        type: string
      name:
        type: string
      next_run_at:
        type: string
      notification_channels:
        items:
          type: string
        type: array
      notify_on_completion:
        type: boolean
      notify_on_findings:
        type: boolean
      scan_type:
        type: string
      scanner_configs:
        additionalProperties: true
        type: object
      schedule_type:
        type: string
      target_ids:
        items:
          type: string
        type: array
      target_scope:
        type: string
      target_tags:
        items:
          type: string
        type: array
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ScanSessionResponse:
    properties:
      agent_id:
        type: string
      asset_id:
        type: string
      asset_type:
        type: string
      asset_value:
        type: string
      base_commit_sha:
        type: string
      branch:
        type: string
      commit_sha:
        type: string
      completed_at:
        type: string
      created_at:
        type: string
      duration_ms:
        type: integer
      error_message:
        type: string
      findings_by_severity:
        additionalProperties:
          type: integer
        type: object
      findings_fixed:
        type: integer
      findings_new:
        type: integer
      findings_total:
        type: integer
      id:
        type: string
      scanner_name:
        type: string
      scanner_type:
        type: string
      scanner_version:
        type: string
      started_at:
        type: string
      status:
        type: string
      tenant_id:
        type: string
    type: object
  internal_infra_http_handler.ScanStatsResponse:
    properties:
      active:
        type: integer
      by_scan_type:
        additionalProperties:
          format: int64
          type: integer
        type: object
      by_schedule_type:
        additionalProperties:
          format: int64
          type: integer
        type: object
      disabled:
        type: integer
      paused:
        type: integer
      total:
        type: integer
    type: object
  internal_infra_http_handler.ScannerTemplateResponse:
    properties:
      content_hash:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      id:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      rule_count:
        type: integer
      status:
        type: string
      tags:
        items:
          type: string
        type: array
      template_type:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
      validation_error:
        type: string
      version:
        type: string
    type: object
  internal_infra_http_handler.ScopeExclusionResponse:
    properties:
      approved_at:
        type: string
      approved_by:
        type: string
      created_at:
        type: string
      created_by:
        type: string
      exclusion_type:
        type: string
      expires_at:
        type: string
      id:
        type: string
      pattern:
        type: string
      reason:
        type: string
      status:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ScopeTargetResponse:
    properties:
      created_at:
        type: string
      created_by:
        type: string
      description:
        type: string
      id:
        type: string
      pattern:
        type: string
      priority:
        type: integer
      status:
        type: string
      tags:
        items:
          type: string
        type: array
      target_type:
        type: string
      tenant_id:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.SendNotificationRequest:
    properties:
      body:
        maxLength: 4000
        type: string
      fields:
        additionalProperties:
          type: string
        type: object
      severity:
        enum:
        - critical
        - high
        - medium
        - low
        type: string
      title:
        maxLength: 255
        minLength: 1
        type: string
      url:
        type: string
    required:
    - body
    - severity
    - title
    type: object
  internal_infra_http_handler.SessionsResponse:
    properties:
      sessions:
        items:
          $ref: '#/definitions/github_com_openctemio_api_internal_app.SessionInfo'
        type: array
    type: object
  internal_infra_http_handler.SetTagsRequest:
    properties:
      tags:
        items:
          type: string
        maxItems: 50
        type: array
    type: object
  internal_infra_http_handler.SkipReasonResponse:
    properties:
      asset_type:
        type: string
      count:
        type: integer
      reason:
        type: string
    type: object
  internal_infra_http_handler.StateChangeResponse:
    properties:
      asset_id:
        type: string
      change_type:
        type: string
      changed_at:
        type: string
      changed_by:
        type: string
      created_at:
        type: string
      field:
        type: string
      id:
        type: string
      metadata:
        type: string
      new_value:
        type: string
      old_value:
        type: string
      reason:
        type: string
      source:
        type: string
      tenant_id:
        type: string
    type: object
  internal_infra_http_handler.StateHistoryStatsResponse:
    properties:
      source_counts:
        additionalProperties:
          type: integer
        type: object
      type_counts:
        additionalProperties:
          type: integer
        type: object
    type: object
  internal_infra_http_handler.StepRunResponse:
    properties:
      attempt:
        type: integer
      completed_at:
        type: string
      error_code:
        type: string
      error_message:
        type: string
      findings_count:
        type: integer
      id:
        type: string
      max_attempts:
        type: integer
      started_at:
        type: string
      status:
        type: string
      step_id:
        type: string
      step_key:
        type: string
    type: object
  internal_infra_http_handler.SubdomainResult:
    properties:
      domain:
        type: string
      host:
        type: string
      ips:
        items:
          type: string
        type: array
      source:
        type: string
    type: object
  internal_infra_http_handler.SubmitJobRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      expires_in_min:
        description: Max 24 hours
        maximum: 1440
        minimum: 1
        type: integer
      payload:
        additionalProperties: true
        type: object
      preferred_region:
        maxLength: 50
        type: string
      priority:
        enum:
        - low
        - normal
        - high
        - critical
        type: string
      tool:
        maxLength: 50
        type: string
      type:
        type: string
    required:
    - payload
    - type
    type: object
  internal_infra_http_handler.SubmitJobResponse:
    properties:
      agent:
        $ref: '#/definitions/internal_infra_http_handler.PlatformJobAgentResponse'
      auth_token:
        type: string
      job:
        $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
      queue:
        $ref: '#/definitions/internal_infra_http_handler.PlatformJobQueueResponse'
      status:
        description: assigned, queued, rejected
        type: string
    type: object
  internal_infra_http_handler.SubscriptionResponse:
    properties:
      billing_cycle:
        type: string
      canceled_at:
        type: string
      expires_at:
        type: string
      limits:
        additionalProperties: {}
        type: object
      plan:
        $ref: '#/definitions/internal_infra_http_handler.PlanResponse'
      plan_id:
        type: string
      started_at:
        type: string
      status:
        type: string
      tenant_id:
        type: string
    type: object
  internal_infra_http_handler.SyncResponse:
    properties:
      message:
        type: string
      success:
        type: boolean
      synced_at:
        type: string
      updated_fields:
        items:
          type: string
        type: array
    type: object
  internal_infra_http_handler.TemplateQuotaData:
    properties:
      max_templates:
        type: integer
      max_templates_gitleaks:
        type: integer
      max_templates_nuclei:
        type: integer
      max_templates_semgrep:
        type: integer
      max_total_storage_bytes:
        type: integer
    type: object
  internal_infra_http_handler.TemplateSourceResponse:
    properties:
      auto_sync_on_scan:
        type: boolean
      cache_ttl_minutes:
        type: integer
      created_at:
        type: string
      created_by:
        type: string
      credential_id:
        type: string
      description:
        type: string
      enabled:
        type: boolean
      git_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.GitSourceConfig'
      http_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.HTTPSourceConfig'
      id:
        type: string
      last_sync_at:
        type: string
      last_sync_count:
        type: integer
      last_sync_error:
        type: string
      last_sync_hash:
        type: string
      last_sync_status:
        type: string
      name:
        type: string
      s3_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.S3SourceConfig'
      source_type:
        type: string
      template_type:
        type: string
      tenant_id:
        type: string
      total_templates:
        type: integer
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.TemplateUsageData:
    properties:
      gitleaks_templates:
        type: integer
      nuclei_templates:
        type: integer
      semgrep_templates:
        type: integer
      total_storage_bytes:
        type: integer
      total_templates:
        type: integer
    type: object
  internal_infra_http_handler.TemplateUsageResponse:
    properties:
      quota:
        $ref: '#/definitions/internal_infra_http_handler.TemplateQuotaData'
      usage:
        $ref: '#/definitions/internal_infra_http_handler.TemplateUsageData'
    type: object
  internal_infra_http_handler.TenantEventTypesResponse:
    properties:
      categories:
        items:
          $ref: '#/definitions/internal_infra_http_handler.EventTypeCategoryResponse'
        type: array
      default_event_ids:
        items:
          type: string
        type: array
      event_types:
        items:
          $ref: '#/definitions/internal_infra_http_handler.EventTypeResponse'
        type: array
      total_count:
        type: integer
    type: object
  internal_infra_http_handler.TenantInfo:
    properties:
      id:
        type: string
      name:
        type: string
      role:
        type: string
      slug:
        type: string
    type: object
  internal_infra_http_handler.TenantMembershipResponse:
    properties:
      created_at:
        type: string
      description:
        type: string
      id:
        type: string
      joined_at:
        type: string
      logo_url:
        type: string
      name:
        type: string
      plan:
        type: string
      role:
        type: string
      slug:
        type: string
    type: object
  internal_infra_http_handler.TenantModulesResponse:
    properties:
      beta_module_ids:
        items:
          type: string
        type: array
      coming_soon_module_ids:
        items:
          type: string
        type: array
      event_types:
        items:
          type: string
        type: array
      module_ids:
        items:
          type: string
        type: array
      modules:
        items:
          $ref: '#/definitions/internal_infra_http_handler.LicensingModuleResponse'
        type: array
      sub_modules:
        additionalProperties:
          items:
            $ref: '#/definitions/internal_infra_http_handler.LicensingModuleResponse'
          type: array
        description: parent_module_id -> sub-modules
        type: object
    type: object
  internal_infra_http_handler.TenantToolConfigRequest:
    properties:
      config:
        additionalProperties: {}
        type: object
      is_enabled:
        type: boolean
    type: object
  internal_infra_http_handler.TenantToolConfigResponse:
    properties:
      config:
        additionalProperties: {}
        type: object
      created_at:
        type: string
      custom_patterns:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CustomPatternResponse'
        type: array
      custom_templates:
        items:
          $ref: '#/definitions/internal_infra_http_handler.CustomTemplateResponse'
        type: array
      id:
        type: string
      is_enabled:
        type: boolean
      tenant_id:
        type: string
      tool_id:
        type: string
      updated_at:
        type: string
      updated_by:
        type: string
    type: object
  internal_infra_http_handler.TenantToolStatsResponse:
    properties:
      failed_runs:
        type: integer
      successful_runs:
        type: integer
      tenant_id:
        type: string
      tool_breakdown:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ToolStatsResponse'
        type: array
      total_findings:
        type: integer
      total_runs:
        type: integer
    type: object
  internal_infra_http_handler.TestIntegrationCredentialsRequest:
    description: Request body for testing integration credentials
    properties:
      auth_type:
        enum:
        - token
        - oauth
        - api_key
        - basic
        - app
        example: token
        type: string
      base_url:
        example: https://github.com
        type: string
      category:
        enum:
        - scm
        - security
        - cloud
        - ticketing
        - notification
        example: scm
        type: string
      credentials:
        example: YOUR_TOKEN_HERE
        maxLength: 5000
        type: string
      provider:
        example: github
        type: string
      scm_organization:
        example: my-organization
        maxLength: 255
        type: string
    required:
    - auth_type
    - category
    - credentials
    - provider
    type: object
  internal_infra_http_handler.TestIntegrationCredentialsResponse:
    description: Response from testing integration credentials
    properties:
      message:
        example: Connection successful
        type: string
      organization:
        example: my-org
        type: string
      repository_count:
        example: 25
        type: integer
      success:
        example: true
        type: boolean
      username:
        example: octocat
        type: string
    type: object
  internal_infra_http_handler.TierStatsResponse:
    properties:
      available_slots:
        type: integer
      current_load:
        type: integer
      offline_agents:
        type: integer
      online_agents:
        type: integer
      queued_jobs:
        type: integer
      tier:
        type: string
      total_agents:
        type: integer
      total_capacity:
        type: integer
    type: object
  internal_infra_http_handler.ToolConfigRequest:
    properties:
      custom_template_ids:
        description: IDs of custom templates
        items:
          type: string
        type: array
      enabled:
        type: boolean
      options:
        additionalProperties: {}
        type: object
      severity:
        type: string
      template_mode:
        description: '"default", "custom", "both"'
        type: string
      timeout:
        type: integer
    type: object
  internal_infra_http_handler.ToolConfigResponse:
    properties:
      custom_template_ids:
        description: IDs of custom templates
        items:
          type: string
        type: array
      enabled:
        type: boolean
      options:
        additionalProperties: {}
        type: object
      severity:
        type: string
      template_mode:
        description: '"default", "custom", "both"'
        type: string
      timeout:
        type: integer
    type: object
  internal_infra_http_handler.ToolResponse:
    properties:
      capabilities:
        items:
          type: string
        type: array
      category:
        allOf:
        - $ref: '#/definitions/internal_infra_http_handler.EmbeddedCategoryResponse'
        description: Embedded category info for UI grouping
      category_id:
        description: Foreign key to tool_categories table
        type: string
      config_file_path:
        type: string
      config_schema:
        additionalProperties: {}
        type: object
      created_at:
        type: string
      created_by:
        description: User ID who created the tool (for custom tools)
        type: string
      current_version:
        type: string
      default_config:
        additionalProperties: {}
        type: object
      description:
        type: string
      display_name:
        type: string
      docs_url:
        type: string
      github_url:
        type: string
      has_update:
        type: boolean
      id:
        type: string
      install_cmd:
        type: string
      install_method:
        type: string
      is_active:
        type: boolean
      is_builtin:
        type: boolean
      is_platform_tool:
        description: true for platform tools, false for custom
        type: boolean
      latest_version:
        type: string
      logo_url:
        type: string
      metadata:
        additionalProperties: {}
        type: object
      name:
        type: string
      output_formats:
        items:
          type: string
        type: array
      supported_targets:
        items:
          type: string
        type: array
      tags:
        items:
          type: string
        type: array
      tenant_id:
        description: nil for platform tools, UUID for custom tools
        type: string
      update_cmd:
        type: string
      updated_at:
        type: string
      version_cmd:
        type: string
      version_regex:
        type: string
    type: object
  internal_infra_http_handler.ToolStatsResponse:
    properties:
      avg_duration_ms:
        type: integer
      failed_runs:
        type: integer
      successful_runs:
        type: integer
      tool_id:
        type: string
      total_findings:
        type: integer
      total_runs:
        type: integer
    type: object
  internal_infra_http_handler.ToolWithConfigResponse:
    properties:
      effective_config:
        additionalProperties: {}
        type: object
      is_available:
        description: True if at least one agent supports this tool
        type: boolean
      is_enabled:
        type: boolean
      tenant_config:
        $ref: '#/definitions/internal_infra_http_handler.TenantToolConfigResponse'
      tool:
        $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
    type: object
  internal_infra_http_handler.TriageFindingRequest:
    properties:
      reason:
        description: Optional reason for confirmation
        maxLength: 1000
        type: string
    type: object
  internal_infra_http_handler.TriggerScanExecRequest:
    properties:
      context:
        additionalProperties: {}
        type: object
    type: object
  internal_infra_http_handler.UpdateAgentRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      description:
        maxLength: 1000
        type: string
      max_concurrent_jobs:
        maximum: 100
        minimum: 1
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
      status:
        description: Admin-controlled
        enum:
        - active
        - disabled
        - revoked
        type: string
      tools:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.UpdateAssetGroupRequest:
    properties:
      business_unit:
        maxLength: 255
        type: string
      criticality:
        type: string
      description:
        maxLength: 1000
        type: string
      environment:
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      owner:
        maxLength: 255
        type: string
      owner_email:
        maxLength: 255
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.UpdateAssetOwnershipRequest:
    properties:
      ownership_type:
        enum:
        - primary
        - secondary
        - stakeholder
        - informed
        type: string
    required:
    - ownership_type
    type: object
  internal_infra_http_handler.UpdateAssetRequest:
    properties:
      criticality:
        type: string
      description:
        maxLength: 1000
        type: string
      exposure:
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      scope:
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.UpdateAssetServiceRequest:
    properties:
      banner:
        maxLength: 4096
        type: string
      cpe:
        maxLength: 500
        type: string
      exposure:
        enum:
        - public
        - restricted
        - private
        type: string
      is_public:
        type: boolean
      name:
        maxLength: 255
        type: string
      product:
        maxLength: 255
        type: string
      state:
        enum:
        - active
        - inactive
        - filtered
        type: string
      tls_enabled:
        type: boolean
      tls_version:
        maxLength: 20
        type: string
      version:
        maxLength: 100
        type: string
    type: object
  internal_infra_http_handler.UpdateBranchRequest:
    properties:
      is_protected:
        type: boolean
      keep_when_inactive:
        type: boolean
      last_commit_author:
        maxLength: 100
        type: string
      last_commit_author_avatar:
        maxLength: 500
        type: string
      last_commit_message:
        maxLength: 1000
        type: string
      last_commit_sha:
        maxLength: 40
        type: string
      retention_days:
        maximum: 365
        minimum: 0
        type: integer
      scan_on_pr:
        type: boolean
      scan_on_push:
        type: boolean
    type: object
  internal_infra_http_handler.UpdateCommandStatusRequest:
    properties:
      error_message:
        type: string
      result:
        items:
          type: integer
        type: array
    type: object
  internal_infra_http_handler.UpdateComponentRequest:
    properties:
      dependency_type:
        type: string
      license:
        maxLength: 100
        type: string
      manifest_file:
        maxLength: 255
        type: string
      manifest_path:
        maxLength: 500
        type: string
      namespace:
        maxLength: 255
        type: string
      package_manager:
        maxLength: 50
        type: string
      status:
        type: string
      version:
        maxLength: 100
        type: string
      vulnerability_count:
        minimum: 0
        type: integer
    type: object
  internal_infra_http_handler.UpdateCredentialRequest:
    properties:
      description:
        maxLength: 1000
        type: string
      expires_at:
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
    type: object
  internal_infra_http_handler.UpdateFindingStatusRequest:
    properties:
      resolution:
        maxLength: 1000
        type: string
      status:
        type: string
    required:
    - status
    type: object
  internal_infra_http_handler.UpdateGroupMemberRoleRequest:
    properties:
      role:
        enum:
        - owner
        - lead
        - member
        type: string
    required:
    - role
    type: object
  internal_infra_http_handler.UpdateGroupRequest:
    properties:
      description:
        maxLength: 500
        type: string
      is_active:
        type: boolean
      name:
        maxLength: 100
        minLength: 2
        type: string
      settings:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_group.GroupSettings'
      slug:
        maxLength: 100
        minLength: 2
        type: string
    type: object
  internal_infra_http_handler.UpdateIntegrationRequest:
    description: Request body for updating an existing integration
    properties:
      base_url:
        type: string
      credentials:
        maxLength: 5000
        type: string
      description:
        maxLength: 1000
        type: string
      name:
        example: GitHub Production Updated
        maxLength: 255
        minLength: 1
        type: string
      scm_organization:
        maxLength: 255
        type: string
    type: object
  internal_infra_http_handler.UpdateJobStatusRequest:
    properties:
      error_message:
        type: string
      result:
        additionalProperties: true
        type: object
      status:
        enum:
        - running
        - completed
        - failed
        type: string
    required:
    - status
    type: object
  internal_infra_http_handler.UpdateNotificationIntegrationRequest:
    properties:
      channel_id:
        description: Notification-specific fields
        type: string
      channel_name:
        type: string
      credentials:
        description: Webhook URL or Bot Token (optional, leave empty to keep current)
        type: string
      description:
        maxLength: 1000
        type: string
      enabled_event_types:
        description: Event types to receive notifications for
        items:
          type: string
        type: array
      enabled_severities:
        description: Severity levels to notify on
        items:
          type: string
        type: array
      include_details:
        type: boolean
      message_template:
        type: string
      min_interval_minutes:
        type: integer
      name:
        maxLength: 255
        minLength: 1
        type: string
    type: object
  internal_infra_http_handler.UpdatePermissionSetRequest:
    properties:
      description:
        maxLength: 500
        type: string
      is_active:
        type: boolean
      name:
        maxLength: 100
        minLength: 2
        type: string
    type: object
  internal_infra_http_handler.UpdatePreferencesRequest:
    properties:
      language:
        enum:
        - en
        - vi
        type: string
      notifications:
        type: boolean
      theme:
        enum:
        - light
        - dark
        - system
        type: string
    type: object
  internal_infra_http_handler.UpdateProfileRequest:
    properties:
      avatar_url:
        maxLength: 500
        type: string
      name:
        maxLength: 255
        type: string
      phone:
        maxLength: 50
        type: string
    type: object
  internal_infra_http_handler.UpdateQualityGateRequest:
    properties:
      baseline_branch:
        type: string
      enabled:
        type: boolean
      fail_on_critical:
        type: boolean
      fail_on_high:
        type: boolean
      max_critical:
        type: integer
      max_high:
        type: integer
      max_medium:
        type: integer
      max_total:
        type: integer
      new_findings_only:
        type: boolean
    type: object
  internal_infra_http_handler.UpdateRepositoryExtensionRequest:
    properties:
      branch_count:
        minimum: 0
        type: integer
      clone_url:
        type: string
      component_count:
        minimum: 0
        type: integer
      contributors_count:
        minimum: 0
        type: integer
      default_branch:
        maxLength: 100
        type: string
      forks:
        minimum: 0
        type: integer
      full_name:
        maxLength: 500
        type: string
      language:
        maxLength: 50
        type: string
      languages:
        additionalProperties:
          format: int64
          type: integer
        type: object
      open_issues:
        minimum: 0
        type: integer
      protected_branch_count:
        minimum: 0
        type: integer
      repo_id:
        maxLength: 255
        type: string
      scm_organization:
        maxLength: 255
        type: string
      size_kb:
        minimum: 0
        type: integer
      ssh_url:
        maxLength: 500
        type: string
      stars:
        minimum: 0
        type: integer
      topics:
        items:
          type: string
        maxItems: 50
        type: array
      visibility:
        type: string
      watchers:
        minimum: 0
        type: integer
      web_url:
        type: string
    type: object
  internal_infra_http_handler.UpdateSLAPolicyRequest:
    properties:
      critical_days:
        maximum: 365
        minimum: 1
        type: integer
      description:
        maxLength: 500
        type: string
      escalation_config:
        additionalProperties: {}
        type: object
      escalation_enabled:
        type: boolean
      high_days:
        maximum: 365
        minimum: 1
        type: integer
      info_days:
        maximum: 365
        minimum: 1
        type: integer
      is_active:
        type: boolean
      is_default:
        type: boolean
      low_days:
        maximum: 365
        minimum: 1
        type: integer
      medium_days:
        maximum: 365
        minimum: 1
        type: integer
      name:
        maxLength: 100
        minLength: 1
        type: string
      warning_threshold_pct:
        maximum: 100
        minimum: 0
        type: integer
    type: object
  internal_infra_http_handler.UpdateScanProfileRequest:
    properties:
      description:
        maxLength: 500
        type: string
      intensity:
        enum:
        - low
        - medium
        - high
        type: string
      max_concurrent_scans:
        maximum: 100
        minimum: 1
        type: integer
      name:
        maxLength: 100
        minLength: 1
        type: string
      quality_gate:
        $ref: '#/definitions/internal_infra_http_handler.QualityGateRequest'
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      timeout_seconds:
        maximum: 86400
        minimum: 60
        type: integer
      tools_config:
        additionalProperties:
          $ref: '#/definitions/internal_infra_http_handler.ToolConfigRequest'
        type: object
    type: object
  internal_infra_http_handler.UpdateScanRequest:
    properties:
      description:
        maxLength: 1000
        type: string
      name:
        maxLength: 200
        minLength: 1
        type: string
      pipeline_id:
        type: string
      run_on_tenant_runner:
        type: boolean
      scanner_config:
        additionalProperties: {}
        type: object
      scanner_name:
        maxLength: 100
        type: string
      schedule_cron:
        maxLength: 100
        type: string
      schedule_day:
        type: integer
      schedule_time:
        type: string
      schedule_type:
        enum:
        - manual
        - daily
        - weekly
        - monthly
        - crontab
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      targets_per_job:
        type: integer
      timezone:
        maxLength: 50
        type: string
    type: object
  internal_infra_http_handler.UpdateScanSessionRequest:
    properties:
      error_message:
        type: string
      findings_by_severity:
        additionalProperties:
          type: integer
        type: object
      findings_fixed:
        type: integer
      findings_new:
        type: integer
      findings_total:
        type: integer
      status:
        enum:
        - completed
        - failed
        - canceled
        type: string
    required:
    - status
    type: object
  internal_infra_http_handler.UpdateScannerTemplateRequest:
    properties:
      content:
        description: Base64 encoded, optional
        type: string
      description:
        maxLength: 1000
        type: string
      name:
        maxLength: 255
        minLength: 1
        type: string
      tags:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.UpdateScopeExclusionRequest:
    properties:
      expires_at:
        type: string
      reason:
        maxLength: 1000
        type: string
    type: object
  internal_infra_http_handler.UpdateScopeTargetRequest:
    properties:
      description:
        maxLength: 1000
        type: string
      priority:
        maximum: 100
        minimum: 0
        type: integer
      tags:
        items:
          type: string
        maxItems: 20
        type: array
    type: object
  internal_infra_http_handler.UpdateSeverityRequest:
    properties:
      severity:
        type: string
    required:
    - severity
    type: object
  internal_infra_http_handler.UpdateTemplateSourceRequest:
    properties:
      auto_sync_on_scan:
        type: boolean
      cache_ttl_minutes:
        maximum: 10080
        minimum: 0
        type: integer
      credential_id:
        type: string
      description:
        maxLength: 1000
        type: string
      enabled:
        type: boolean
      git_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.GitSourceConfig'
      http_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.HTTPSourceConfig'
      name:
        maxLength: 255
        minLength: 1
        type: string
      s3_config:
        $ref: '#/definitions/github_com_openctemio_api_internal_domain_templatesource.S3SourceConfig'
    type: object
  internal_infra_http_handler.UpdateToolRequest:
    properties:
      capabilities:
        items:
          type: string
        maxItems: 20
        type: array
      category_id:
        description: 'Optional: link to tool_categories table'
        type: string
      config_schema:
        additionalProperties: {}
        type: object
      default_config:
        additionalProperties: {}
        type: object
      description:
        maxLength: 1000
        type: string
      display_name:
        maxLength: 100
        type: string
      docs_url:
        maxLength: 500
        type: string
      github_url:
        maxLength: 500
        type: string
      install_cmd:
        maxLength: 500
        type: string
      logo_url:
        maxLength: 500
        type: string
      output_formats:
        items:
          type: string
        maxItems: 10
        type: array
      supported_targets:
        items:
          type: string
        maxItems: 10
        type: array
      tags:
        items:
          type: string
        maxItems: 20
        type: array
      update_cmd:
        maxLength: 500
        type: string
      version_cmd:
        maxLength: 500
        type: string
      version_regex:
        maxLength: 200
        type: string
    type: object
  internal_infra_http_handler.UpdateVulnerabilityRequest:
    properties:
      cvss_score:
        maximum: 10
        minimum: 0
        type: number
      cvss_vector:
        maxLength: 100
        type: string
      description:
        maxLength: 10000
        type: string
      epss_percentile:
        maximum: 1
        minimum: 0
        type: number
      epss_score:
        maximum: 1
        minimum: 0
        type: number
      exploit_available:
        type: boolean
      exploit_maturity:
        type: string
      fixed_versions:
        items:
          type: string
        maxItems: 50
        type: array
      remediation:
        maxLength: 5000
        type: string
      severity:
        type: string
      status:
        type: string
      title:
        maxLength: 500
        minLength: 1
        type: string
    type: object
  internal_infra_http_handler.UserInfo:
    properties:
      email:
        type: string
      id:
        type: string
      name:
        type: string
    type: object
  internal_infra_http_handler.UserResponse:
    properties:
      avatar_url:
        type: string
      created_at:
        type: string
      email:
        type: string
      id:
        type: string
      last_login_at:
        type: string
      name:
        type: string
      phone:
        type: string
      preferences:
        $ref: '#/definitions/internal_infra_http_handler.PreferencesDTO'
      status:
        type: string
      updated_at:
        type: string
    type: object
  internal_infra_http_handler.ValidateScannerTemplateRequest:
    properties:
      content:
        description: Base64 encoded
        type: string
      template_type:
        enum:
        - nuclei
        - semgrep
        - gitleaks
        type: string
    required:
    - content
    - template_type
    type: object
  internal_infra_http_handler.ValidationErrorResponse:
    properties:
      code:
        type: string
      field:
        type: string
      message:
        type: string
    type: object
  internal_infra_http_handler.ValidationResultResponse:
    properties:
      errors:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ValidationErrorResponse'
        type: array
      metadata:
        additionalProperties: {}
        type: object
      rule_count:
        type: integer
      valid:
        type: boolean
    type: object
  internal_infra_http_handler.VerifyEmailRequest:
    properties:
      token:
        type: string
    required:
    - token
    type: object
  internal_infra_http_handler.VulnerabilityResponse:
    properties:
      affected_versions:
        items:
          $ref: '#/definitions/internal_infra_http_handler.AffectedVersionResponse'
        type: array
      aliases:
        items:
          type: string
        type: array
      cisa_kev:
        $ref: '#/definitions/internal_infra_http_handler.CISAKEVResponse'
      created_at:
        type: string
      cve_id:
        type: string
      cvss_score:
        type: number
      cvss_vector:
        type: string
      description:
        type: string
      epss_percentile:
        type: number
      epss_score:
        type: number
      exploit_available:
        type: boolean
      exploit_maturity:
        type: string
      fixed_versions:
        items:
          type: string
        type: array
      id:
        type: string
      modified_at:
        type: string
      published_at:
        type: string
      references:
        items:
          $ref: '#/definitions/internal_infra_http_handler.ReferenceResponse'
        type: array
      remediation:
        type: string
      risk_score:
        type: number
      severity:
        type: string
      status:
        type: string
      title:
        type: string
      updated_at:
        type: string
    type: object
externalDocs:
  description: OpenAPI
  url: https://swagger.io/resources/open-api/
host: localhost:8080
info:
  contact:
    email: support@openctem.io
    name: OpenCTEM Team
    url: https://github.com/openctemio/openctem
  description: Unified Continuous Threat Exposure Management (CTEM) Platform API
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://openctem.io/terms/
  title: OpenCTEM API
  version: "1.0"
paths:
  /admin/audit-logs:
    get:
      consumes:
      - application/json
      description: Returns a paginated list of audit logs. Requires Admin API Key.
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Items per page
        in: query
        name: per_page
        type: integer
      - description: Filter by admin email
        in: query
        name: admin_email
        type: string
      - description: Filter by action
        in: query
        name: action
        type: string
      - description: Filter by resource type
        in: query
        name: resource_type
        type: string
      - description: Search term
        in: query
        name: search
        type: string
      - description: Filter by admin ID
        in: query
        name: admin_id
        type: string
      - description: Filter by resource ID
        in: query
        name: resource_id
        type: string
      - description: Filter by success status
        in: query
        name: success
        type: boolean
      - description: Start time (RFC3339)
        in: query
        name: from
        type: string
      - description: End time (RFC3339)
        in: query
        name: to
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AdminAuditLogListResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List admin audit logs
      tags:
      - Admin Audit Logs
  /admin/audit-logs/{id}:
    get:
      consumes:
      - application/json
      description: Returns a single audit log by ID. Requires Admin API Key.
      parameters:
      - description: Audit Log ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AdminAuditLogResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get audit log
      tags:
      - Admin Audit Logs
  /admin/audit-logs/stats:
    get:
      consumes:
      - application/json
      description: Returns statistics about audit logs (total, failed actions). Requires
        Admin API Key.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get audit log statistics
      tags:
      - Admin Audit Logs
  /admin/bootstrap-tokens:
    get:
      consumes:
      - application/json
      description: Get a paginated list of bootstrap tokens (admin only)
      parameters:
      - description: Filter by status (active, revoked, expired, exhausted)
        in: query
        name: status
        type: string
      - description: Search by description
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_BootstrapTokenResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List bootstrap tokens
      tags:
      - Bootstrap Tokens
    post:
      consumes:
      - application/json
      description: Create a new bootstrap token for agent self-registration (admin
        only)
      parameters:
      - description: Token data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateBootstrapTokenRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CreateBootstrapTokenResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create bootstrap token
      tags:
      - Bootstrap Tokens
  /admin/bootstrap-tokens/{id}/revoke:
    post:
      consumes:
      - application/json
      description: Revoke a bootstrap token (admin only)
      parameters:
      - description: Token ID
        in: path
        name: id
        required: true
        type: string
      - description: Revoke reason
        in: body
        name: body
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RevokeBootstrapTokenRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Revoke bootstrap token
      tags:
      - Bootstrap Tokens
  /admin/platform-agents:
    get:
      consumes:
      - application/json
      description: Get a paginated list of platform agents (admin only)
      parameters:
      - description: Filter by health (online, offline, unknown)
        in: query
        name: health
        type: string
      - description: Filter by region
        in: query
        name: region
        type: string
      - description: Filter by tier (shared, dedicated, premium)
        in: query
        name: tier
        type: string
      - description: Filter by capabilities (comma-separated)
        in: query
        name: capabilities
        type: string
      - description: Filter by tools (comma-separated)
        in: query
        name: tools
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_PlatformAgentResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List platform agents
      tags:
      - Platform Agents
    post:
      consumes:
      - application/json
      description: Create a new platform agent (admin only)
      parameters:
      - description: Agent data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreatePlatformAgentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CreatePlatformAgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create platform agent
      tags:
      - Platform Agents
  /admin/platform-agents/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a platform agent (admin only)
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete platform agent
      tags:
      - Platform Agents
    get:
      consumes:
      - application/json
      description: Get a single platform agent by ID (admin only)
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get platform agent
      tags:
      - Platform Agents
  /admin/platform-agents/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disable a platform agent (admin only)
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Disable platform agent
      tags:
      - Platform Agents
  /admin/platform-agents/{id}/enable:
    post:
      consumes:
      - application/json
      description: Enable a disabled platform agent (admin only)
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformAgentResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Enable platform agent
      tags:
      - Platform Agents
  /admin/platform-agents/stats:
    get:
      consumes:
      - application/json
      description: Get aggregate statistics for platform agents (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformAgentStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get platform agent statistics
      tags:
      - Platform Agents
  /admin/platform-jobs:
    get:
      consumes:
      - application/json
      description: List platform jobs across all tenants (admin only)
      parameters:
      - description: Filter by status
        in: query
        name: status
        type: string
      - description: Filter by agent ID
        in: query
        name: agent_id
        type: string
      - description: Filter by tenant ID
        in: query
        name: tenant_id
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_PlatformJobResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List all platform jobs (admin)
      tags:
      - Platform Jobs Admin
  /admin/platform-jobs/{id}:
    get:
      consumes:
      - application/json
      description: Get platform job details (admin only, no tenant restriction)
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get job details (admin)
      tags:
      - Platform Jobs Admin
  /admin/platform-jobs/{id}/cancel:
    post:
      consumes:
      - application/json
      description: Cancel a platform job (admin only)
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Cancel job (admin)
      tags:
      - Platform Jobs Admin
  /admin/platform-jobs/{id}/retry:
    post:
      consumes:
      - application/json
      description: Retry a failed platform job (admin only)
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Retry job (admin)
      tags:
      - Platform Jobs Admin
  /admin/platform-jobs/stats:
    get:
      consumes:
      - application/json
      description: Get platform job queue statistics (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.QueueStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get queue statistics
      tags:
      - Platform Jobs Admin
  /agent/commands:
    get:
      consumes:
      - application/json
      description: Agent polls for pending commands to execute
      parameters:
      - default: 10
        description: Max commands to return
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Poll commands
      tags:
      - Agent
  /agent/commands/{id}/acknowledge:
    post:
      consumes:
      - application/json
      description: Agent acknowledges receipt of a command
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Acknowledge command
      tags:
      - Agent
  /agent/commands/{id}/complete:
    post:
      consumes:
      - application/json
      description: Agent reports successful command completion with optional result
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      - description: Completion result
        in: body
        name: body
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateCommandStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Complete command
      tags:
      - Agent
  /agent/commands/{id}/fail:
    post:
      consumes:
      - application/json
      description: Agent reports command execution failure with error message
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      - description: Error details
        in: body
        name: body
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateCommandStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Fail command
      tags:
      - Agent
  /agent/commands/{id}/start:
    post:
      consumes:
      - application/json
      description: Agent reports that command execution has started
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Start command
      tags:
      - Agent
  /agent/heartbeat:
    post:
      consumes:
      - application/json
      description: Send a heartbeat to indicate agent is alive
      parameters:
      - description: Heartbeat data
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.HeartbeatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Agent heartbeat
      tags:
      - Agent
  /agent/ingest/chunk:
    post:
      consumes:
      - application/json
      description: Ingest a single chunk of a large CTIS report. Used for reports that
        exceed single upload limits.
      parameters:
      - description: Chunk data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ChunkIngestRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ChunkIngestResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Ingest CTIS report chunk
      tags:
      - Agent
  /agent/ingest/recon:
    post:
      consumes:
      - application/json
      description: Ingest reconnaissance scan results (subdomains, DNS, ports, etc.)
      parameters:
      - description: Recon results
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ReconIngestRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IngestResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Ingest recon results
      tags:
      - Agent
  /agent/ingest/ctis:
    post:
      consumes:
      - application/json
      description: Ingest a full CTIS (CTEM Ingest Schema) report containing
        assets and findings
      parameters:
      - description: CTIS report
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.EISIngestRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IngestResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Ingest CTIS report
      tags:
      - Agent
  /agent/ingest/sarif:
    post:
      consumes:
      - application/json
      description: Ingest scan results in SARIF 2.1.0 format
      parameters:
      - description: SARIF data
        in: body
        name: request
        required: true
        schema:
          type: object
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IngestResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Ingest SARIF results
      tags:
      - Agent
  /agent/scans:
    post:
      consumes:
      - application/json
      description: Agent registers a new scan session before starting a scan
      parameters:
      - description: Scan registration data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RegisterScanRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RegisterScanResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Register scan session
      tags:
      - Agent
  /agent/scans/{id}:
    get:
      consumes:
      - application/json
      description: Agent retrieves scan session details
      parameters:
      - description: Scan session ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanSessionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Get scan session (agent)
      tags:
      - Agent
    patch:
      consumes:
      - application/json
      description: Agent updates scan status after completion
      parameters:
      - description: Scan session ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScanSessionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Update scan session
      tags:
      - Agent
  /agents:
    get:
      consumes:
      - application/json
      description: Get a paginated list of agents for the current tenant
      parameters:
      - description: Filter by type (runner, worker, collector, sensor)
        in: query
        name: type
        type: string
      - description: Filter by admin-controlled status (active, disabled, revoked)
        in: query
        name: status
        type: string
      - description: Filter by automatic health (unknown, online, offline, error)
        in: query
        name: health
        type: string
      - description: Filter by execution mode (standalone, daemon)
        in: query
        name: execution_mode
        type: string
      - description: Filter by capabilities (comma-separated)
        in: query
        name: capabilities
        type: string
      - description: Filter by tools (comma-separated)
        in: query
        name: tools
        type: string
      - description: Filter by agents with available capacity
        in: query
        name: has_capacity
        type: boolean
      - description: Search by name or description
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List agents
      tags:
      - Agents
    post:
      consumes:
      - application/json
      description: Create a new agent and receive its API key
      parameters:
      - description: Agent data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateAgentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CreateAgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create agent
      tags:
      - Agents
  /agents/{id}:
    delete:
      consumes:
      - application/json
      description: Delete an agent and revoke its API key
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete agent
      tags:
      - Agents
    get:
      consumes:
      - application/json
      description: Get a single agent by ID
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get agent
      tags:
      - Agents
    put:
      consumes:
      - application/json
      description: Update an existing agent
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateAgentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update agent
      tags:
      - Agents
  /agents/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate an agent (admin action). Allows the agent to authenticate.
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Activate agent
      tags:
      - Agents
  /agents/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disable an agent (admin action). Prevents the agent from authenticating.
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      - description: Disable reason
        in: body
        name: body
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AgentDisableRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Disable agent
      tags:
      - Agents
  /agents/{id}/regenerate-key:
    post:
      consumes:
      - application/json
      description: Regenerate the API key for an agent. The old key will be invalidated.
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentRegenerateAPIKeyResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Regenerate API key
      tags:
      - Agents
  /agents/{id}/revoke:
    post:
      consumes:
      - application/json
      description: Permanently revoke an agent's access (admin action). Cannot be
        undone.
      parameters:
      - description: Agent ID
        in: path
        name: id
        required: true
        type: string
      - description: Revoke reason
        in: body
        name: body
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AgentRevokeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Revoke agent
      tags:
      - Agents
  /api/v1/agents/available-capabilities:
    get:
      description: Returns all unique capability names from all agents accessible
        to the tenant
      parameters:
      - description: 'Include platform agents'' capabilities (default: true)'
        in: query
        name: include_platform
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AvailableCapabilitiesResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get available capabilities
      tags:
      - agents
  /api/v1/credentials:
    get:
      description: List credential leaks with filtering and pagination
      parameters:
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Page size
        in: query
        name: page_size
        type: integer
      - description: Filter by severity (comma-separated)
        in: query
        name: severity
        type: string
      - description: Filter by state (comma-separated)
        in: query
        name: state
        type: string
      - description: Filter by source (comma-separated)
        in: query
        name: source
        type: string
      - description: Search in identifier
        in: query
        name: search
        type: string
      - description: Sort field (prefix - for desc)
        in: query
        name: sort
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialListResult'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List credential leaks
      tags:
      - Credentials
  /api/v1/credentials/{id}:
    get:
      description: Get a single credential leak by its ID
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get credential leak by ID
      tags:
      - Credentials
  /api/v1/credentials/{id}/accept:
    post:
      consumes:
      - application/json
      description: Mark a credential leak as accepted risk
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      - description: Acceptance notes
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CredentialStateChangeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Mark credential as accepted risk
      tags:
      - Credentials
  /api/v1/credentials/{id}/false-positive:
    post:
      consumes:
      - application/json
      description: Mark a credential leak as a false positive
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      - description: Notes
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CredentialStateChangeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Mark credential as false positive
      tags:
      - Credentials
  /api/v1/credentials/{id}/reactivate:
    post:
      description: Mark a resolved credential as active again
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Reactivate a resolved credential
      tags:
      - Credentials
  /api/v1/credentials/{id}/related:
    get:
      description: Get all credentials related to the same identity
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get related credential leaks
      tags:
      - Credentials
  /api/v1/credentials/{id}/resolve:
    post:
      consumes:
      - application/json
      description: Mark a credential leak as resolved
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      - description: Resolution notes
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CredentialStateChangeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialItem'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Mark credential as resolved
      tags:
      - Credentials
  /api/v1/credentials/enums:
    get:
      description: Get available credential types, source types, and other enums
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get available enum values
      tags:
      - Credentials
  /api/v1/credentials/identities:
    get:
      description: List credential leaks grouped by identity (username/email)
      parameters:
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Page size
        in: query
        name: page_size
        type: integer
      - description: Filter by state (comma-separated)
        in: query
        name: state
        type: string
      - description: Search in identifier
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.IdentityListResult'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List credential leaks grouped by identity
      tags:
      - Credentials
  /api/v1/credentials/identities/{identity}/exposures:
    get:
      description: Get all credential exposures for a specific identity with pagination
      parameters:
      - description: Identity (username or email)
        in: path
        name: identity
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Page size
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.CredentialListResult'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get exposures for a specific identity (lazy load)
      tags:
      - Credentials
  /api/v1/credentials/import:
    post:
      consumes:
      - application/json
      description: Import credential leaks with deduplication support
      parameters:
      - description: Import request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CredentialImportRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_domain_credential.ImportResult'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Import credential leaks
      tags:
      - Credentials
  /api/v1/credentials/import/csv:
    post:
      consumes:
      - multipart/form-data
      description: Import credential leaks from CSV file
      parameters:
      - description: CSV file
        in: formData
        name: file
        required: true
        type: file
      - description: Deduplication strategy
        in: query
        name: dedup_strategy
        type: string
      - description: Reactivate resolved credentials
        in: query
        name: reactivate_resolved
        type: boolean
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_domain_credential.ImportResult'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Import credential leaks from CSV
      tags:
      - Credentials
  /api/v1/credentials/import/template:
    get:
      description: Download CSV template for credential import
      produces:
      - text/csv
      responses:
        "200":
          description: CSV template
          schema:
            type: file
      summary: Get CSV import template
      tags:
      - Credentials
  /api/v1/credentials/stats:
    get:
      description: Get statistics for credential leaks
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get credential leak statistics
      tags:
      - Credentials
  /api/v1/groups:
    get:
      description: List all groups in the tenant with optional filtering
      parameters:
      - description: Filter by group type
        in: query
        name: type
        type: string
      - description: Filter by active status
        in: query
        name: active
        type: boolean
      - description: Search by name or slug
        in: query
        name: search
        type: string
      - default: 20
        description: Limit results
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset for pagination
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupListResponse'
      summary: List groups
      tags:
      - groups
    post:
      consumes:
      - application/json
      description: Create a new group for access control
      parameters:
      - description: Group details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateGroupRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Create a new group
      tags:
      - groups
  /api/v1/groups/{groupId}:
    delete:
      description: Delete a group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Delete a group
      tags:
      - groups
    get:
      description: Get a group's details
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get a group by ID
      tags:
      - groups
    put:
      consumes:
      - application/json
      description: Update a group's details
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Update details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateGroupRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Update a group
      tags:
      - groups
  /api/v1/groups/{groupId}/assets:
    get:
      description: List all assets that belong to this group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.AssetOwnerResponse'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List assets assigned to a group
      tags:
      - groups
    post:
      consumes:
      - application/json
      description: Assign an asset to the group with specified ownership type
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Asset assignment details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AssignAssetRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Assign an asset to a group
      tags:
      - groups
  /api/v1/groups/{groupId}/assets/{assetId}:
    delete:
      description: Remove an asset ownership from the group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Asset ID
        in: path
        name: assetId
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Remove an asset from a group
      tags:
      - groups
    put:
      consumes:
      - application/json
      description: Update the ownership type for an asset in a group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Asset ID
        in: path
        name: assetId
        required: true
        type: string
      - description: Ownership details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateAssetOwnershipRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Update asset ownership type
      tags:
      - groups
  /api/v1/groups/{groupId}/members:
    get:
      description: List all members of a group with user details
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.GroupMemberWithUserResponse'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List group members
      tags:
      - groups
    post:
      consumes:
      - application/json
      description: Add a user as a member of the group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Member details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AddGroupMemberRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupMemberResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Add a member to a group
      tags:
      - groups
  /api/v1/groups/{groupId}/members/{userId}:
    delete:
      description: Remove a user from the group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: User ID
        in: path
        name: userId
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Remove a member from a group
      tags:
      - groups
    put:
      consumes:
      - application/json
      description: Update the role of a group member
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: User ID
        in: path
        name: userId
        required: true
        type: string
      - description: Role update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateGroupMemberRoleRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.GroupMemberResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Update a member's role
      tags:
      - groups
  /api/v1/groups/{groupId}/permission-sets:
    get:
      description: Get all permission sets assigned to the group with full details
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.PermissionSetResponse'
            type: array
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: List permission sets assigned to a group
      tags:
      - groups
    post:
      consumes:
      - application/json
      description: Assign a permission set to the group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Permission set details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AssignPermissionSetRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Assign a permission set to a group
      tags:
      - groups
  /api/v1/groups/{groupId}/permission-sets/{permissionSetId}:
    delete:
      description: Remove a permission set assignment from the group
      parameters:
      - description: Group ID
        in: path
        name: groupId
        required: true
        type: string
      - description: Permission Set ID
        in: path
        name: permissionSetId
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Remove a permission set from a group
      tags:
      - groups
  /api/v1/me/assets:
    get:
      description: List all assets the current user can access through their group
        memberships
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: List current user's accessible assets
      tags:
      - assets
  /api/v1/me/groups:
    get:
      description: List all groups the current user belongs to
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.GroupWithRoleResponse'
            type: array
      summary: List current user's groups
      tags:
      - groups
  /api/v1/me/permissions:
    get:
      description: Get all effective permissions for the current user based on their
        group memberships
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.EffectivePermissionsResponse'
      summary: Get effective permissions for current user
      tags:
      - permissions
  /api/v1/permission-sets:
    get:
      description: List all permission sets for the tenant
      parameters:
      - description: Include system permission sets
        in: query
        name: include_system
        type: boolean
      - description: Filter by type
        in: query
        name: type
        type: string
      - description: Search by name
        in: query
        name: search
        type: string
      - default: 20
        description: Limit results
        in: query
        name: limit
        type: integer
      - default: 0
        description: Offset for pagination
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PermissionSetListResponse'
      summary: List permission sets
      tags:
      - permission-sets
    post:
      consumes:
      - application/json
      description: Create a new permission set for access control
      parameters:
      - description: Permission set details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreatePermissionSetRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PermissionSetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Create a new permission set
      tags:
      - permission-sets
  /api/v1/permission-sets/{id}:
    delete:
      description: Delete a permission set
      parameters:
      - description: Permission set ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Delete a permission set
      tags:
      - permission-sets
    get:
      description: Get detailed information about a permission set
      parameters:
      - description: Permission set ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PermissionSetWithItemsResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Get a permission set by ID
      tags:
      - permission-sets
    put:
      consumes:
      - application/json
      description: Update an existing permission set
      parameters:
      - description: Permission set ID
        in: path
        name: id
        required: true
        type: string
      - description: Update details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdatePermissionSetRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PermissionSetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Update a permission set
      tags:
      - permission-sets
  /api/v1/permission-sets/{id}/permissions:
    post:
      consumes:
      - application/json
      description: Add a permission to a permission set
      parameters:
      - description: Permission set ID
        in: path
        name: id
        required: true
        type: string
      - description: Permission details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AddPermissionRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Add a permission to a set
      tags:
      - permission-sets
  /api/v1/permission-sets/{id}/permissions/{permissionId}:
    delete:
      description: Remove a permission from a permission set
      parameters:
      - description: Permission set ID
        in: path
        name: id
        required: true
        type: string
      - description: Permission ID
        in: path
        name: permissionId
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Remove a permission from a set
      tags:
      - permission-sets
  /api/v1/permission-sets/system:
    get:
      description: List all system-defined permission sets
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.PermissionSetResponse'
            type: array
      summary: List system permission sets
      tags:
      - permission-sets
  /asset-groups:
    get:
      consumes:
      - application/json
      description: Get a paginated list of asset groups for the current tenant
      parameters:
      - description: Search by name
        in: query
        name: search
        type: string
      - description: Filter by environments (comma-separated)
        in: query
        name: environments
        type: string
      - description: Filter by criticalities (comma-separated)
        in: query
        name: criticalities
        type: string
      - description: Filter by business unit
        in: query
        name: business_unit
        type: string
      - description: Filter by owner
        in: query
        name: owner
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - description: Filter groups with findings
        in: query
        name: has_findings
        type: boolean
      - description: Minimum risk score
        in: query
        name: min_risk_score
        type: integer
      - description: Maximum risk score
        in: query
        name: max_risk_score
        type: integer
      - description: Sort field (name, created_at, risk_score)
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List asset groups
      tags:
      - Asset Groups
    post:
      consumes:
      - application/json
      description: Create a new asset group
      parameters:
      - description: Asset group data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateAssetGroupRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create asset group
      tags:
      - Asset Groups
  /asset-groups/{id}:
    delete:
      consumes:
      - application/json
      description: Delete an asset group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete asset group
      tags:
      - Asset Groups
    get:
      consumes:
      - application/json
      description: Get a single asset group by ID
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get asset group
      tags:
      - Asset Groups
    patch:
      consumes:
      - application/json
      description: Update an existing asset group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateAssetGroupRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update asset group
      tags:
      - Asset Groups
  /asset-groups/{id}/assets:
    get:
      consumes:
      - application/json
      description: Get a paginated list of assets belonging to the group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_GroupAssetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get assets in group
      tags:
      - Asset Groups
    post:
      consumes:
      - application/json
      description: Add one or more assets to an asset group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      - description: Asset IDs to add
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AddAssetsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Add assets to group
      tags:
      - Asset Groups
  /asset-groups/{id}/assets/remove:
    post:
      consumes:
      - application/json
      description: Remove one or more assets from an asset group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      - description: Asset IDs to remove
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RemoveAssetsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Remove assets from group
      tags:
      - Asset Groups
  /asset-groups/{id}/findings:
    get:
      consumes:
      - application/json
      description: Get a paginated list of findings from assets in the group
      parameters:
      - description: Asset Group ID
        in: path
        name: id
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_GroupFindingResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get findings in group
      tags:
      - Asset Groups
  /asset-groups/bulk:
    patch:
      consumes:
      - application/json
      description: Update multiple asset groups at once
      parameters:
      - description: Bulk update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk update asset groups
      tags:
      - Asset Groups
  /asset-groups/bulk/delete:
    post:
      consumes:
      - application/json
      description: Delete multiple asset groups at once
      parameters:
      - description: Bulk delete data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkDeleteRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk delete asset groups
      tags:
      - Asset Groups
  /asset-groups/stats:
    get:
      consumes:
      - application/json
      description: Get aggregated statistics for asset groups
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetGroupStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get asset group statistics
      tags:
      - Asset Groups
  /asset-types:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of system asset types. Asset types are
        read-only configuration. Use active_only=true to get all active types without
        pagination.
      parameters:
      - description: Return only active asset types (bypasses pagination)
        in: query
        name: active_only
        type: boolean
      - description: Include category details in response
        in: query
        name: include_category
        type: boolean
      - description: Search by name or code
        in: query
        name: search
        type: string
      - description: Filter by category ID
        in: query
        name: category_id
        type: string
      - description: Filter by exact code
        in: query
        name: code
        type: string
      - description: Filter by system type
        in: query
        name: is_system
        type: boolean
      - description: Filter by scannable flag
        in: query
        name: is_scannable
        type: boolean
      - description: Filter by discoverable flag
        in: query
        name: is_discoverable
        type: boolean
      - description: Sort field (e.g., 'name', '-display_order')
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 50
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.AssetTypeResponse'
                type: array
              page:
                type: integer
              per_page:
                type: integer
              total:
                type: integer
              total_pages:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List asset types
      tags:
      - Asset Types
  /asset-types/{id}:
    get:
      consumes:
      - application/json
      description: Retrieves a single system asset type by its unique identifier
      parameters:
      - description: Asset Type ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetTypeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get an asset type by ID
      tags:
      - Asset Types
  /asset-types/categories:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of asset type categories. Use active_only=true
        to get all active categories without pagination.
      parameters:
      - description: Return only active categories (bypasses pagination)
        in: query
        name: active_only
        type: boolean
      - description: Search by name or code
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.CategoryResponse'
                type: array
              page:
                type: integer
              per_page:
                type: integer
              total:
                type: integer
              total_pages:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List asset type categories
      tags:
      - Asset Types
  /asset-types/categories/{categoryId}:
    get:
      consumes:
      - application/json
      description: Retrieves a single asset type category by its unique identifier
      parameters:
      - description: Category ID (UUID)
        in: path
        name: categoryId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CategoryResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get a category by ID
      tags:
      - Asset Types
  /assets:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of assets for the current tenant
      parameters:
      - description: Filter by name (partial match)
        in: query
        name: name
        type: string
      - description: Filter by types (comma-separated)
        in: query
        name: types
        type: string
      - description: Filter by criticalities (comma-separated)
        in: query
        name: criticalities
        type: string
      - description: Filter by statuses (comma-separated)
        in: query
        name: statuses
        type: string
      - description: Filter by scopes (comma-separated)
        in: query
        name: scopes
        type: string
      - description: Filter by exposures (comma-separated)
        in: query
        name: exposures
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - description: Full-text search across name and description
        in: query
        name: search
        type: string
      - description: Minimum risk score (0-100)
        in: query
        name: min_risk_score
        type: integer
      - description: Maximum risk score (0-100)
        in: query
        name: max_risk_score
        type: integer
      - description: Filter by whether asset has findings
        in: query
        name: has_findings
        type: boolean
      - description: Sort field (e.g., -created_at, name, -risk_score)
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        maximum: 100
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List assets
      tags:
      - Assets
    post:
      consumes:
      - application/json
      description: Creates a new asset for the current tenant
      parameters:
      - description: Asset data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateAssetRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create asset
      tags:
      - Assets
  /assets/{id}:
    delete:
      description: Deletes an asset by ID
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete asset
      tags:
      - Assets
    get:
      description: Retrieves an asset by ID
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get asset
      tags:
      - Assets
    put:
      consumes:
      - application/json
      description: Updates an existing asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      - description: Asset data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateAssetRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update asset
      tags:
      - Assets
  /assets/{id}/activate:
    post:
      description: Activates an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Activate asset
      tags:
      - Assets
  /assets/{id}/archive:
    post:
      description: Archives an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Archive asset
      tags:
      - Assets
  /assets/{id}/components:
    get:
      description: Retrieves all components for an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List asset components
      tags:
      - Components
  /assets/{id}/deactivate:
    post:
      description: Deactivates an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Deactivate asset
      tags:
      - Assets
  /assets/{id}/findings:
    get:
      description: Retrieves all findings for an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      - description: Sort field
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List asset findings
      tags:
      - Findings
  /assets/{id}/full:
    get:
      description: Retrieves an asset with its repository extension (if applicable)
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetWithRepositoryResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get asset with repository
      tags:
      - Assets
  /assets/{id}/repository:
    get:
      description: Retrieves the repository extension for an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RepositoryExtensionResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get repository extension
      tags:
      - Assets
    put:
      consumes:
      - application/json
      description: Updates the repository extension for an asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      - description: Repository extension data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateRepositoryExtensionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RepositoryExtensionResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update repository extension
      tags:
      - Assets
  /assets/{id}/scan:
    post:
      description: Triggers a security scan for the repository asset
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Trigger security scan
      tags:
      - Assets
  /assets/{id}/services:
    get:
      consumes:
      - application/json
      description: Retrieves all services discovered on a specific asset
      parameters:
      - description: Asset ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
                type: array
              total:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List services for an asset
      tags:
      - Asset Services
    post:
      consumes:
      - application/json
      description: Creates a new service entry for a specific asset (e.g., discovered
        port/protocol)
      parameters:
      - description: Asset ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Service details
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateAssetServiceRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Service already exists for this port
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create a service for an asset
      tags:
      - Asset Services
  /assets/{id}/sla-policy:
    get:
      description: Gets the SLA policy for a specific asset (or default if not set)
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SLAPolicyResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get asset SLA policy
      tags:
      - SLA Policies
  /assets/{id}/state-history:
    get:
      consumes:
      - application/json
      description: Retrieves all state changes for a specific asset with optional
        filtering
      parameters:
      - description: Asset ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Filter by change type
        in: query
        name: change_type
        type: string
      - description: Filter by source
        in: query
        name: source
        type: string
      - description: Start time (RFC3339)
        in: query
        name: from
        type: string
      - description: End time (RFC3339)
        in: query
        name: to
        type: string
      - default: 50
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      - default: 0
        description: Pagination offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              limit:
                type: integer
              offset:
                type: integer
              total:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List state history for an asset
      tags:
      - Asset State History
  /assets/{id}/sync:
    post:
      description: Syncs repository metadata from the connected SCM provider
      parameters:
      - description: Asset ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SyncResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Sync repository from SCM
      tags:
      - Assets
  /assets/bulk-sync:
    post:
      consumes:
      - application/json
      description: Syncs multiple repository assets from their SCM providers in a
        single request
      parameters:
      - description: Asset IDs to sync
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkSyncRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkSyncResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Bulk sync repositories
      tags:
      - Assets
  /assets/bulk/status:
    post:
      consumes:
      - application/json
      description: Updates the status of multiple assets at once
      parameters:
      - description: Bulk update data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AssetBulkStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetBulkStatusResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Bulk update asset status
      tags:
      - Assets
  /assets/repository:
    post:
      consumes:
      - application/json
      description: Creates a new repository asset with its extension data
      parameters:
      - description: Repository asset data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateRepositoryAssetRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetWithRepositoryResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create repository asset
      tags:
      - Assets
  /assets/stats:
    get:
      description: Returns aggregated statistics for assets
      parameters:
      - description: Filter by types (comma-separated)
        in: query
        name: types
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetStatsResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get asset statistics
      tags:
      - Assets
  /attack-surface/stats:
    get:
      description: Returns attack surface statistics including total assets, exposed
        services, critical exposures, and risk score
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AttackSurfaceStatsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get attack surface statistics
      tags:
      - Attack Surface
  /audit-logs:
    get:
      description: Returns paginated audit logs for the current tenant
      parameters:
      - description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      - description: Filter by actor ID
        in: query
        name: actor_id
        type: string
      - description: Filter by action
        in: query
        name: action
        type: string
      - description: Filter by resource type
        in: query
        name: resource_type
        type: string
      - description: Filter by resource ID
        in: query
        name: resource_id
        type: string
      - description: Filter by result
        in: query
        name: result
        type: string
      - description: Filter by severity
        in: query
        name: severity
        type: string
      - description: Filter since (RFC3339)
        in: query
        name: since
        type: string
      - description: Filter until (RFC3339)
        in: query
        name: until
        type: string
      - description: Search term
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuditLogListResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List audit logs
      tags:
      - Audit Logs
  /audit-logs/{id}:
    get:
      description: Returns a single audit log by ID
      parameters:
      - description: Audit Log ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuditLogResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get audit log
      tags:
      - Audit Logs
  /audit-logs/resource/{type}/{id}:
    get:
      description: Returns audit history for a specific resource
      parameters:
      - description: Resource type
        in: path
        name: type
        required: true
        type: string
      - description: Resource ID
        in: path
        name: id
        required: true
        type: string
      - description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuditLogListResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get resource history
      tags:
      - Audit Logs
  /audit-logs/stats:
    get:
      description: Returns audit log statistics for the last 7 days
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuditStatsResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get audit stats
      tags:
      - Audit Logs
  /audit-logs/user/{id}:
    get:
      description: Returns audit logs for a specific user
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      - description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuditLogListResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get user activity
      tags:
      - Audit Logs
  /auth/forgot-password:
    post:
      consumes:
      - application/json
      description: Sends password reset email
      parameters:
      - description: Email address
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ForgotPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Forgot password
      tags:
      - Authentication
  /auth/info:
    get:
      description: Returns authentication provider information
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuthInfoResponse'
      summary: Auth info
      tags:
      - Authentication
  /auth/keycloak/info:
    get:
      description: Returns Keycloak server configuration URLs and realm info
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.KeycloakInfoResponse'
      summary: Get Keycloak info
      tags:
      - Authentication
  /auth/keycloak/token:
    post:
      description: Deprecated endpoint - returns redirect instruction to Keycloak
        OAuth flow
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Generate token (deprecated)
      tags:
      - Authentication
  /auth/login:
    post:
      consumes:
      - application/json
      description: Authenticates a user and returns refresh token and tenant list
      parameters:
      - description: Login credentials
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.LoginResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
      summary: User login
      tags:
      - Authentication
  /auth/logout:
    post:
      description: Logs out the current user and invalidates the session
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: User logout
      tags:
      - Authentication
  /auth/oauth/{provider}/authorize:
    get:
      description: Returns authorization URL for OAuth login with the specified provider
      parameters:
      - description: OAuth provider (google, github, gitlab)
        in: path
        name: provider
        required: true
        type: string
      - description: Callback URL after authorization
        in: query
        name: redirect_uri
        type: string
      - description: Final redirect URL after login
        in: query
        name: final_redirect
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AuthorizeResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get OAuth authorization URL
      tags:
      - OAuth
  /auth/oauth/{provider}/callback:
    post:
      consumes:
      - application/json
      description: Handles the OAuth callback after user authorization
      parameters:
      - description: OAuth provider
        in: path
        name: provider
        required: true
        type: string
      - description: Callback data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CallbackRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CallbackResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: OAuth callback handler
      tags:
      - OAuth
  /auth/oauth/providers:
    get:
      description: Returns list of available and configured OAuth providers
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ProvidersResponse'
      summary: List OAuth providers
      tags:
      - OAuth
  /auth/refresh:
    post:
      consumes:
      - application/json
      description: Refreshes access token and rotates refresh token
      parameters:
      - description: Refresh token data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RefreshTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RefreshTokenResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Refresh token
      tags:
      - Authentication
  /auth/register:
    post:
      consumes:
      - application/json
      description: Registers a new user with email and password
      parameters:
      - description: Registration data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RegisterRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RegisterResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Register user
      tags:
      - Authentication
  /auth/reset-password:
    post:
      consumes:
      - application/json
      description: Resets password using token
      parameters:
      - description: Reset token and new password
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ResetPasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Reset password
      tags:
      - Authentication
  /auth/token:
    post:
      consumes:
      - application/json
      description: Exchanges refresh token for tenant-scoped access token
      parameters:
      - description: Token exchange data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ExchangeTokenRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExchangeTokenResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Exchange token
      tags:
      - Authentication
  /auth/verify-email:
    post:
      consumes:
      - application/json
      description: Verifies user email with token
      parameters:
      - description: Verification token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.VerifyEmailRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Verify email
      tags:
      - Authentication
  /commands:
    get:
      consumes:
      - application/json
      description: Get a paginated list of commands
      parameters:
      - description: Filter by agent ID
        in: query
        name: agent_id
        type: string
      - description: Filter by type (scan, collect, health_check, config_update, cancel)
        in: query
        name: type
        type: string
      - description: Filter by status (pending, running, completed, failed, canceled)
        in: query
        name: status
        type: string
      - description: Filter by priority (low, normal, high, critical)
        in: query
        name: priority
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List commands
      tags:
      - Commands
    post:
      consumes:
      - application/json
      description: Create a new command to be executed by an agent
      parameters:
      - description: Command data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateCommandRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create command
      tags:
      - Commands
  /commands/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a command
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete command
      tags:
      - Commands
    get:
      consumes:
      - application/json
      description: Get a single command by ID
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get command
      tags:
      - Commands
  /commands/{id}/cancel:
    post:
      consumes:
      - application/json
      description: Cancel a pending or running command
      parameters:
      - description: Command ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CommandResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Cancel command
      tags:
      - Commands
  /components:
    get:
      description: Retrieves a paginated list of components for the current tenant
      parameters:
      - description: Filter by asset ID
        in: query
        name: asset_id
        type: string
      - description: Filter by name
        in: query
        name: name
        type: string
      - description: Filter by ecosystems (comma-separated)
        in: query
        name: ecosystems
        type: string
      - description: Filter by statuses (comma-separated)
        in: query
        name: statuses
        type: string
      - description: Filter by dependency types
        in: query
        name: dependency_types
        type: string
      - description: Filter by has vulnerabilities
        in: query
        name: has_vulnerabilities
        type: boolean
      - description: Filter by licenses (comma-separated)
        in: query
        name: licenses
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List components
      tags:
      - Components
    post:
      consumes:
      - application/json
      description: Creates a new component
      parameters:
      - description: Component data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateComponentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ComponentResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create component
      tags:
      - Components
  /components/{id}:
    delete:
      description: Deletes a component
      parameters:
      - description: Component ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete component
      tags:
      - Components
    get:
      description: Retrieves a component by ID
      parameters:
      - description: Component ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ComponentResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get component
      tags:
      - Components
    put:
      consumes:
      - application/json
      description: Updates a component
      parameters:
      - description: Component ID
        in: path
        name: id
        required: true
        type: string
      - description: Component data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateComponentRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ComponentResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update component
      tags:
      - Components
  /components/ecosystems:
    get:
      description: Retrieves per-ecosystem statistics for the tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_openctemio_api_internal_domain_component.EcosystemStats'
            type: array
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get ecosystem statistics
      tags:
      - Components
  /components/licenses:
    get:
      description: Retrieves license distribution statistics for the tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_openctemio_api_internal_domain_component.LicenseStats'
            type: array
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get license statistics
      tags:
      - Components
  /components/stats:
    get:
      description: Retrieves aggregated component statistics for the tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_domain_component.ComponentStats'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get component statistics
      tags:
      - Components
  /components/vulnerable:
    get:
      description: Retrieves components with vulnerability details for the tenant
      parameters:
      - default: 10
        description: Limit results
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/github_com_openctemio_api_internal_domain_component.VulnerableComponent'
            type: array
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get vulnerable components
      tags:
      - Components
  /config/finding-sources:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of system finding sources. Finding sources
        are read-only configuration. Use active_only=true to get all active sources
        without pagination.
      parameters:
      - description: Return only active finding sources (bypasses pagination)
        in: query
        name: active_only
        type: boolean
      - description: Include category details in response
        in: query
        name: include_category
        type: boolean
      - description: Search by name or code
        in: query
        name: search
        type: string
      - description: Filter by category ID
        in: query
        name: category_id
        type: string
      - description: Filter by category code
        in: query
        name: category_code
        type: string
      - description: Filter by exact code
        in: query
        name: code
        type: string
      - description: Filter by system type
        in: query
        name: is_system
        type: boolean
      - description: Sort field (e.g., 'name', '-display_order')
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 50
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.FindingSourceResponse'
                type: array
              page:
                type: integer
              per_page:
                type: integer
              total:
                type: integer
              total_pages:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List finding sources
      tags:
      - Configuration
  /config/finding-sources/{id}:
    get:
      consumes:
      - application/json
      description: Retrieves a single system finding source by its unique identifier
      parameters:
      - description: Finding Source ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get a finding source by ID
      tags:
      - Configuration
  /config/finding-sources/categories:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of finding source categories. Use active_only=true
        to get all active categories without pagination.
      parameters:
      - description: Return only active categories (bypasses pagination)
        in: query
        name: active_only
        type: boolean
      - description: Search by name or code
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.FindingSourceCategoryResponse'
                type: array
              page:
                type: integer
              per_page:
                type: integer
              total:
                type: integer
              total_pages:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List finding source categories
      tags:
      - Configuration
  /config/finding-sources/categories/{categoryId}:
    get:
      consumes:
      - application/json
      description: Retrieves a single finding source category by its unique identifier
      parameters:
      - description: Category ID (UUID)
        in: path
        name: categoryId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingSourceCategoryResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get a category by ID
      tags:
      - Configuration
  /config/finding-sources/code/{code}:
    get:
      consumes:
      - application/json
      description: Retrieves a single system finding source by its code (e.g., 'sast',
        'dast', 'pentest')
      parameters:
      - description: Finding Source Code
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get a finding source by code
      tags:
      - Configuration
  /credentials:
    get:
      consumes:
      - application/json
      description: List credentials with optional filters
      parameters:
      - description: Filter by credential type
        in: query
        name: credential_type
        type: string
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Page size
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListCredentialsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List credentials
      tags:
      - Credentials
    post:
      consumes:
      - application/json
      description: Create a new credential for template sources
      parameters:
      - description: Credential data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateCredentialRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CredentialResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create credential
      tags:
      - Credentials
  /credentials/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a credential
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete credential
      tags:
      - Credentials
    get:
      consumes:
      - application/json
      description: Get a single credential by ID (without sensitive data)
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CredentialResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get credential
      tags:
      - Credentials
    put:
      consumes:
      - application/json
      description: Update credential metadata (not sensitive data)
      parameters:
      - description: Credential ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated credential data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateCredentialRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CredentialResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update credential
      tags:
      - Credentials
  /custom-tools:
    get:
      consumes:
      - application/json
      description: Get a paginated list of tenant's custom tools
      parameters:
      - description: Filter by category
        in: query
        name: category
        type: string
      - description: Filter by capabilities (comma-separated)
        in: query
        name: capabilities
        type: string
      - description: Filter by active status
        in: query
        name: is_active
        type: boolean
      - description: Search by name or description
        in: query
        name: search
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List custom tools
      tags:
      - Custom Tools
    post:
      consumes:
      - application/json
      description: Create a new tenant custom tool
      parameters:
      - description: Tool data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateToolRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create custom tool
      tags:
      - Custom Tools
  /custom-tools/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a tenant custom tool
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete custom tool
      tags:
      - Custom Tools
    get:
      consumes:
      - application/json
      description: Get a single tenant custom tool by ID
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get custom tool
      tags:
      - Custom Tools
    put:
      consumes:
      - application/json
      description: Update a tenant custom tool
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateToolRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update custom tool
      tags:
      - Custom Tools
  /custom-tools/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate a tenant custom tool
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Activate custom tool
      tags:
      - Custom Tools
  /custom-tools/{id}/deactivate:
    post:
      consumes:
      - application/json
      description: Deactivate a tenant custom tool
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Deactivate custom tool
      tags:
      - Custom Tools
  /dashboard/stats:
    get:
      description: Returns dashboard statistics for the current tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.DashboardStatsResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get tenant dashboard stats
      tags:
      - Dashboard
  /dashboard/stats/global:
    get:
      description: Returns dashboard statistics filtered by user's accessible tenants
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.DashboardStatsResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get global dashboard stats
      tags:
      - Dashboard
  /event-types:
    get:
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantEventTypesResponse'
      summary: List all event types
      tags:
      - Licensing
  /exposures:
    get:
      consumes:
      - application/json
      description: Get a paginated list of exposure events
      parameters:
      - description: Filter by asset ID
        in: query
        name: asset_id
        type: string
      - collectionFormat: csv
        description: Filter by event types
        in: query
        items:
          type: string
        name: event_type
        type: array
      - collectionFormat: csv
        description: Filter by severities
        in: query
        items:
          type: string
        name: severity
        type: array
      - collectionFormat: csv
        description: Filter by states
        in: query
        items:
          type: string
        name: state
        type: array
      - description: Search term
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List exposures
      tags:
      - Exposures
    post:
      consumes:
      - application/json
      description: Create a new exposure event
      parameters:
      - description: Exposure data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateExposureRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create exposure
      tags:
      - Exposures
  /exposures/{id}:
    delete:
      consumes:
      - application/json
      description: Delete an exposure event
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete exposure
      tags:
      - Exposures
    get:
      consumes:
      - application/json
      description: Get a single exposure event by ID
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get exposure
      tags:
      - Exposures
  /exposures/{id}/accept:
    post:
      consumes:
      - application/json
      description: Accept an exposure as a known risk
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      - description: Accept reason
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ChangeStateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Accept exposure
      tags:
      - Exposures
  /exposures/{id}/false-positive:
    post:
      consumes:
      - application/json
      description: Mark an exposure as a false positive
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      - description: Reason
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ChangeStateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Mark as false positive
      tags:
      - Exposures
  /exposures/{id}/history:
    get:
      consumes:
      - application/json
      description: Get state change history for an exposure
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get exposure history
      tags:
      - Exposures
  /exposures/{id}/reactivate:
    post:
      consumes:
      - application/json
      description: Reactivate a resolved or accepted exposure
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Reactivate exposure
      tags:
      - Exposures
  /exposures/{id}/resolve:
    post:
      consumes:
      - application/json
      description: Mark an exposure as resolved
      parameters:
      - description: Exposure ID
        in: path
        name: id
        required: true
        type: string
      - description: Resolution reason
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ChangeStateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ExposureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Resolve exposure
      tags:
      - Exposures
  /exposures/ingest:
    post:
      consumes:
      - application/json
      description: Ingest multiple exposure events at once
      parameters:
      - description: Exposures to ingest
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkIngestRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk ingest exposures
      tags:
      - Exposures
  /exposures/stats:
    get:
      consumes:
      - application/json
      description: Get aggregated statistics for exposure events
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get exposure statistics
      tags:
      - Exposures
  /findings:
    get:
      description: Retrieves a paginated list of findings for the current tenant
      parameters:
      - description: Filter by asset ID
        in: query
        name: asset_id
        type: string
      - description: Filter by branch ID
        in: query
        name: branch_id
        type: string
      - description: Filter by component ID
        in: query
        name: component_id
        type: string
      - description: Filter by vulnerability ID
        in: query
        name: vulnerability_id
        type: string
      - description: Filter by severities (comma-separated)
        in: query
        name: severities
        type: string
      - description: Filter by statuses (comma-separated)
        in: query
        name: statuses
        type: string
      - description: Filter by sources
        in: query
        name: sources
        type: string
      - description: Filter by tool name
        in: query
        name: tool_name
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List findings
      tags:
      - Findings
    post:
      consumes:
      - application/json
      description: Creates a new finding for the current tenant
      parameters:
      - description: Finding data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateFindingRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create finding
      tags:
      - Findings
  /findings/{id}:
    delete:
      description: Deletes a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete finding
      tags:
      - Findings
    get:
      description: Retrieves a finding by ID
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get finding
      tags:
      - Findings
  /findings/{id}/assign:
    post:
      consumes:
      - application/json
      description: Assigns a finding to a user
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Assignment data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.AssignFindingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Assign finding
      tags:
      - Findings
  /findings/{id}/classify:
    patch:
      consumes:
      - application/json
      description: Sets CVE, CWE, and CVSS classification for a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Classification data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ClassifyFindingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Classify finding
      tags:
      - Findings
  /findings/{id}/dataflows:
    get:
      description: Returns the data flow traces (attack paths) for a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.DataFlowResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get finding data flows
      tags:
      - Findings
  /findings/{id}/severity:
    patch:
      consumes:
      - application/json
      description: Updates the severity level of a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Severity data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateSeverityRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update finding severity
      tags:
      - Findings
  /findings/{id}/status:
    patch:
      consumes:
      - application/json
      description: Updates the status of a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Status data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateFindingStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update finding status
      tags:
      - Findings
  /findings/{id}/tags:
    put:
      consumes:
      - application/json
      description: Sets the tags for a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Tags data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.SetTagsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Set finding tags
      tags:
      - Findings
  /findings/{id}/triage:
    patch:
      consumes:
      - application/json
      description: Sets the triage status of a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      - description: Triage data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.TriageFindingRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Triage finding
      tags:
      - Findings
  /findings/{id}/unassign:
    post:
      description: Removes assignment from a finding
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Unassign finding
      tags:
      - Findings
  /findings/{id}/verify:
    post:
      consumes:
      - application/json
      description: Marks a resolved finding as verified
      parameters:
      - description: Finding ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Verify finding fix
      tags:
      - Findings
  /findings/bulk/assign:
    post:
      consumes:
      - application/json
      description: Assigns multiple findings to a user
      parameters:
      - description: Bulk assign data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkAssignRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkUpdateResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Bulk assign findings
      tags:
      - Findings
  /findings/bulk/status:
    post:
      consumes:
      - application/json
      description: Updates the status of multiple findings
      parameters:
      - description: Bulk update data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkUpdateStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkUpdateResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Bulk update finding status
      tags:
      - Findings
  /findings/stats:
    get:
      description: Returns aggregated statistics for findings
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.FindingStatsResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get finding statistics
      tags:
      - Findings
  /health:
    get:
      description: Returns the health status of the service (liveness probe)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.HealthResponse'
      summary: Health check
      tags:
      - Health
  /ingest/check:
    post:
      consumes:
      - application/json
      description: Check if fingerprints already exist for deduplication
      parameters:
      - description: Fingerprints to check
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CheckFingerprintsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.CheckFingerprintsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Check fingerprints
      tags:
      - Agent
  /integrations:
    get:
      consumes:
      - application/json
      description: Returns a paginated list of integrations for the current tenant
      parameters:
      - description: Filter by category
        enum:
        - scm
        - security
        - cloud
        - ticketing
        - notification
        in: query
        name: category
        type: string
      - description: Filter by provider
        in: query
        name: provider
        type: string
      - description: Filter by status
        enum:
        - pending
        - connected
        - disconnected
        - error
        in: query
        name: status
        type: string
      - description: Search by name
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        maximum: 100
        minimum: 1
        name: per_page
        type: integer
      - description: Sort field
        enum:
        - name
        - category
        - provider
        - status
        - created_at
        - updated_at
        in: query
        name: sort
        type: string
      - description: Sort order
        enum:
        - asc
        - desc
        in: query
        name: order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: List of integrations
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_IntegrationResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List integrations
      tags:
      - Integrations
    post:
      consumes:
      - application/json
      description: Creates a new integration for connecting with external providers
      parameters:
      - description: Integration details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateIntegrationRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - validation error
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict - integration with same name exists
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create integration
      tags:
      - Integrations
  /integrations/{id}:
    delete:
      consumes:
      - application/json
      description: Permanently deletes an integration. This action cannot be undone.
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No content - successfully deleted
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete integration
      tags:
      - Integrations
    get:
      consumes:
      - application/json
      description: Retrieves details of a specific integration by ID
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Integration details
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get integration
      tags:
      - Integrations
    put:
      consumes:
      - application/json
      description: Updates an existing integration. Only provided fields will be updated.
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      - description: Fields to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateIntegrationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - validation error
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict - name already exists
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update integration
      tags:
      - Integrations
  /integrations/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disables an active integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Disabled integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Disable integration
      tags:
      - Integrations
  /integrations/{id}/enable:
    post:
      consumes:
      - application/json
      description: Enables a disabled integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Enabled integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Enable integration
      tags:
      - Integrations
  /integrations/{id}/notification:
    put:
      consumes:
      - application/json
      description: Updates an existing notification integration (Slack, Teams, Telegram,
        Webhook)
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      - description: Updated notification integration details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateNotificationIntegrationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Updated notification integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationWithNotificationResponse'
        "400":
          description: Bad request - validation error
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update notification integration
      tags:
      - Integrations
  /integrations/{id}/notification-events:
    get:
      consumes:
      - application/json
      description: Retrieves notification events for a specific integration from the
        audit trail
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      - default: 50
        description: Maximum number of entries to return
        in: query
        maximum: 100
        minimum: 1
        name: limit
        type: integer
      - default: 0
        description: Number of entries to skip
        in: query
        minimum: 0
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Notification events with pagination
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.GetNotificationEventsResult'
        "400":
          description: Bad request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get notification events
      tags:
      - Integrations
  /integrations/{id}/repositories:
    get:
      consumes:
      - application/json
      description: Lists repositories accessible through an SCM integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      - description: Search by repository name
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        minimum: 1
        name: page
        type: integer
      - default: 30
        description: Items per page
        in: query
        maximum: 100
        minimum: 1
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: List of repositories
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListSCMRepositoriesResponse'
        "400":
          description: Bad request - invalid ID or not an SCM integration
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List repositories from SCM integration
      tags:
      - Integrations
  /integrations/{id}/send:
    post:
      consumes:
      - application/json
      description: Sends a notification through the specified integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      - description: Notification content
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.SendNotificationRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Send result
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Send notification
      tags:
      - Integrations
  /integrations/{id}/sync:
    post:
      consumes:
      - application/json
      description: Triggers a sync for the integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Integration with updated sync status
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Sync integration
      tags:
      - Integrations
  /integrations/{id}/test:
    post:
      consumes:
      - application/json
      description: Tests the integration by verifying credentials and connectivity
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Connection test result with updated status
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
        "400":
          description: Bad request - invalid ID
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Test integration
      tags:
      - Integrations
  /integrations/{id}/test-notification:
    post:
      consumes:
      - application/json
      description: Sends a test notification through the integration
      parameters:
      - description: Integration ID
        format: uuid
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Test result
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not found
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Test notification integration
      tags:
      - Integrations
  /integrations/notifications:
    get:
      consumes:
      - application/json
      description: Returns a list of notification integrations with their extensions
      produces:
      - application/json
      responses:
        "200":
          description: List of notification integrations
          schema:
            additionalProperties:
              items:
                $ref: '#/definitions/internal_infra_http_handler.IntegrationWithNotificationResponse'
              type: array
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List notification integrations
      tags:
      - Integrations
    post:
      consumes:
      - application/json
      description: Creates a new notification integration (Slack, Teams, Telegram,
        Webhook)
      parameters:
      - description: Notification integration details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateNotificationIntegrationRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created notification integration
          schema:
            $ref: '#/definitions/internal_infra_http_handler.IntegrationWithNotificationResponse'
        "400":
          description: Bad request - validation error
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict - integration with same name exists
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create notification integration
      tags:
      - Integrations
  /integrations/scm:
    get:
      consumes:
      - application/json
      description: Returns a list of SCM integrations with their extensions
      produces:
      - application/json
      responses:
        "200":
          description: List of SCM integrations
          schema:
            additionalProperties:
              items:
                $ref: '#/definitions/internal_infra_http_handler.IntegrationResponse'
              type: array
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List SCM integrations
      tags:
      - Integrations
  /integrations/test-credentials:
    post:
      consumes:
      - application/json
      description: Tests integration credentials by verifying connectivity without
        persisting
      parameters:
      - description: Credentials to test
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.TestIntegrationCredentialsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Credentials test result
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TestIntegrationCredentialsResponse'
        "400":
          description: Bad request - validation error
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "403":
          description: Forbidden - insufficient permissions
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal server error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Test integration credentials without creating
      tags:
      - Integrations
  /me/bootstrap:
    get:
      description: 'Returns all initial data needed after login: permissions, subscription,
        and modules.'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BootstrapResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bootstrap initial data
      tags:
      - Bootstrap
  /me/event-types:
    get:
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantEventTypesResponse'
      security:
      - BearerAuth: []
      summary: Get tenant event types
      tags:
      - Licensing
  /me/permissions:
    get:
      description: |-
        Returns the permissions for the authenticated user in the current tenant.
        Supports ETag-based caching: send If-None-Match header to check for changes.
      parameters:
      - description: ETag from previous response
        in: header
        name: If-None-Match
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PermissionsResponse'
        "304":
          description: Not Modified - permissions unchanged
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get current user permissions
      tags:
      - Permissions
  /modules:
    get:
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.LicensingModuleResponse'
            type: array
      summary: List modules
      tags:
      - Licensing
  /notification-outbox:
    get:
      consumes:
      - application/json
      description: List notification outbox entries for the current tenant with filtering
        and pagination
      parameters:
      - description: Filter by status (pending, processing, completed, failed, dead)
        in: query
        name: status
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Page size
        in: query
        name: page_size
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_pagination.Result-internal_infra_http_handler_OutboxEntryResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
      security:
      - BearerAuth: []
      summary: List notification outbox entries
      tags:
      - notification-outbox
  /notification-outbox/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a specific outbox entry (must belong to current tenant)
      parameters:
      - description: Outbox entry ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
      security:
      - BearerAuth: []
      summary: Delete outbox entry
      tags:
      - notification-outbox
    get:
      consumes:
      - application/json
      description: Get a specific outbox entry by ID (must belong to current tenant)
      parameters:
      - description: Outbox entry ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.OutboxEntryResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
      security:
      - BearerAuth: []
      summary: Get notification outbox entry
      tags:
      - notification-outbox
  /notification-outbox/{id}/retry:
    post:
      consumes:
      - application/json
      description: Reset a failed/dead outbox entry to pending for retry (must belong
        to current tenant)
      parameters:
      - description: Outbox entry ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.OutboxEntryResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
      security:
      - BearerAuth: []
      summary: Retry failed outbox entry
      tags:
      - notification-outbox
  /notification-outbox/stats:
    get:
      consumes:
      - application/json
      description: Get counts of outbox entries by status for the current tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.OutboxStatsResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Response'
      security:
      - BearerAuth: []
      summary: Get notification outbox statistics
      tags:
      - notification-outbox
  /plans:
    get:
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.PlanResponse'
            type: array
      summary: List public plans
      tags:
      - Licensing
  /plans/{id}:
    get:
      parameters:
      - description: Plan ID or slug
        in: path
        name: id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlanResponse'
      summary: Get plan
      tags:
      - Licensing
  /platform-agent/heartbeat:
    post:
      consumes:
      - application/json
      description: Record a heartbeat from a platform agent
      parameters:
      - description: Heartbeat data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.HeartbeatRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Platform agent heartbeat
      tags:
      - Platform Agent API
  /platform-agent/jobs/{id}/status:
    post:
      consumes:
      - application/json
      description: Platform agent updates the status of a job it's executing
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      - description: Status update
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateJobStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Update job status
      tags:
      - Platform Agent API
  /platform-agent/jobs/claim:
    post:
      consumes:
      - application/json
      description: Platform agent claims the next available job matching its capabilities
      parameters:
      - description: Agent capabilities
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ClaimJobRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ClaimJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - ApiKeyAuth: []
      summary: Claim next job
      tags:
      - Platform Agent API
  /platform-agents/register:
    post:
      consumes:
      - application/json
      description: Self-register a platform agent using a bootstrap token (no auth
        required)
      parameters:
      - description: Registration data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.RegisterAgentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RegisterAgentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Invalid or expired bootstrap token
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Token constraints not met
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      summary: Register platform agent
      tags:
      - Platform Agents
  /platform-jobs:
    get:
      consumes:
      - application/json
      description: Get a paginated list of platform jobs for the current tenant
      parameters:
      - description: Filter by status (pending, acknowledged, running, completed,
          failed, expired)
        in: query
        name: status
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_PlatformJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List platform jobs
      tags:
      - Platform Jobs
    post:
      consumes:
      - application/json
      description: Submit a new job to be executed by a platform agent
      parameters:
      - description: Job data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.SubmitJobRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SubmitJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "429":
          description: Queue limit reached
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Submit platform job
      tags:
      - Platform Jobs
  /platform-jobs/{id}:
    get:
      consumes:
      - application/json
      description: Get the current status of a platform job
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SubmitJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get job status
      tags:
      - Platform Jobs
  /platform-jobs/{id}/cancel:
    post:
      consumes:
      - application/json
      description: Cancel a pending or running platform job
      parameters:
      - description: Job ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.PlatformJobResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Cancel platform job
      tags:
      - Platform Jobs
  /ready:
    get:
      description: Checks all dependencies and returns 503 if any are unhealthy
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ReadyResponse'
        "503":
          description: Service Unavailable
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ReadyResponse'
      summary: Readiness check
      tags:
      - Health
  /repositories/{repository_id}/branches:
    get:
      description: Retrieves all branches for a repository
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Filter by name
        in: query
        name: name
        type: string
      - description: Filter by types (comma-separated)
        in: query
        name: types
        type: string
      - description: Filter by default branch
        in: query
        name: is_default
        type: boolean
      - description: Filter by scan status
        in: query
        name: scan_status
        type: string
      - description: Sort field
        in: query
        name: sort
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List branches
      tags:
      - Branches
    post:
      consumes:
      - application/json
      description: Creates a new branch for a repository
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Branch data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateBranchRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BranchResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create branch
      tags:
      - Branches
  /repositories/{repository_id}/branches/{id}:
    delete:
      description: Deletes a branch
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Branch ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete branch
      tags:
      - Branches
    get:
      description: Retrieves a branch by ID
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Branch ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BranchResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get branch
      tags:
      - Branches
    put:
      consumes:
      - application/json
      description: Updates a branch
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Branch ID
        in: path
        name: id
        required: true
        type: string
      - description: Branch data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateBranchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BranchResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update branch
      tags:
      - Branches
  /repositories/{repository_id}/branches/{id}/default:
    put:
      description: Sets a branch as the default for a repository
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      - description: Branch ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BranchResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Set default branch
      tags:
      - Branches
  /repositories/{repository_id}/branches/default:
    get:
      description: Gets the default branch for a repository
      parameters:
      - description: Repository ID
        in: path
        name: repository_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BranchResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get default branch
      tags:
      - Branches
  /scan-profiles:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scan profiles for the current tenant
      parameters:
      - description: Filter by default status
        in: query
        name: is_default
        type: boolean
      - description: Filter by system status
        in: query
        name: is_system
        type: boolean
      - description: 'Include system profiles in results (default: true)'
        in: query
        name: include_system
        type: boolean
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - description: Search by name or description
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scan profiles
      tags:
      - Scan Profiles
    post:
      consumes:
      - application/json
      description: Create a new scan profile with tool configurations
      parameters:
      - description: Scan profile data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScanProfileRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scan profile
      tags:
      - Scan Profiles
  /scan-profiles/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scan profile (system profiles cannot be deleted)
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scan profile
      tags:
      - Scan Profiles
    get:
      consumes:
      - application/json
      description: Get a single scan profile by ID
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan profile
      tags:
      - Scan Profiles
    put:
      consumes:
      - application/json
      description: Update an existing scan profile
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScanProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update scan profile
      tags:
      - Scan Profiles
  /scan-profiles/{id}/clone:
    post:
      consumes:
      - application/json
      description: Create a copy of an existing scan profile with a new name
      parameters:
      - description: Scan Profile ID to clone
        in: path
        name: id
        required: true
        type: string
      - description: Clone data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CloneScanProfileRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Clone scan profile
      tags:
      - Scan Profiles
  /scan-profiles/{id}/evaluate-quality-gate:
    post:
      consumes:
      - application/json
      description: Evaluate finding counts against a scan profile's quality gate
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      - description: Finding counts
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.EvaluateQualityGateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.QualityGateResultResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Evaluate quality gate
      tags:
      - Scan Profiles
  /scan-profiles/{id}/quality-gate:
    put:
      consumes:
      - application/json
      description: Update the quality gate configuration for a scan profile
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      - description: Quality gate configuration
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateQualityGateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update quality gate
      tags:
      - Scan Profiles
  /scan-profiles/{id}/set-default:
    post:
      consumes:
      - application/json
      description: Set a scan profile as the default for the tenant
      parameters:
      - description: Scan Profile ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Set default scan profile
      tags:
      - Scan Profiles
  /scan-profiles/default:
    get:
      consumes:
      - application/json
      description: Get the default scan profile for the current tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanProfileResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get default scan profile
      tags:
      - Scan Profiles
  /scan-sessions:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scan sessions for the tenant
      parameters:
      - description: Filter by scanner name
        in: query
        name: scanner_name
        type: string
      - description: Filter by asset type
        in: query
        name: asset_type
        type: string
      - description: Filter by status
        in: query
        name: status
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanSessionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scan sessions
      tags:
      - Scan Sessions
  /scan-sessions/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scan session
      parameters:
      - description: Scan session ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scan session
      tags:
      - Scan Sessions
    get:
      consumes:
      - application/json
      description: Get a single scan session by ID
      parameters:
      - description: Scan session ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanSessionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan session
      tags:
      - Scan Sessions
  /scan-sessions/stats:
    get:
      consumes:
      - application/json
      description: Get aggregated scan session statistics
      parameters:
      - description: Start date (RFC3339 format)
        in: query
        name: since
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan session statistics
      tags:
      - Scan Sessions
  /scanner-templates:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scanner templates for the current tenant
      parameters:
      - description: Filter by template type (nuclei, semgrep, gitleaks)
        in: query
        name: template_type
        type: string
      - description: Filter by status (active, pending_review, deprecated, revoked)
        in: query
        name: status
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - description: Search by name or description
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScannerTemplateResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scanner templates
      tags:
      - Scanner Templates
    post:
      consumes:
      - application/json
      description: Create a new custom scanner template (Nuclei, Semgrep, or Gitleaks)
      parameters:
      - description: Template data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScannerTemplateRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScannerTemplateResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scanner template
      tags:
      - Scanner Templates
  /scanner-templates/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scanner template
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scanner template
      tags:
      - Scanner Templates
    get:
      consumes:
      - application/json
      description: Get a single scanner template by ID
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScannerTemplateResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scanner template
      tags:
      - Scanner Templates
    put:
      consumes:
      - application/json
      description: Update an existing scanner template
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScannerTemplateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScannerTemplateResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update scanner template
      tags:
      - Scanner Templates
  /scanner-templates/{id}/deprecate:
    post:
      consumes:
      - application/json
      description: Mark a scanner template as deprecated
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScannerTemplateResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Deprecate template
      tags:
      - Scanner Templates
  /scanner-templates/{id}/download:
    get:
      description: Download the raw template content as a file
      parameters:
      - description: Template ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/octet-stream
      responses:
        "200":
          description: OK
          schema:
            type: file
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Download template content
      tags:
      - Scanner Templates
  /scanner-templates/usage:
    get:
      description: Get the current template usage and quota limits for the tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateUsageResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get template usage and quota
      tags:
      - Scanner Templates
  /scanner-templates/validate:
    post:
      consumes:
      - application/json
      description: Validate scanner template content without saving
      parameters:
      - description: Template content to validate
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ValidateScannerTemplateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ValidationResultResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "413":
          description: Request Entity Too Large
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Validate template content
      tags:
      - Scanner Templates
  /scans:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scans
      parameters:
      - description: Filter by asset group
        in: query
        name: asset_group_id
        type: string
      - description: Filter by pipeline
        in: query
        name: pipeline_id
        type: string
      - description: Filter by scan type (workflow, single)
        in: query
        name: scan_type
        type: string
      - description: Filter by schedule type
        in: query
        name: schedule_type
        type: string
      - description: Filter by status
        in: query
        name: status
        type: string
      - description: Search by name
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scans
      tags:
      - Scans
    post:
      consumes:
      - application/json
      description: Create a new scan configuration with scheduling options
      parameters:
      - description: Scan configuration
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScanRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scan
      tags:
      - Scans
  /scans/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scan configuration
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scan
      tags:
      - Scans
    get:
      consumes:
      - application/json
      description: Get a single scan by ID
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan
      tags:
      - Scans
    put:
      consumes:
      - application/json
      description: Update an existing scan configuration
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScanRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update scan
      tags:
      - Scans
  /scans/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate a paused or disabled scan
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Activate scan
      tags:
      - Scans
  /scans/{id}/clone:
    post:
      consumes:
      - application/json
      description: Create a copy of an existing scan with a new name
      parameters:
      - description: Scan ID to clone
        in: path
        name: id
        required: true
        type: string
      - description: New scan name
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CloneScanRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Clone scan
      tags:
      - Scans
  /scans/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disable a scan completely
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Disable scan
      tags:
      - Scans
  /scans/{id}/pause:
    post:
      consumes:
      - application/json
      description: Pause an active scan
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanDetailResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Pause scan
      tags:
      - Scans
  /scans/{id}/runs:
    get:
      consumes:
      - application/json
      description: Get a paginated list of runs for a scan
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scan runs
      tags:
      - Scans
  /scans/{id}/runs/{runId}:
    get:
      consumes:
      - application/json
      description: Get a specific run for a scan
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      - description: Run ID
        in: path
        name: runId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan run
      tags:
      - Scans
  /scans/{id}/runs/latest:
    get:
      consumes:
      - application/json
      description: Get the most recent run for a scan
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get latest scan run
      tags:
      - Scans
  /scans/{id}/trigger:
    post:
      consumes:
      - application/json
      description: Manually trigger a scan execution. Returns run details with optional
        filtering_result showing which assets will be scanned vs skipped based on
        scanner compatibility.
      parameters:
      - description: Scan ID
        in: path
        name: id
        required: true
        type: string
      - description: Trigger context
        in: body
        name: request
        schema:
          $ref: '#/definitions/internal_infra_http_handler.TriggerScanExecRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.RunResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Trigger scan
      tags:
      - Scans
  /scans/bulk/activate:
    post:
      consumes:
      - application/json
      description: Activate multiple scan configurations at once
      parameters:
      - description: Scan IDs to activate
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkActionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk activate scans
      tags:
      - Scans
  /scans/bulk/delete:
    post:
      consumes:
      - application/json
      description: Delete multiple scan configurations at once
      parameters:
      - description: Scan IDs to delete
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkActionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk delete scans
      tags:
      - Scans
  /scans/bulk/disable:
    post:
      consumes:
      - application/json
      description: Disable multiple scan configurations at once
      parameters:
      - description: Scan IDs to disable
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkActionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk disable scans
      tags:
      - Scans
  /scans/bulk/pause:
    post:
      consumes:
      - application/json
      description: Pause multiple scan configurations at once
      parameters:
      - description: Scan IDs to pause
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.BulkActionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk pause scans
      tags:
      - Scans
  /scans/stats:
    get:
      consumes:
      - application/json
      description: Get aggregated statistics for all scans
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan statistics
      tags:
      - Scans
  /scope/exclusions:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scope exclusions for the current tenant
      parameters:
      - description: Filter by exclusion types (comma-separated)
        in: query
        name: types
        type: string
      - description: Filter by statuses (comma-separated)
        in: query
        name: statuses
        type: string
      - description: Filter by approval status
        in: query
        name: is_approved
        type: boolean
      - description: Search by pattern
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScopeExclusionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scope exclusions
      tags:
      - Scope
    post:
      consumes:
      - application/json
      description: Create a new scope exclusion
      parameters:
      - description: Scope exclusion data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScopeExclusionRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeExclusionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scope exclusion
      tags:
      - Scope
  /scope/exclusions/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scope exclusion
      parameters:
      - description: Exclusion ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scope exclusion
      tags:
      - Scope
    get:
      consumes:
      - application/json
      description: Get a single scope exclusion by ID
      parameters:
      - description: Exclusion ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeExclusionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scope exclusion
      tags:
      - Scope
    put:
      consumes:
      - application/json
      description: Update an existing scope exclusion
      parameters:
      - description: Exclusion ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScopeExclusionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeExclusionResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update scope exclusion
      tags:
      - Scope
  /scope/schedules:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scan schedules for the current tenant
      parameters:
      - description: Filter by scan types (comma-separated)
        in: query
        name: scan_types
        type: string
      - description: Filter by schedule types (comma-separated)
        in: query
        name: schedule_types
        type: string
      - description: Filter by enabled status
        in: query
        name: enabled
        type: boolean
      - description: Search by name
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScanScheduleResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scan schedules
      tags:
      - Scope
    post:
      consumes:
      - application/json
      description: Create a new scan schedule
      parameters:
      - description: Scan schedule data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScanScheduleRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanScheduleResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scan schedule
      tags:
      - Scope
  /scope/schedules/{id}:
    get:
      consumes:
      - application/json
      description: Get a single scan schedule by ID
      parameters:
      - description: Schedule ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScanScheduleResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scan schedule
      tags:
      - Scope
  /scope/targets:
    get:
      consumes:
      - application/json
      description: Get a paginated list of scope targets for the current tenant
      parameters:
      - description: Filter by target types (comma-separated)
        in: query
        name: types
        type: string
      - description: Filter by statuses (comma-separated)
        in: query
        name: statuses
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - description: Search by pattern
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List scope targets
      tags:
      - Scope
    post:
      consumes:
      - application/json
      description: Create a new scope target
      parameters:
      - description: Scope target data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateScopeTargetRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create scope target
      tags:
      - Scope
  /scope/targets/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a scope target
      parameters:
      - description: Target ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete scope target
      tags:
      - Scope
    get:
      consumes:
      - application/json
      description: Get a single scope target by ID
      parameters:
      - description: Target ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get scope target
      tags:
      - Scope
    put:
      consumes:
      - application/json
      description: Update an existing scope target
      parameters:
      - description: Target ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateScopeTargetRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update scope target
      tags:
      - Scope
  /scope/targets/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate a scope target
      parameters:
      - description: Target ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Activate scope target
      tags:
      - Scope
  /scope/targets/{id}/deactivate:
    post:
      consumes:
      - application/json
      description: Deactivate a scope target
      parameters:
      - description: Target ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ScopeTargetResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Deactivate scope target
      tags:
      - Scope
  /services:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of all services for the tenant with
        optional filtering
      parameters:
      - description: Filter by service type (e.g., http, ssh, database)
        in: query
        name: service_type
        type: string
      - description: Filter by state (active, inactive, filtered)
        in: query
        name: state
        type: string
      - description: Filter by public exposure
        in: query
        name: is_public
        type: boolean
      - description: Filter by port number
        in: query
        name: port
        type: integer
      - description: Filter by product name
        in: query
        name: product
        type: string
      - default: 50
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      - default: 0
        description: Pagination offset
        in: query
        name: offset
        type: integer
      - description: Sort field
        in: query
        name: sort_by
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: sort_order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
                type: array
              limit:
                type: integer
              offset:
                type: integer
              total:
                type: integer
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List all services
      tags:
      - Asset Services
  /services/{id}:
    delete:
      consumes:
      - application/json
      description: Permanently removes a service entry
      parameters:
      - description: Service ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete a service
      tags:
      - Asset Services
    get:
      consumes:
      - application/json
      description: Retrieves a specific service by its unique identifier
      parameters:
      - description: Service ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get a service by ID
      tags:
      - Asset Services
    put:
      consumes:
      - application/json
      description: Updates an existing service's properties
      parameters:
      - description: Service ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Updated service details
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateAssetServiceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update a service
      tags:
      - Asset Services
  /services/public:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of publicly exposed services
      parameters:
      - default: 50
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      - default: 0
        description: Pagination offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.AssetServiceResponse'
                type: array
              limit:
                type: integer
              offset:
                type: integer
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List public services
      tags:
      - Asset Services
  /services/stats:
    get:
      consumes:
      - application/json
      description: Retrieves aggregate statistics about services including counts
        by type and top ports
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.AssetServiceStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get service statistics
      tags:
      - Asset Services
  /sla-policies:
    get:
      description: Retrieves all SLA policies for the current tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List SLA policies
      tags:
      - SLA Policies
    post:
      consumes:
      - application/json
      description: Creates a new SLA policy for the tenant
      parameters:
      - description: SLA Policy data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateSLAPolicyRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SLAPolicyResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Create SLA policy
      tags:
      - SLA Policies
  /sla-policies/{id}:
    delete:
      description: Deletes an SLA policy
      parameters:
      - description: SLA Policy ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Delete SLA policy
      tags:
      - SLA Policies
    get:
      description: Retrieves an SLA policy by ID
      parameters:
      - description: SLA Policy ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SLAPolicyResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get SLA policy
      tags:
      - SLA Policies
    put:
      consumes:
      - application/json
      description: Updates an SLA policy
      parameters:
      - description: SLA Policy ID
        in: path
        name: id
        required: true
        type: string
      - description: SLA Policy data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateSLAPolicyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SLAPolicyResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update SLA policy
      tags:
      - SLA Policies
  /sla-policies/default:
    get:
      description: Gets the default SLA policy for the tenant
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SLAPolicyResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get default SLA policy
      tags:
      - SLA Policies
  /state-history:
    get:
      consumes:
      - application/json
      description: Retrieves a paginated list of all state changes for the tenant
        with optional filtering
      parameters:
      - description: Filter by change type
        in: query
        name: change_type
        type: string
      - description: Filter by source
        in: query
        name: source
        type: string
      - description: Start time (RFC3339)
        in: query
        name: from
        type: string
      - description: End time (RFC3339)
        in: query
        name: to
        type: string
      - default: 50
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      - default: 0
        description: Pagination offset
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              limit:
                type: integer
              offset:
                type: integer
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List all state history
      tags:
      - Asset State History
  /state-history/{id}:
    get:
      consumes:
      - application/json
      description: Retrieves a specific state change entry by its unique identifier
      parameters:
      - description: State change ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get state change by ID
      tags:
      - Asset State History
  /state-history/appearances:
    get:
      consumes:
      - application/json
      description: Retrieves recently discovered assets (new assets appearing in scans)
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get recent asset appearances
      tags:
      - Asset State History
  /state-history/compliance:
    get:
      consumes:
      - application/json
      description: Retrieves state changes that may affect compliance status
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get compliance-related changes
      tags:
      - Asset State History
  /state-history/disappearances:
    get:
      consumes:
      - application/json
      description: Retrieves assets that have disappeared (no longer seen in scans)
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get recent asset disappearances
      tags:
      - Asset State History
  /state-history/exposure-changes:
    get:
      consumes:
      - application/json
      description: Retrieves assets that have changed exposure status (public/private/restricted)
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get exposure changes
      tags:
      - Asset State History
  /state-history/newly-exposed:
    get:
      consumes:
      - application/json
      description: Retrieves assets that have recently become publicly exposed
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get newly exposed assets
      tags:
      - Asset State History
  /state-history/shadow-it:
    get:
      consumes:
      - application/json
      description: Retrieves assets identified as potential Shadow IT (unexpected
        or unauthorized resources)
      parameters:
      - description: 'Start time (RFC3339, default: 7 days ago)'
        in: query
        name: since
        type: string
      - default: 100
        description: Maximum results (max 1000)
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.StateChangeResponse'
                type: array
              since:
                type: string
              total:
                type: integer
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get Shadow IT candidates
      tags:
      - Asset State History
  /state-history/stats:
    get:
      consumes:
      - application/json
      description: Retrieves aggregate statistics about state changes by type and
        source
      parameters:
      - description: 'Start time (RFC3339, default: 30 days ago)'
        in: query
        name: since
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.StateHistoryStatsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get state history statistics
      tags:
      - Asset State History
  /state-history/timeline:
    get:
      consumes:
      - application/json
      description: Retrieves daily activity counts for visualization (appearances,
        disappearances, exposure changes)
      parameters:
      - description: 'Start time (RFC3339, default: 30 days ago)'
        in: query
        name: from
        type: string
      - description: 'End time (RFC3339, default: now)'
        in: query
        name: to
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            properties:
              data:
                items:
                  $ref: '#/definitions/internal_infra_http_handler.DailyActivityResponse'
                type: array
              from:
                type: string
              to:
                type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get activity timeline
      tags:
      - Asset State History
  /template-sources:
    get:
      consumes:
      - application/json
      description: List template sources with optional filters
      parameters:
      - description: Filter by source type (git, s3, http)
        in: query
        name: source_type
        type: string
      - description: Filter by template type (nuclei, semgrep, gitleaks)
        in: query
        name: template_type
        type: string
      - description: Filter by enabled status
        in: query
        name: enabled
        type: boolean
      - description: Page number
        in: query
        name: page
        type: integer
      - description: Page size
        in: query
        name: page_size
        type: integer
      - description: Sort by field
        in: query
        name: sort_by
        type: string
      - description: Sort order (asc, desc)
        in: query
        name: sort_order
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListSourcesResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List template sources
      tags:
      - Template Sources
    post:
      consumes:
      - application/json
      description: Create a new template source (Git, S3, or HTTP)
      parameters:
      - description: Source data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateTemplateSourceRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create template source
      tags:
      - Template Sources
  /template-sources/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a template source
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete template source
      tags:
      - Template Sources
    get:
      consumes:
      - application/json
      description: Get a single template source by ID
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get template source
      tags:
      - Template Sources
    put:
      consumes:
      - application/json
      description: Update an existing template source
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      - description: Updated source data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateTemplateSourceRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update template source
      tags:
      - Template Sources
  /template-sources/{id}/disable:
    post:
      consumes:
      - application/json
      description: Disable an active template source
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Disable template source
      tags:
      - Template Sources
  /template-sources/{id}/enable:
    post:
      consumes:
      - application/json
      description: Enable a disabled template source
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TemplateSourceResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Enable template source
      tags:
      - Template Sources
  /tenant-tools:
    get:
      consumes:
      - application/json
      description: Get a paginated list of tenant tool configurations
      parameters:
      - description: Filter by tool ID
        in: query
        name: tool_id
        type: string
      - description: Filter by enabled status
        in: query
        name: is_enabled
        type: boolean
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_TenantToolConfigResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List tenant tool configs
      tags:
      - Tenant Tools
  /tenant-tools/{tool_id}:
    delete:
      consumes:
      - application/json
      description: Delete tenant-specific configuration for a tool
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete tenant tool config
      tags:
      - Tenant Tools
    get:
      consumes:
      - application/json
      description: Get tenant-specific configuration for a tool
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantToolConfigResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tenant tool config
      tags:
      - Tenant Tools
    put:
      consumes:
      - application/json
      description: Update or create tenant-specific configuration for a tool
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      - description: Config data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.TenantToolConfigRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantToolConfigResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update tenant tool config
      tags:
      - Tenant Tools
  /tenant-tools/{tool_id}/effective-config:
    get:
      consumes:
      - application/json
      description: Get the merged configuration (default + tenant overrides) for a
        tool
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get effective tool config
      tags:
      - Tenant Tools
  /tenant-tools/{tool_id}/with-config:
    get:
      consumes:
      - application/json
      description: Get a tool with its tenant-specific configuration and effective
        config
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolWithConfigResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tool with tenant config
      tags:
      - Tenant Tools
  /tenant-tools/all-tools:
    get:
      consumes:
      - application/json
      description: Get a paginated list of all tools with their tenant-specific enabled
        status
      parameters:
      - description: Filter by category
        in: query
        name: category
        type: string
      - description: Filter by system-wide active status
        in: query
        name: is_active
        type: boolean
      - description: Filter by builtin status
        in: query
        name: is_builtin
        type: boolean
      - description: Search by name or description
        in: query
        name: search
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolWithConfigResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List all tools with tenant config
      tags:
      - Tenant Tools
  /tenant-tools/bulk-disable:
    post:
      consumes:
      - application/json
      description: Disable multiple tools for the current tenant
      parameters:
      - description: Tool IDs
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkToolIDsRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk disable tools
      tags:
      - Tenant Tools
  /tenant-tools/bulk-enable:
    post:
      consumes:
      - application/json
      description: Enable multiple tools for the current tenant
      parameters:
      - description: Tool IDs
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.BulkToolIDsRequest'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Bulk enable tools
      tags:
      - Tenant Tools
  /tenants/{tenant_id}/modules:
    get:
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantModulesResponse'
      security:
      - BearerAuth: []
      summary: Get tenant enabled modules
      tags:
      - Licensing
  /tenants/{tenant_id}/modules/{module_id}:
    get:
      parameters:
      - description: Module ID
        in: path
        name: module_id
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: boolean
            type: object
      security:
      - BearerAuth: []
      summary: Check tenant module access
      tags:
      - Licensing
  /tenants/{tenant_id}/modules/{module_id}/limit:
    get:
      parameters:
      - description: Module ID
        in: path
        name: module_id
        required: true
        type: string
      - description: Metric name
        in: query
        name: metric
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/github_com_openctemio_api_internal_app.GetModuleLimitOutput'
      security:
      - BearerAuth: []
      summary: Get module limit
      tags:
      - Licensing
  /tenants/{tenant_id}/subscription:
    get:
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SubscriptionResponse'
      security:
      - BearerAuth: []
      summary: Get tenant subscription
      tags:
      - Licensing
  /tenants/{tenant_slug}/event-types:
    get:
      parameters:
      - description: Tenant Slug
        in: path
        name: tenant_slug
        required: true
        type: string
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantEventTypesResponse'
      security:
      - BearerAuth: []
      summary: Get tenant event types by slug
      tags:
      - Licensing
  /tool-stats:
    get:
      consumes:
      - application/json
      description: Get aggregated tool execution statistics for the current tenant
      parameters:
      - default: 30
        description: Number of days to include
        in: query
        name: days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.TenantToolStatsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tenant tool stats
      tags:
      - Tool Stats
  /tool-stats/{tool_id}:
    get:
      consumes:
      - application/json
      description: Get execution statistics for a specific tool
      parameters:
      - description: Tool ID
        in: path
        name: tool_id
        required: true
        type: string
      - default: 30
        description: Number of days to include
        in: query
        name: days
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolStatsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tool stats
      tags:
      - Tool Stats
  /tools:
    get:
      consumes:
      - application/json
      description: Get a paginated list of available tools
      parameters:
      - description: Filter by category
        in: query
        name: category
        type: string
      - description: Filter by capabilities (comma-separated)
        in: query
        name: capabilities
        type: string
      - description: Filter by active status
        in: query
        name: is_active
        type: boolean
      - description: Filter by builtin status
        in: query
        name: is_builtin
        type: boolean
      - description: Search by name or description
        in: query
        name: search
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List tools
      tags:
      - Tools
    post:
      consumes:
      - application/json
      description: Create a new tool in the registry (admin only)
      parameters:
      - description: Tool data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateToolRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "409":
          description: Conflict
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Create tool
      tags:
      - Tools
  /tools/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a tool from the registry (admin only, builtin tools cannot
        be deleted)
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Delete tool
      tags:
      - Tools
    get:
      consumes:
      - application/json
      description: Get a single tool by ID
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tool
      tags:
      - Tools
    put:
      consumes:
      - application/json
      description: Update an existing tool (admin only)
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      - description: Update data
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateToolRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Update tool
      tags:
      - Tools
  /tools/{id}/activate:
    post:
      consumes:
      - application/json
      description: Activate a tool to make it available for use
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Activate tool
      tags:
      - Tools
  /tools/{id}/deactivate:
    post:
      consumes:
      - application/json
      description: Deactivate a tool to make it unavailable for use
      parameters:
      - description: Tool ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Deactivate tool
      tags:
      - Tools
  /tools/name/{name}:
    get:
      consumes:
      - application/json
      description: Get a single tool by name
      parameters:
      - description: Tool name
        in: path
        name: name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: Get tool by name
      tags:
      - Tools
  /tools/platform:
    get:
      consumes:
      - application/json
      description: Get a paginated list of platform-provided tools (available to all
        tenants)
      parameters:
      - description: Filter by category
        in: query
        name: category
        type: string
      - description: Filter by capabilities (comma-separated)
        in: query
        name: capabilities
        type: string
      - description: Filter by active status
        in: query
        name: is_active
        type: boolean
      - description: Search by name or description
        in: query
        name: search
        type: string
      - description: Filter by tags (comma-separated)
        in: query
        name: tags
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.ListResponse-internal_infra_http_handler_ToolResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/github_com_openctemio_api_pkg_apierror.Error'
      security:
      - BearerAuth: []
      summary: List platform tools
      tags:
      - Tools
  /users/me:
    get:
      description: Returns the profile of the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.UserResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get current user profile
      tags:
      - Users
    put:
      consumes:
      - application/json
      description: Updates the profile of the authenticated user
      parameters:
      - description: Profile data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.UserResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update current user profile
      tags:
      - Users
  /users/me/change-password:
    post:
      consumes:
      - application/json
      description: Changes password for authenticated user
      parameters:
      - description: Current and new password
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.ChangePasswordRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Change password
      tags:
      - Authentication
  /users/me/preferences:
    put:
      consumes:
      - application/json
      description: Updates the preferences of the authenticated user
      parameters:
      - description: Preferences data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdatePreferencesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.UserResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Update user preferences
      tags:
      - Users
  /users/me/sessions:
    delete:
      description: Revokes all sessions except current
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Revoke all sessions
      tags:
      - Authentication
    get:
      description: Lists all active sessions
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.SessionsResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: List sessions
      tags:
      - Authentication
  /users/me/sessions/{sessionId}:
    delete:
      description: Revokes a specific session by ID
      parameters:
      - description: Session ID
        in: path
        name: sessionId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Revoke session
      tags:
      - Authentication
  /users/me/tenants:
    get:
      description: Returns all tenants the current user belongs to
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/internal_infra_http_handler.TenantMembershipResponse'
            type: array
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: Get user's tenants
      tags:
      - Users
  /vulnerabilities:
    get:
      description: Retrieves a paginated list of CVE vulnerabilities
      parameters:
      - description: Filter by CVE IDs (comma-separated)
        in: query
        name: cve_ids
        type: string
      - description: Filter by severities (comma-separated)
        in: query
        name: severities
        type: string
      - description: Minimum CVSS score
        in: query
        name: min_cvss
        type: number
      - description: Maximum CVSS score
        in: query
        name: max_cvss
        type: number
      - description: Minimum EPSS score
        in: query
        name: min_epss
        type: number
      - description: Filter by exploit availability
        in: query
        name: exploit_available
        type: boolean
      - description: Only CISA KEV vulnerabilities
        in: query
        name: cisa_kev_only
        type: boolean
      - description: Filter by statuses
        in: query
        name: statuses
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 20
        description: Items per page
        in: query
        name: per_page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: List vulnerabilities
      tags:
      - Vulnerabilities
    post:
      consumes:
      - application/json
      description: Creates a new CVE vulnerability record
      parameters:
      - description: Vulnerability data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.CreateVulnerabilityRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/internal_infra_http_handler.VulnerabilityResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "409":
          description: Conflict
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Create vulnerability
      tags:
      - Vulnerabilities
  /vulnerabilities/{id}:
    delete:
      description: Deletes a vulnerability
      parameters:
      - description: Vulnerability ID
        in: path
        name: id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Delete vulnerability
      tags:
      - Vulnerabilities
    get:
      description: Retrieves a vulnerability by ID
      parameters:
      - description: Vulnerability ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.VulnerabilityResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get vulnerability
      tags:
      - Vulnerabilities
    put:
      consumes:
      - application/json
      description: Updates a vulnerability
      parameters:
      - description: Vulnerability ID
        in: path
        name: id
        required: true
        type: string
      - description: Vulnerability data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/internal_infra_http_handler.UpdateVulnerabilityRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.VulnerabilityResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Update vulnerability
      tags:
      - Vulnerabilities
  /vulnerabilities/cve/{cve_id}:
    get:
      description: Retrieves a vulnerability by CVE ID
      parameters:
      - description: CVE ID
        in: path
        name: cve_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/internal_infra_http_handler.VulnerabilityResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get vulnerability by CVE ID
      tags:
      - Vulnerabilities
securityDefinitions:
  BearerAuth:
    description: 'JWT Bearer token. Format: "Bearer {token}"'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
