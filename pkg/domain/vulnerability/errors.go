package vulnerability

import (
	"fmt"

	"github.com/openctemio/api/pkg/domain/shared"
)

// Domain errors for vulnerability.
var (
	ErrVulnerabilityNotFound      = fmt.Errorf("vulnerability %w", shared.ErrNotFound)
	ErrVulnerabilityAlreadyExists = fmt.Errorf("vulnerability %w", shared.ErrAlreadyExists)
	ErrFindingNotFound            = fmt.Errorf("finding %w", shared.ErrNotFound)
	ErrFindingAlreadyExists       = fmt.Errorf("finding %w", shared.ErrAlreadyExists)
)

// VulnerabilityNotFoundError returns a not found error with the vulnerability ID.
func VulnerabilityNotFoundError(id shared.ID) error {
	return shared.NewDomainError(
		"VULNERABILITY_NOT_FOUND",
		fmt.Sprintf("vulnerability with id %s not found", id.String()),
		ErrVulnerabilityNotFound,
	)
}

// VulnerabilityNotFoundByCVEError returns a not found error with the CVE ID.
func VulnerabilityNotFoundByCVEError(cveID string) error {
	return shared.NewDomainError(
		"VULNERABILITY_NOT_FOUND",
		fmt.Sprintf("vulnerability with CVE %s not found", cveID),
		ErrVulnerabilityNotFound,
	)
}

// VulnerabilityAlreadyExistsError returns an already exists error with the CVE ID.
func VulnerabilityAlreadyExistsError(cveID string) error {
	return shared.NewDomainError(
		"VULNERABILITY_ALREADY_EXISTS",
		fmt.Sprintf("vulnerability with CVE %s already exists", cveID),
		ErrVulnerabilityAlreadyExists,
	)
}

// FindingNotFoundError returns a not found error with the finding ID.
func FindingNotFoundError(id shared.ID) error {
	return shared.NewDomainError(
		"FINDING_NOT_FOUND",
		fmt.Sprintf("finding with id %s not found", id.String()),
		ErrFindingNotFound,
	)
}

// FindingAlreadyExistsError returns an already exists error with the fingerprint.
func FindingAlreadyExistsError(fingerprint string) error {
	return shared.NewDomainError(
		"FINDING_ALREADY_EXISTS",
		fmt.Sprintf("finding with fingerprint %s already exists", fingerprint),
		ErrFindingAlreadyExists,
	)
}
